import{r as l,j as e,K as c,L as p}from"./index-DswpKyhs.js";const g=()=>{const[i,d]=l.useState("確認中..."),[r,o]=l.useState(null),[a,m]=l.useState(null);return l.useEffect(()=>{(async()=>{try{const{data:n,error:x}=await c.from("individual_transactions").select("count").limit(1);if(x)throw x;d("接続成功"),o(n),m(null)}catch(n){d("接続失敗"),m(n.message),console.error("Database connection error:",n)}})()},[]),e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Supabase接続テスト"}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"font-semibold",children:["接続状況: ",e.jsx("span",{className:i==="接続成功"?"text-green-500":"text-red-500",children:i})]})}),a&&e.jsxs("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded",children:[e.jsx("p",{className:"font-semibold",children:"エラー:"}),e.jsx("p",{children:a})]}),r&&e.jsxs("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded",children:[e.jsx("p",{className:"font-semibold",children:"テスト結果:"}),e.jsx("pre",{children:JSON.stringify(r,null,2)})]})]})},j=()=>{const[i,d]=l.useState([]),[r,o]=l.useState(!1),a=async(s,t)=>{o(!0);try{const h=await t();d(u=>[...u,{testName:s,result:h,error:null}])}catch(h){d(u=>[...u,{testName:s,result:null,error:h.message}])}finally{o(!1)}},m=async()=>{const{data:s,error:t}=await c.rpc("version");if(t)throw t;return s},b=async()=>{const{data:s,error:t}=await c.auth.getSession();if(t)throw t;return s},n=async()=>{const{data:s,error:t}=await c.from("individual_transactions").select("id").limit(1);if(t)throw t;return s},x=async()=>{const{data:s,error:t}=await c.from("individual_transactions").insert({item:"Test Item",amount:1e3,date:"2023-01-01",category:"テスト",type:"expense",creator:"test-user-id"}).select();if(t)throw t;return s};return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"手動データベーステスト"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:()=>a("接続テスト",m),disabled:r,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 mr-2",children:"接続テスト"}),e.jsx("button",{onClick:()=>a("認証テスト",b),disabled:r,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50 mr-2",children:"認証テスト"}),e.jsx("button",{onClick:()=>a("SELECTテスト",n),disabled:r,className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600 disabled:opacity-50 mr-2",children:"SELECTテスト"}),e.jsx("button",{onClick:()=>a("INSERTテスト",x),disabled:r,className:"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 disabled:opacity-50",children:"INSERTテスト"})]}),r&&e.jsx("div",{className:"mb-4 p-3 bg-gray-100 rounded",children:e.jsx("p",{children:"テスト実行中..."})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"テスト結果"}),i.length===0?e.jsx("p",{children:"まだテストが実行されていません"}):e.jsx("div",{className:"space-y-4",children:i.map((s,t)=>e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("h4",{className:"font-semibold",children:s.testName}),s.error?e.jsx("div",{className:"mt-2 p-2 bg-red-100 text-red-700 rounded",children:e.jsxs("p",{children:["エラー: ",s.error]})}):e.jsx("div",{className:"mt-2 p-2 bg-green-100 text-green-700 rounded",children:e.jsx("pre",{children:JSON.stringify(s.result,null,2)})})]},t))})]})]})},y=()=>e.jsx("div",{className:"min-h-screen bg-background p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsx(p,{to:"/dashboard",className:"text-primary hover:text-primary/80 flex items-center",children:"← ダッシュボードに戻る"})}),e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"データベース接続テスト"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx(g,{}),e.jsx(j,{})]})]})});export{y as default};
