import{j as e,r as w,a as F,e as M,l as R,T as B,d as _,G as D,F as A,x as E,u as O,L as P}from"./index-Cte9M9zr.js";import{W as Q}from"./WizardProgress-DC-23g1d.js";import{D as C}from"./download-WVyvOCYo.js";import{C as T}from"./circle-question-mark-D8QNNe1k.js";import{C as $}from"./calculator-BmbL7nmW.js";import{D as G}from"./DepreciationCalculator-CFrmSYxb.js";import{A as L}from"./arrow-left-DwSMUrT_.js";import{A as U}from"./arrow-right-gQUG1Phy.js";import{A as I}from"./index-DNAwpMfK.js";import{g as S}from"./motion-Di5WGlKG.js";import{S as W}from"./shield-BYriuN3U.js";import{a as z,b as H}from"./pdfJapaneseService-Dtu4oZrB.js";import{C as k}from"./circle-check-big-DeImdQY4.js";import{Z as V}from"./zap-qa5tEbZT.js";import"./CorporateTaxService-wsKGjjao.js";import"./pdfAutoFillService-PLPbwm7Q.js";const J=["ITãƒ»ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢","ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼","ãƒ©ã‚¤ã‚¿ãƒ¼","ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆ","å£«æ¥­ï¼ˆå¼è­·å£«ãƒ»ç¨ç†å£«ç­‰ï¼‰","åŒ»ç™‚ãƒ»ä»‹è­·","é£²é£Ÿæ¥­","å°å£²æ¥­","ãã®ä»–"],Z=({data:s,onChange:g,onNext:p})=>{const h=(d,u)=>{g({...s,[d]:u})},c=s.name&&s.address&&s.businessType&&s.filingType;return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-text-main mb-2",children:"åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"}),e.jsx("p",{className:"text-sm sm:text-base text-text-muted mb-6 sm:mb-8",children:"ç¢ºå®šç”³å‘Šã«å¿…è¦ãªåŸºæœ¬çš„ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã™"}),e.jsxs("div",{className:"space-y-5 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["æ°å ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.name,onChange:d=>h("name",d.target.value),placeholder:"å±±ç”° å¤ªéƒ",className:"w-full px-4 py-3 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main placeholder:text-text-muted/50"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["ä½æ‰€ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.address,onChange:d=>h("address",d.target.value),placeholder:"æ±äº¬éƒ½æ¸‹è°·åŒº...",className:"w-full px-4 py-3 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main placeholder:text-text-muted/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ï¼ˆä»»æ„ï¼‰"}),e.jsx("input",{type:"text",value:s.myNumber,onChange:d=>h("myNumber",d.target.value),placeholder:"123456789012",maxLength:12,pattern:"\\d*",inputMode:"numeric",className:"w-full px-4 py-3 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main placeholder:text-text-muted/50"}),e.jsx("p",{className:"text-xs text-text-muted mt-1.5",children:"12æ¡ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆå¾Œã‹ã‚‰å…¥åŠ›ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼‰"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["äº‹æ¥­ã®ç¨®é¡ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:s.businessType,onChange:d=>h("businessType",d.target.value),className:"w-full px-4 py-3 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main appearance-none",children:[e.jsx("option",{value:"",children:"é¸æŠã—ã¦ãã ã•ã„"}),J.map(d=>e.jsx("option",{value:d,children:d},d))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),e.jsx("p",{className:"text-xs text-text-muted mt-1.5",children:"çµŒè²»ã®æ¨å®šã«ä½¿ç”¨ã—ã¾ã™"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["ç”³å‘Šã®ç¨®é¡ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>h("filingType","blue"),className:`p-4 rounded-lg border-2 transition-all text-left relative overflow-hidden group ${s.filingType==="blue"?"border-primary bg-primary/5 text-primary":"border-border bg-surface text-text-main hover:border-primary/50"}`,children:[e.jsx("div",{className:"font-semibold mb-1 text-base",children:"é’è‰²ç”³å‘Š"}),e.jsx("div",{className:"text-xs sm:text-sm opacity-80",children:"65ä¸‡å††æ§é™¤ãƒ»ç¯€ç¨åŠ¹æœå¤§"}),s.filingType==="blue"&&e.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 rounded-full bg-primary"})]}),e.jsxs("button",{type:"button",onClick:()=>h("filingType","white"),className:`p-4 rounded-lg border-2 transition-all text-left relative overflow-hidden group ${s.filingType==="white"?"border-primary bg-primary/5 text-primary":"border-border bg-surface text-text-main hover:border-primary/50"}`,children:[e.jsx("div",{className:"font-semibold mb-1 text-base",children:"ç™½è‰²ç”³å‘Š"}),e.jsx("div",{className:"text-xs sm:text-sm opacity-80",children:"è¨˜å¸³ãŒã‚·ãƒ³ãƒ—ãƒ«ãƒ»æ§é™¤ãªã—"}),s.filingType==="white"&&e.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 rounded-full bg-primary"})]})]})]})]}),e.jsx("div",{className:"mt-8 sm:mt-10 flex justify-end",children:e.jsx("button",{onClick:p,disabled:!c,className:`w-full sm:w-auto px-8 py-3.5 sm:py-3 rounded-lg font-medium transition-all shadow-sm active:scale-[0.98] ${c?"bg-primary text-white hover:bg-primary/90 hover:shadow":"bg-surface-elevated text-text-muted cursor-not-allowed"}`,children:"æ¬¡ã¸é€²ã‚€"})})]})},K=["æ¥­å‹™å§”è¨—","çµ¦ä¸æ‰€å¾—","ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆ","åºƒå‘Šåå…¥","è²©å£²åå…¥","ãã®ä»–"],X=({data:s,onChange:g,onNext:p,onBack:h})=>{const[c,d]=w.useState(!1),{user:u}=F(),{currentBusinessType:j}=M(),{transactions:v}=R(u==null?void 0:u.id,j==null?void 0:j.business_type),a=(t,r)=>{g({...s,[t]:r})},m=()=>{if(!v||v.length===0){D.error("å–å¼•ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");return}const t=v.filter(r=>r.type==="income").reduce((r,l)=>{const n=typeof l.amount=="number"?l.amount:parseFloat(String(l.amount).replace(/,/g,""))||0;return r+n},0);if(t===0){D("åå…¥ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ");return}window.confirm(`å–å¼•ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é›†è¨ˆã•ã‚ŒãŸåå…¥åˆè¨ˆ: Â¥${t.toLocaleString()} ã‚’å…¥åŠ›ã—ã¾ã™ã‹ï¼Ÿ`)&&(a("totalRevenue",t),D.success("åå…¥ã‚’å…¥åŠ›ã—ã¾ã—ãŸ"))},f=t=>{const r=s.sources.includes(t)?s.sources.filter(l=>l!==t):[...s.sources,t];a("sources",r)},b=(t,r)=>{const l=s.monthlyBreakdown||Array(12).fill(0);l[t]=parseInt(r)||0,a("monthlyBreakdown",l);const n=l.reduce((o,x)=>o+x,0);a("totalRevenue",n)},i=s.totalRevenue>0&&s.sources.length>0;return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-text-main mb-2 whitespace-nowrap",children:"åå…¥æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"}),e.jsx("p",{className:"text-sm sm:text-base text-text-muted mb-6 sm:mb-8",children:"2025å¹´ã®ç·åå…¥ã¨åå…¥æºã‚’å…¥åŠ›ã—ã¾ã™"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["2025å¹´ã®ç·å£²ä¸Šï¼ˆåå…¥ï¼‰ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),e.jsx("input",{type:"number",value:s.totalRevenue||"",onChange:t=>a("totalRevenue",parseInt(t.target.value)||0),placeholder:"5000000",disabled:c,inputMode:"numeric",className:"w-full pl-12 pr-10 py-3 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main disabled:opacity-50 disabled:bg-surface-elevated"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-text-muted",children:"å††"})]}),s.totalRevenue>0&&e.jsxs("p",{className:"text-sm text-green-600 mt-2 font-medium",children:["Â¥",s.totalRevenue.toLocaleString()]}),e.jsx("div",{className:"mt-2 text-right",children:e.jsxs("button",{onClick:m,className:"text-sm text-primary hover:text-primary-dark flex items-center justify-end gap-1 ml-auto",children:[e.jsx(C,{className:"w-4 h-4"}),"å–å¼•ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰åå…¥ã‚’è»¢è¨˜"]})})]}),e.jsxs("div",{className:"bg-surface-elevated p-4 rounded-lg cursor-pointer hover:bg-surface-elevated/80 transition-colors border border-transparent hover:border-border",onClick:()=>{const t=!c;d(t),t?a("monthlyBreakdown",Array(12).fill(0)):a("monthlyBreakdown",void 0)},children:[e.jsxs("div",{className:"flex items-center justify-between pointer-events-none",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${c?"bg-primary border-primary":"border-text-muted bg-surface"}`,children:c&&e.jsx(_,{className:"w-3.5 h-3.5 text-white"})}),e.jsx("span",{className:"text-sm font-medium text-text-main",children:"æœˆåˆ¥ã«è©³ã—ãå…¥åŠ›ã™ã‚‹ï¼ˆä»»æ„ï¼‰"})]}),e.jsx(T,{className:"w-4 h-4 text-text-muted"})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2 pl-8",children:"ã‚ˆã‚Šæ­£ç¢ºãªç”³å‘Šã‚’ã—ãŸã„å ´åˆã¯ã€æœˆåˆ¥ã®åå…¥ã‚’å…¥åŠ›ã§ãã¾ã™"})]}),c&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 animate-in fade-in slide-in-from-top-4 duration-300",children:Array.from({length:12},(t,r)=>{var l;return e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-text-muted mb-1 ml-1",children:[r+1,"æœˆ"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:((l=s.monthlyBreakdown)==null?void 0:l[r])||"",onChange:n=>b(r,n.target.value),placeholder:"0",inputMode:"numeric",className:"w-full pl-3 pr-7 py-2.5 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main"}),e.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-text-muted",children:"å††"})]})]},r)})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["ä¸»ãªåå…¥æºï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:K.map(t=>e.jsx("button",{type:"button",onClick:()=>f(t),className:`p-3.5 sm:p-3 rounded-lg border text-sm font-medium transition-all relative overflow-hidden ${s.sources.includes(t)?"border-primary bg-primary/10 text-primary":"border-border bg-surface text-text-main hover:border-primary/50 hover:bg-surface-elevated"}`,children:t},t))})]})]}),e.jsxs("div",{className:"mt-8 sm:mt-10 flex gap-4",children:[e.jsx("button",{onClick:h,className:"flex-1 sm:flex-none px-6 sm:px-8 py-3.5 sm:py-3 rounded-lg font-medium bg-surface-elevated text-text-main hover:bg-surface transition-all border border-border whitespace-nowrap text-sm sm:text-base",children:"æˆ»ã‚‹"}),e.jsx("button",{onClick:p,disabled:!i,className:`flex-1 sm:flex-none sm:ml-auto px-6 sm:px-8 py-3.5 sm:py-3 rounded-lg font-medium transition-all shadow-sm whitespace-nowrap text-sm sm:text-base ${i?"bg-primary text-white hover:bg-primary/90 hover:shadow":"bg-surface-elevated text-text-muted cursor-not-allowed"}`,children:"æ¬¡ã¸é€²ã‚€"})]})]})},q=[{key:"supplies",label:"æ¶ˆè€—å“è²»",description:"æ–‡å…·ã€ã‚³ãƒ”ãƒ¼ç”¨ç´™ã€ã‚ªãƒ•ã‚£ã‚¹ç”¨å“ãªã©"},{key:"communication",label:"é€šä¿¡è²»",description:"é›»è©±æ–™é‡‘ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ–™é‡‘ãªã©"},{key:"transportation",label:"æ—…è²»äº¤é€šè²»",description:"é›»è»Šä»£ã€ã‚¿ã‚¯ã‚·ãƒ¼ä»£ã€å‡ºå¼µè²»ãªã©"},{key:"entertainment",label:"æ¥å¾…äº¤éš›è²»",description:"å–å¼•å…ˆã¨ã®ä¼šé£Ÿã€è´ˆç­”å“ãªã©"},{key:"rent",label:"åœ°ä»£å®¶è³ƒ",description:"äº‹å‹™æ‰€å®¶è³ƒã€é§è»Šå ´ä»£ãªã©"},{key:"utilities",label:"æ°´é“å…‰ç†±è²»",description:"é›»æ°—ä»£ã€ã‚¬ã‚¹ä»£ã€æ°´é“ä»£ãªã©"},{key:"other",label:"ãã®ä»–",description:"ä¸Šè¨˜ä»¥å¤–ã®çµŒè²»"}],ee=({data:s,businessType:g,totalRevenue:p,onChange:h,onNext:c,onBack:d})=>{const{user:u}=F(),{currentBusinessType:j}=M(),{transactions:v}=R(u==null?void 0:u.id,j==null?void 0:j.business_type),a=(i,t)=>{h({...s,[i]:parseInt(t)||0})},m=()=>{if(!v||v.length===0){D.error("å–å¼•ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");return}if(!window.confirm("ç¾åœ¨ã®å…¥åŠ›å†…å®¹ã‚’ã€å–å¼•ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é›†è¨ˆã—ãŸå†…å®¹ã§ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ"))return;const i={supplies:0,communication:0,transportation:0,entertainment:0,rent:0,utilities:0,other:0};let t=0;v.filter(r=>r.type==="expense").forEach(r=>{const l=typeof r.amount=="number"?r.amount:parseFloat(String(r.amount).replace(/,/g,""))||0,n=`${r.category||""} ${r.item||""} ${r.description||""}`;n.includes("æ¶ˆè€—å“")||n.includes("äº‹å‹™ç”¨å“")||n.includes("é›‘è²»")?i.supplies+=l:n.includes("é€šä¿¡")||n.includes("ãƒãƒƒãƒˆ")||n.includes("é›»è©±")?i.communication+=l:n.includes("æ—…è²»")||n.includes("äº¤é€š")||n.includes("é›»è»Š")||n.includes("ã‚¿ã‚¯ã‚·ãƒ¼")?i.transportation+=l:n.includes("æ¥å¾…")||n.includes("äº¤éš›")||n.includes("é£²é£Ÿ")?i.entertainment+=l:n.includes("å®¶è³ƒ")||n.includes("åœ°ä»£")||n.includes("é§è»Šå ´")?i.rent+=l:n.includes("æ°´é“")||n.includes("å…‰ç†±")||n.includes("é›»æ°—")||n.includes("ã‚¬ã‚¹")?i.utilities+=l:i.other+=l,t++}),h(i),D.success(`${t}ä»¶ã®çµŒè²»å–å¼•ã‚’é›†è¨ˆã—ã¾ã—ãŸ`)},f=Object.values(s).reduce((i,t)=>i+t,0),b=p>0?f/p*100:0;return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-text-main mb-2 whitespace-nowrap",children:"çµŒè²»æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"}),e.jsx("p",{className:"text-sm sm:text-base text-text-muted mb-6 sm:mb-8",children:"2025å¹´ã«ä½¿ã£ãŸçµŒè²»ã‚’ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«å…¥åŠ›ã—ã¾ã™"}),e.jsx("div",{className:"mb-8 p-5 bg-gradient-to-r from-primary/10 to-blue-500/10 rounded-xl border border-primary/20 shadow-sm hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(C,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold text-lg text-text-main",children:"å–å¼•ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é›†è¨ˆ"})]}),e.jsx("p",{className:"text-sm text-text-muted",children:"è¨˜å¸³æ¸ˆã¿ã®å–å¼•ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰çµŒè²»ã‚’è‡ªå‹•é›†è¨ˆã—ã¦ã€ç¾åœ¨ã®å…¥åŠ›å†…å®¹ã‚’ä¸Šæ›¸ãã—ã¾ã™"})]}),e.jsxs("button",{onClick:m,className:"w-full sm:w-auto px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-all text-sm font-bold shadow-md hover:shadow-lg active:scale-95 flex items-center justify-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"é›†è¨ˆã—ã¦ä¸Šæ›¸ã"]})]})}),e.jsx("div",{className:"space-y-3",children:q.map(i=>e.jsxs("div",{className:"bg-surface-elevated p-3 sm:p-4 rounded-lg transition-colors border border-transparent hover:border-border",children:[e.jsx("label",{className:"block text-base font-medium text-text-main mb-1",children:i.label}),e.jsx("p",{className:"text-xs text-text-muted mb-2",children:i.description}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:s[i.key]||"",onChange:t=>a(i.key,t.target.value),placeholder:"0",inputMode:"numeric",className:"w-full pl-4 pr-10 py-2.5 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-text-muted text-sm pointer-events-none",children:"å††"})]})]},i.key))}),e.jsxs("div",{className:"sticky bottom-4 mx-auto mt-8 p-4 bg-surface/90 backdrop-blur-md rounded-xl border-2 border-primary/20 shadow-lg max-w-lg z-10 transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-semibold text-text-main",children:"çµŒè²»åˆè¨ˆ"})]}),e.jsxs("span",{className:"text-2xl font-bold text-primary",children:["Â¥",f.toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-text-muted",children:"å£²ä¸Šã«å¯¾ã™ã‚‹çµŒè²»ç‡"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${b>70?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.min(b,100)}%`}})}),e.jsxs("span",{className:`font-medium ${b>70?"text-orange-500":"text-text-main"}`,children:[b.toFixed(1),"%"]})]})]}),b>70&&e.jsx("div",{className:"mt-2 p-2 bg-orange-500/10 rounded text-xs text-orange-600 font-medium",children:"âš ï¸ çµŒè²»ç‡ãŒé«˜ã‚ã§ã™ã€‚å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"})]}),e.jsxs("div",{className:"mt-10 mb-6 flex gap-4",children:[e.jsx("button",{onClick:d,className:"flex-1 sm:flex-none px-6 sm:px-8 py-3.5 sm:py-3 rounded-lg font-medium bg-surface-elevated text-text-main hover:bg-surface transition-all border border-border whitespace-nowrap text-sm sm:text-base",children:"æˆ»ã‚‹"}),e.jsx("button",{onClick:c,className:"flex-1 sm:flex-none sm:ml-auto px-6 sm:px-8 py-3.5 sm:py-3 rounded-lg font-medium bg-primary text-white hover:bg-primary/90 transition-all shadow-sm whitespace-nowrap text-sm sm:text-base",children:"æ¬¡ã¸é€²ã‚€"})]})]})},te=({onNext:s,onBack:g,onChange:p})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center",children:e.jsx($,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-text-main",children:"æ¸›ä¾¡å„Ÿå´ã®å…¥åŠ›"}),e.jsx("p",{className:"text-sm text-text-muted",children:"10ä¸‡å††ã€œ30ä¸‡å††ä»¥ä¸Šã®è³‡ç”£ãŒã‚ã‚‹å ´åˆã¯ã“ã¡ã‚‰ã«å…¥åŠ›ã—ã¦ãã ã•ã„"})]})]}),e.jsx("div",{className:"border border-border rounded-xl p-3 md:p-6 bg-surface-highlight/20",children:e.jsx(G,{onCalculate:h=>p(h),initialAssets:[]})}),e.jsxs("div",{className:"flex justify-between pt-4 border-t border-border",children:[e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-6 py-3 text-text-muted hover:text-text-main transition-colors",children:[e.jsx(L,{className:"w-5 h-5"}),"å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸"]}),e.jsxs("button",{onClick:s,className:"btn-primary",children:["æ¬¡ã¸é€²ã‚€",e.jsx(U,{className:"w-5 h-5"})]})]})]}),se=[{key:"socialInsurance",label:"ç¤¾ä¼šä¿é™ºæ–™æ§é™¤",description:"å›½æ°‘å¹´é‡‘ã€å›½æ°‘å¥åº·ä¿é™ºãªã©",help:"æ”¯æ‰•ã£ãŸç¤¾ä¼šä¿é™ºæ–™ã®å…¨é¡ãŒæ§é™¤ã•ã‚Œã¾ã™ã€‚å¹´é‡‘å®šæœŸä¾¿ã‚„ãƒã‚¬ã‚­ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"},{key:"lifeInsurance",label:"ç”Ÿå‘½ä¿é™ºæ–™æ§é™¤",description:"ç”Ÿå‘½ä¿é™ºã€åŒ»ç™‚ä¿é™ºãªã©",help:"æœ€å¤§12ä¸‡å††ã¾ã§æ§é™¤ã•ã‚Œã¾ã™ã€‚ä¿é™ºä¼šç¤¾ã‹ã‚‰é€ã‚‰ã‚Œã¦ãã‚‹æ§é™¤è¨¼æ˜æ›¸ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"},{key:"earthquakeInsurance",label:"åœ°éœ‡ä¿é™ºæ–™æ§é™¤",description:"åœ°éœ‡ä¿é™ºæ–™",help:"æœ€å¤§5ä¸‡å††ã¾ã§æ§é™¤ã•ã‚Œã¾ã™ã€‚"},{key:"medicalExpenses",label:"åŒ»ç™‚è²»æ§é™¤",description:"ç—…é™¢ä»£ã€è–¬ä»£ãªã©",help:"10ä¸‡å††ã‚’è¶…ãˆãŸåˆ†ãŒæ§é™¤ã•ã‚Œã¾ã™ã€‚äº¤é€šè²»ï¼ˆé›»è»Šãƒ»ãƒã‚¹ï¼‰ã‚‚å¯¾è±¡ã«ãªã‚Šã¾ã™ã€‚"},{key:"donations",label:"å¯„é™„é‡‘æ§é™¤",description:"ãµã‚‹ã•ã¨ç´ç¨ãªã©",help:"2,000å††ã‚’è¶…ãˆãŸåˆ†ãŒæ§é™¤ã•ã‚Œã¾ã™ã€‚ãƒ¯ãƒ³ã‚¹ãƒˆãƒƒãƒ—ç‰¹ä¾‹ã‚’ä½¿ã‚ãªã„å ´åˆã«å…¥åŠ›ã—ã¾ã™ã€‚"}],ne=({data:s,onChange:g,onNext:p,onBack:h})=>{const[c,d]=w.useState(null),u=(t,r)=>{g({...s,[t]:parseInt(r)||0})},j=t=>{d(c===t?null:t)},v=()=>{const r=[...s.dependentDetails||[],{name:"",relationship:"",birthDate:"",income:0}];g({...s,dependentDetails:r,dependents:r.length})},a=t=>{const l=(s.dependentDetails||[]).filter((n,o)=>o!==t);g({...s,dependentDetails:l,dependents:l.length})},m=t=>{if(!t)return 0;const n=new Date().getFullYear()-1,o=new Date(n,11,31),x=new Date(t);let N=o.getFullYear()-x.getFullYear();const y=o.getMonth()-x.getMonth();return(y<0||y===0&&o.getDate()<x.getDate())&&N--,N<16?0:N>=19&&N<23?63e4:N>=70?48e4:38e4},f=t=>{if(!t)return 0;const n=new Date().getFullYear()-1,o=new Date(n,11,31),x=new Date(t);let N=o.getFullYear()-x.getFullYear();const y=o.getMonth()-x.getMonth();return(y<0||y===0&&o.getDate()<x.getDate())&&N--,N},b=(t,r,l)=>{const n=[...s.dependentDetails||[]];r==="income"?n[t]={...n[t],[r]:parseInt(l)||0}:r==="birthDate"?(m(l),n[t]={...n[t],[r]:l}):n[t]={...n[t],[r]:l},g({...s,dependentDetails:n})},i=Object.entries(s).reduce((t,[r,l])=>{if(r==="dependentDetails")return t;if(r==="dependents"){const n=s.dependentDetails||[];if(n.length>0){const o=n.reduce((x,N)=>x+m(N.birthDate),0);return t+o}return t}return t+(typeof l=="number"?l:0)},0);return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-text-main mb-2",children:"æ§é™¤æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"}),e.jsx("p",{className:"text-sm sm:text-base text-text-muted mb-6 sm:mb-8",children:"ç¨é‡‘ã‚’æ¸›ã‚‰ã›ã‚‹å„ç¨®æ§é™¤ã‚’å…¥åŠ›ã—ã¾ã™ï¼ˆè©²å½“ã™ã‚‹ã‚‚ã®ã ã‘ã§æ§‹ã„ã¾ã›ã‚“ï¼‰"}),e.jsxs("div",{className:"space-y-3",children:[se.map(t=>e.jsxs("div",{className:"bg-surface-elevated p-3 sm:p-4 rounded-lg border border-transparent transition-colors hover:border-border",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>j(t.key),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"block text-base font-medium text-text-main pointer-events-none",children:t.label}),e.jsx(T,{className:"w-4 h-4 text-text-muted"})]}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:t.description})]})}),e.jsx(I,{children:c===t.key&&e.jsx(S.div,{initial:{height:0,opacity:0,marginTop:0},animate:{height:"auto",opacity:1,marginTop:8},exit:{height:0,opacity:0,marginTop:0},className:"overflow-hidden",children:e.jsxs("div",{className:"bg-primary/5 p-3 rounded-lg text-sm text-text-main mb-3 border border-primary/10",children:["ğŸ’¡ ",t.help]})})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:s[t.key]||"",onChange:r=>u(t.key,r.target.value),placeholder:"0",inputMode:"numeric",className:"w-full pl-4 pr-10 py-2.5 bg-surface border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base text-text-main"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-text-muted text-sm pointer-events-none",children:"å††"})]})]},t.key)),e.jsxs("div",{className:"bg-surface-elevated p-3 sm:p-4 rounded-lg border border-transparent transition-colors hover:border-border",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>j("dependents"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"block text-base font-medium text-text-main pointer-events-none",children:"æ‰¶é¤Šæ§é™¤ï¼ˆæ‰¶é¤Šè¦ªæ—ï¼‰"}),e.jsx(T,{className:"w-4 h-4 text-text-muted"})]}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:"16æ­³ä»¥ä¸Šã®æ‰¶é¤Šè¦ªæ—ã®è©³ç´°ã‚’å…¥åŠ›"})]})}),e.jsx(I,{children:c==="dependents"&&e.jsx(S.div,{initial:{height:0,opacity:0,marginTop:0},animate:{height:"auto",opacity:1,marginTop:8},exit:{height:0,opacity:0,marginTop:0},className:"overflow-hidden",children:e.jsx("div",{className:"bg-primary/5 p-3 rounded-lg text-sm text-text-main mb-3 border border-primary/10",children:"ğŸ’¡ æ§é™¤é¡ã¯ç”Ÿå¹´æœˆæ—¥ã‹ã‚‰è‡ªå‹•è¨ˆç®—ã•ã‚Œã¾ã™ï¼ˆ16æ­³æœªæº€: 0å††ã€19-22æ­³: 63ä¸‡å††ã€ãã®ä»–: 38ä¸‡å††ç­‰ï¼‰ã€‚"})})}),e.jsxs("div",{className:"space-y-4",children:[(s.dependentDetails||[]).map((t,r)=>{const l=f(t.birthDate),n=m(t.birthDate);return e.jsxs("div",{className:"p-4 bg-surface rounded-lg border border-border relative",children:[e.jsx("button",{onClick:()=>a(r),className:"absolute top-2 right-2 text-text-muted hover:text-red-500",children:"âœ•"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"æ°å"}),e.jsx("input",{type:"text",value:t.name,onChange:o=>b(r,"name",o.target.value),className:"w-full px-3 py-2 bg-background border border-border rounded focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"ä¾‹: ä½è—¤ èŠ±å­"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"ç¶šæŸ„"}),e.jsx("input",{type:"text",value:t.relationship,onChange:o=>b(r,"relationship",o.target.value),className:"w-full px-3 py-2 bg-background border border-border rounded focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"ä¾‹: æ¯"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"ç”Ÿå¹´æœˆæ—¥"}),e.jsx("input",{type:"date",value:t.birthDate,onChange:o=>b(r,"birthDate",o.target.value),className:"w-full px-3 py-2 bg-background border border-border rounded focus:outline-none focus:ring-1 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"è¦ªæ—ã®å¹´é–“æ‰€å¾—ï¼ˆæ§é™¤é¡ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰"}),e.jsx("input",{type:"number",value:t.income,onChange:o=>b(r,"income",o.target.value),className:"w-full px-3 py-2 bg-background border border-border rounded focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"0"})]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-border/50 text-right",children:[e.jsxs("span",{className:"text-xs text-text-muted mr-2",children:["å¹´é½¢: ",l,"æ­³"]}),e.jsxs("span",{className:"text-sm font-bold text-primary",children:["æ§é™¤é¡: ",n.toLocaleString(),"å††",l<16&&e.jsx("span",{className:"text-xs text-text-muted ml-1",children:"ï¼ˆå¹´å°‘æ‰¶é¤Šè¦ªæ—ãƒ»ä½æ°‘ç¨å¯¾è±¡ï¼‰"})]})]})]},r)}),e.jsx("button",{onClick:v,className:"w-full py-2 border-2 border-dashed border-border rounded-lg text-text-muted hover:text-primary hover:border-primary transition-colors flex items-center justify-center gap-2",children:e.jsx("span",{children:"+ æ‰¶é¤Šè¦ªæ—ã‚’è¿½åŠ "})})]})]})]}),e.jsxs("div",{className:`mt-6 p-4 rounded-xl border-2 transition-all ${i>0?"bg-green-500/10 border-green-500/20":"bg-surface-elevated border-border"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:`w-5 h-5 ${i>0?"text-green-600":"text-text-muted"}`}),e.jsx("span",{className:"font-semibold text-text-main",children:"æ§é™¤åˆè¨ˆ"})]}),e.jsxs("span",{className:`text-2xl font-bold ${i>0?"text-green-600":"text-text-main"}`,children:["Â¥",i.toLocaleString()]})]}),e.jsx("p",{className:"text-xs sm:text-sm text-text-muted mt-2",children:"åŸºç¤æ§é™¤48ä¸‡å††ã«åŠ ãˆã¦ã€ä¸Šè¨˜ã®æ§é™¤ãŒé©ç”¨ã•ã‚Œã¾ã™"})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-500/10 rounded-lg border border-blue-500/20",children:e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"ğŸ’¡ æ§é™¤ã®è¨¼æ˜æ›¸é¡ã¯ç¢ºå®šç”³å‘Šæ™‚ã«æå‡ºãŒå¿…è¦ã§ã™ã€‚å¤§åˆ‡ã«ä¿ç®¡ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚"})}),e.jsxs("div",{className:"mt-10 flex gap-4",children:[e.jsx("button",{onClick:h,className:"flex-1 sm:flex-none px-6 sm:px-8 py-3.5 sm:py-3 rounded-lg font-medium bg-surface-elevated text-text-main hover:bg-surface transition-all border border-border",children:"æˆ»ã‚‹"}),e.jsx("button",{onClick:p,className:"flex-1 sm:flex-none sm:ml-auto px-6 sm:px-8 py-3.5 sm:py-3 rounded-lg font-medium bg-primary text-white hover:bg-primary/90 transition-all shadow-sm",children:"æ¬¡ã¸é€²ã‚€"})]})]})},re=s=>{const g=s.income.totalRevenue,p=Object.values(s.expenses).reduce((m,f)=>m+f,0)+(s.depreciation||0),h=g-p,d=48e4+Object.entries(s.deductions).reduce((m,[f,b])=>{if(f==="dependentDetails")return m;if(f==="dependents"){const i=s.deductions.dependentDetails||[];if(i.length>0){const t=r=>{if(!r)return 0;const o=new Date().getFullYear()-1,x=new Date(o,11,31),N=new Date(r);let y=x.getFullYear()-N.getFullYear();const Y=x.getMonth()-N.getMonth();return(Y<0||Y===0&&x.getDate()<N.getDate())&&y--,y<16?0:y>=19&&y<23?63e4:y>=70?48e4:38e4};return m+i.reduce((r,l)=>r+t(l.birthDate),0)}return m}return m+(typeof b=="number"?b:0)},0),u=Math.max(0,h-d);let j=0;u<=195e4?j=u*.05:u<=33e5?j=195e4*.05+(u-195e4)*.1:u<=695e4?j=195e4*.05+135e4*.1+(u-33e5)*.2:u<=9e6?j=195e4*.05+135e4*.1+365e4*.2+(u-695e4)*.23:u<=18e6?j=195e4*.05+135e4*.1+365e4*.2+205e4*.23+(u-9e6)*.33:u<=4e7?j=195e4*.05+135e4*.1+365e4*.2+205e4*.23+9e6*.33+(u-18e6)*.4:j=195e4*.05+135e4*.1+365e4*.2+205e4*.23+9e6*.33+22e6*.4+(u-4e7)*.45;const v=Math.floor(j*.021),a=Math.floor(j)+v;return{totalIncome:g,totalExpenses:p,netIncome:h,totalDeductions:d,taxableIncome:u,incomeTax:Math.floor(j),reconstructionTax:v,totalTax:a}},ae=(s,g)=>{const p=`quickTaxFiling_${s}`,h={...g,updatedAt:new Date().toISOString()};localStorage.setItem(p,JSON.stringify(h))},le=s=>{const g=`quickTaxFiling_${s}`,p=localStorage.getItem(g);if(!p)return null;try{return JSON.parse(p)}catch(h){return console.error("Failed to parse stored tax filing data:",h),null}},ie=s=>{const g=`quickTaxFiling_${s}`;localStorage.removeItem(g)},oe=({data:s,onBack:g,onComplete:p})=>{const[h,c]=w.useState(!1),d=re(s),u=(a,m)=>{const f=Object.entries(a.expenses).filter(([n,o])=>o>0).map(([n,o])=>{let x="é›‘è²»";return n==="supplies"&&(x="æ¶ˆè€—å“è²»"),n==="communication"&&(x="é€šä¿¡è²»"),n==="transportation"&&(x="æ—…è²»äº¤é€šè²»"),n==="entertainment"&&(x="æ¥å¾…äº¤éš›è²»"),n==="rent"&&(x="åœ°ä»£å®¶è³ƒ"),n==="utilities"&&(x="æ°´é“å…‰ç†±è²»"),{category:x,amount:o}});a.depreciation&&a.depreciation>0&&f.push({category:"æ¸›ä¾¡å„Ÿå´è²»",amount:a.depreciation});const b=a.deductions.dependentDetails||[],i=new Date,t=new Date(i.getFullYear()-1,11,31),r=b.filter(n=>{const o=new Date(n.birthDate);let x=t.getFullYear()-o.getFullYear();const N=t.getMonth()-o.getMonth();return(N<0||N===0&&t.getDate()<o.getDate())&&x--,x>=16}),l=b.filter(n=>{const o=new Date(n.birthDate);let x=t.getFullYear()-o.getFullYear();const N=t.getMonth()-o.getMonth();return(N<0||N===0&&t.getDate()<o.getDate())&&x--,x<16});return{companyName:a.basicInfo.name,representativeName:a.basicInfo.name,address:a.basicInfo.address,fiscalYear:new Date().getFullYear()-1,businessType:(a.basicInfo.businessType==="corporate","individual"),revenue:a.income.totalRevenue,expenses:m.totalExpenses,netIncome:m.netIncome,expensesByCategory:f,taxableIncome:m.taxableIncome,estimatedTax:m.incomeTax,deductions:{basic:48e4,blueReturn:a.basicInfo.filingType==="blue"?65e4:1e5,socialInsurance:a.deductions.socialInsurance,lifeInsurance:a.deductions.lifeInsurance},isBlueReturn:a.basicInfo.filingType==="blue",manualData:{family_details:{spouse:null,dependents:r.map((n,o)=>({id:`dep-${o}`,name:n.name,relationship:n.relationship,birth_date:n.birthDate,income:n.income,living_separately:!1,disability_type:"none"}))},resident_tax:{collection_method:"ordinary",dependent_under_16_names:l.map(n=>n.name)}}}},j=async()=>{c(!0);try{const a=u(s,d),m=await z(a);if(v(m,`ç¢ºå®šç”³å‘Šæ›¸B_${a.fiscalYear}.pdf`),s.basicInfo.filingType==="blue"){const f=await H(a);v(f,`é’è‰²ç”³å‘Šæ±ºç®—æ›¸_${a.fiscalYear}.pdf`)}alert("PDFã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚"),p()}catch(a){console.error("PDF generation failed:",a),alert("PDFã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚")}finally{c(!1)}},v=(a,m)=>{const f=new Blob([a],{type:"application/pdf"}),b=URL.createObjectURL(f),i=document.createElement("a");i.href=b,i.download=m,document.body.appendChild(i),i.click(),document.body.removeChild(i)};return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-text-main mb-2",children:"å…¥åŠ›å†…å®¹ã®ç¢ºèª"}),e.jsx("p",{className:"text-sm sm:text-base text-text-muted mb-6 sm:mb-8",children:"å…¥åŠ›ã—ãŸå†…å®¹ã‚’ç¢ºèªã—ã¦ã€ç¢ºå®šç”³å‘Šæ›¸é¡ã‚’ç”Ÿæˆã—ã¾ã™"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-8",children:[e.jsxs("div",{className:"bg-surface-elevated p-5 rounded-xl border border-border/50",children:[e.jsxs("h3",{className:"font-bold text-text-main mb-4 flex items-center gap-2 text-lg",children:[e.jsx(k,{className:"w-5 h-5 text-green-500"}),"åŸºæœ¬æƒ…å ±"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between border-b border-border/50 pb-2 last:border-0 last:pb-0",children:[e.jsx("span",{className:"text-text-muted",children:"æ°å"}),e.jsx("span",{className:"text-text-main font-medium",children:s.basicInfo.name})]}),e.jsxs("div",{className:"flex justify-between border-b border-border/50 pb-2 last:border-0 last:pb-0",children:[e.jsx("span",{className:"text-text-muted",children:"äº‹æ¥­ç¨®é¡"}),e.jsx("span",{className:"text-text-main font-medium",children:s.basicInfo.businessType})]}),e.jsxs("div",{className:"flex justify-between border-b border-border/50 pb-2 last:border-0 last:pb-0",children:[e.jsx("span",{className:"text-text-muted",children:"ç”³å‘Šç¨®é¡"}),e.jsx("span",{className:"text-text-main font-medium",children:s.basicInfo.filingType==="blue"?"é’è‰²ç”³å‘Š":"ç™½è‰²ç”³å‘Š"})]})]})]}),e.jsxs("div",{className:"bg-surface-elevated p-5 rounded-xl border border-border/50",children:[e.jsxs("h3",{className:"font-bold text-text-main mb-4 flex items-center gap-2 text-lg",children:[e.jsx(k,{className:"w-5 h-5 text-green-500"}),"åå…¥æƒ…å ±"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between border-b border-border/50 pb-2 last:border-0 last:pb-0",children:[e.jsx("span",{className:"text-text-muted",children:"ç·åå…¥"}),e.jsxs("span",{className:"text-text-main font-medium text-base",children:["Â¥",s.income.totalRevenue.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between border-b border-border/50 pb-2 last:border-0 last:pb-0",children:[e.jsx("span",{className:"text-text-muted",children:"åå…¥æº"}),e.jsx("span",{className:"text-text-main font-medium text-right max-w-[60%]",children:s.income.sources.join(", ")})]})]})]}),e.jsxs("div",{className:"bg-surface-elevated p-5 rounded-xl border border-border/50",children:[e.jsxs("h3",{className:"font-bold text-text-main mb-4 flex items-center gap-2 text-lg",children:[e.jsx(k,{className:"w-5 h-5 text-green-500"}),"çµŒè²»æƒ…å ±"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[Object.entries(s.expenses).map(([a,m])=>{const f={supplies:"æ¶ˆè€—å“è²»",communication:"é€šä¿¡è²»",transportation:"æ—…è²»äº¤é€šè²»",entertainment:"æ¥å¾…äº¤éš›è²»",rent:"åœ°ä»£å®¶è³ƒ",utilities:"æ°´é“å…‰ç†±è²»",other:"ãã®ä»–"};return m>0?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-muted",children:f[a]}),e.jsxs("span",{className:"text-text-main font-medium",children:["Â¥",m.toLocaleString()]})]},a):null}),(s.depreciation??0)>0&&e.jsxs("div",{className:"flex justify-between py-1 text-primary",children:[e.jsx("span",{className:"text-text-muted",children:"æ¸›ä¾¡å„Ÿå´è²»"}),e.jsxs("span",{className:"font-medium",children:["Â¥",(s.depreciation??0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between pt-3 mt-1 border-t border-border",children:[e.jsx("span",{className:"text-text-main font-bold",children:"åˆè¨ˆ"}),e.jsxs("span",{className:"text-text-main font-bold text-base",children:["Â¥",d.totalExpenses.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"bg-surface-elevated p-5 rounded-xl border border-border/50",children:[e.jsxs("h3",{className:"font-bold text-text-main mb-4 flex items-center gap-2 text-lg",children:[e.jsx(k,{className:"w-5 h-5 text-green-500"}),"æ§é™¤æƒ…å ±"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-muted",children:"åŸºç¤æ§é™¤"}),e.jsx("span",{className:"text-text-main font-medium",children:"Â¥480,000"})]}),Object.entries(s.deductions).map(([a,m])=>{var b;const f={socialInsurance:"ç¤¾ä¼šä¿é™ºæ–™",lifeInsurance:"ç”Ÿå‘½ä¿é™ºæ–™",earthquakeInsurance:"åœ°éœ‡ä¿é™ºæ–™",medicalExpenses:"åŒ»ç™‚è²»",donations:"å¯„é™„é‡‘",dependents:"æ‰¶é¤Šæ§é™¤"};return m>0?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-muted",children:f[a]}),e.jsx("span",{className:"text-text-main font-medium",children:a==="dependents"?(b=s.deductions.dependentDetails)!=null&&b.length?`Â¥${s.deductions.dependentDetails.reduce((i,t)=>{const r=new Date,l=new Date(r.getFullYear()-1,11,31),n=new Date(t.birthDate);let o=l.getFullYear()-n.getFullYear();const x=l.getMonth()-n.getMonth();return(x<0||x===0&&l.getDate()<n.getDate())&&o--,o<16?i:o>=19&&o<23?i+63e4:o>=70?i+48e4:i+38e4},0).toLocaleString()}`:`${m}äºº`:`Â¥${m.toLocaleString()}`})]},a):null}),e.jsxs("div",{className:"flex justify-between pt-3 mt-1 border-t border-border",children:[e.jsx("span",{className:"text-text-main font-bold",children:"åˆè¨ˆ"}),e.jsxs("span",{className:"text-text-main font-bold text-base",children:["Â¥",d.totalDeductions.toLocaleString()]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-primary/5 to-purple-500/10 p-5 sm:p-6 rounded-xl border border-primary/20 mb-8 shadow-sm",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-main mb-6 flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6 text-primary"}),"ç¨é¡è¨ˆç®—çµæœ"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-surface/80 p-4 rounded-lg border border-border/50",children:[e.jsx("div",{className:"text-xs text-text-muted mb-1",children:"æ‰€å¾—é‡‘é¡"}),e.jsxs("div",{className:"text-xl font-bold text-text-main",children:["Â¥",d.netIncome.toLocaleString()]})]}),e.jsxs("div",{className:"bg-surface/80 p-4 rounded-lg border border-border/50",children:[e.jsx("div",{className:"text-xs text-text-muted mb-1",children:"èª²ç¨æ‰€å¾—"}),e.jsxs("div",{className:"text-xl font-bold text-text-main",children:["Â¥",d.taxableIncome.toLocaleString()]})]}),e.jsxs("div",{className:"bg-surface/80 p-4 rounded-lg border border-border/50",children:[e.jsx("div",{className:"text-xs text-text-muted mb-1",children:"æ‰€å¾—ç¨é¡"}),e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:["Â¥",d.incomeTax.toLocaleString()]})]}),e.jsxs("div",{className:"bg-surface/80 p-4 rounded-lg border-2 border-primary/20 relative overflow-hidden",children:[e.jsx("div",{className:"text-xs text-text-muted mb-1",children:"åˆè¨ˆç´ç¨é¡"}),e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["Â¥",d.totalTax.toLocaleString()]})]})]})]}),e.jsx("div",{className:"bg-orange-500/10 p-4 rounded-lg border border-orange-500/20 mb-8",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-orange-600",children:[e.jsx("p",{className:"font-bold mb-1",children:"é‡è¦ãªæ³¨æ„äº‹é …"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 opacity-90",children:[e.jsx("li",{children:"ã“ã®è¨ˆç®—çµæœã¯æ¦‚ç®—ã§ã™ã€‚æ­£ç¢ºãªç¨é¡ã¯ç¨å‹™ç½²ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚"}),e.jsx("li",{children:"é’è‰²ç”³å‘Šã®å ´åˆã€åˆ¥é€”é’è‰²ç”³å‘Šç‰¹åˆ¥æ§é™¤ï¼ˆæœ€å¤§65ä¸‡å††ï¼‰ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚"}),e.jsx("li",{children:"ç¢ºå®šç”³å‘Šæ›¸é¡ã®æå‡ºæœŸé™ã¯3æœˆ15æ—¥ã§ã™ã€‚"})]})]})]})}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-4",children:[e.jsx("button",{onClick:g,className:"w-full sm:w-auto px-8 py-3.5 rounded-lg font-medium bg-surface-elevated text-text-main hover:bg-surface transition-all border border-border",children:"æˆ»ã‚‹"}),e.jsx("button",{onClick:j,disabled:h,className:"flex-1 px-8 py-3.5 rounded-lg font-medium bg-primary text-white hover:bg-primary/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg hover:shadow-xl active:scale-98",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ç”Ÿæˆä¸­..."]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-5 h-5"}),"ç¢ºå®šç”³å‘Šæ›¸é¡ã‚’ç”Ÿæˆã™ã‚‹"]})})]})]})},ke=()=>{const{user:s}=F(),g=O(),[p,h]=w.useState(1),[c,d]=w.useState({basicInfo:{name:"",address:"",myNumber:"",businessType:"",filingType:"blue"},income:{totalRevenue:0,sources:[]},expenses:{supplies:0,communication:0,transportation:0,entertainment:0,rent:0,utilities:0,other:0},depreciation:0,deductions:{socialInsurance:0,lifeInsurance:0,earthquakeInsurance:0,medicalExpenses:0,donations:0,dependents:0}});w.useEffect(()=>{s!=null&&s.id||g("/login")},[s,g]),w.useEffect(()=>{if(s!=null&&s.id){const t=le(s.id);t&&d(t)}},[s]),w.useEffect(()=>{s!=null&&s.id&&ae(s.id,c)},[c,s]);const u=t=>{d({...c,basicInfo:t})},j=t=>{d({...c,income:t})},v=t=>{d({...c,expenses:t})},a=t=>{d({...c,depreciation:t})},m=t=>{d({...c,deductions:t})},f=()=>{h(t=>Math.min(6,t+1)),window.scrollTo({top:0,behavior:"smooth"})},b=()=>{h(t=>Math.max(1,t-1)),window.scrollTo({top:0,behavior:"smooth"})},i=()=>{s!=null&&s.id&&ie(s.id),g("/dashboard")};return e.jsx("div",{className:"min-h-screen bg-background pb-12",children:e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(P,{to:"/dashboard",className:"mr-3",children:e.jsx(L,{className:"w-5 h-5 text-text-muted hover:text-text-main"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-primary/10 rounded-lg",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-text-main",children:"é§†ã‘è¾¼ã¿ç¢ºå®šç”³å‘Š"}),e.jsx("p",{className:"text-[11px] text-text-muted mt-0.5",children:"è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€1æ—¥ã§ç¢ºå®šç”³å‘Šæ›¸é¡ã‚’å®Œæˆ"})]})]})})]}),e.jsx(Q,{currentStep:p}),e.jsx("div",{className:"bg-surface rounded-xl shadow-sm border border-border p-3 sm:p-8 overflow-hidden",children:e.jsx(I,{mode:"wait",children:e.jsxs(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[p===1&&e.jsx(Z,{data:c.basicInfo,onChange:u,onNext:f}),p===2&&e.jsx(X,{data:c.income,onChange:j,onNext:f,onBack:b}),p===3&&e.jsx(ee,{data:c.expenses,businessType:c.basicInfo.businessType,totalRevenue:c.income.totalRevenue,onChange:v,onNext:f,onBack:b}),p===4&&e.jsx(te,{onChange:a,onNext:f,onBack:b}),p===5&&e.jsx(ne,{data:c.deductions,onChange:m,onNext:f,onBack:b}),p===6&&e.jsx(oe,{data:c,onBack:b,onComplete:i})]},p)})}),e.jsx("div",{className:"mt-6 sm:mt-8 text-center text-xs sm:text-sm text-text-muted",children:e.jsx("p",{children:"å…¥åŠ›å†…å®¹ã¯è‡ªå‹•çš„ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚ã„ã¤ã§ã‚‚ä¸­æ–­ãƒ»å†é–‹ã§ãã¾ã™ã€‚"})})]})})};export{ke as default};
