import{c as ee,a as se,e as te,l as ae,u as re,r as o,j as e,L as w,F as T,G as h,p as ie,x as O,d as ne}from"./index-0N2qkU5h.js";import{g as le,c as ce,a as me,f as a,b as de,e as xe}from"./CorporateTaxService-BzRMdiLF.js";import{a as P,C as _,i as A}from"./CsvExportService-DlAxBSAy.js";import{D as oe}from"./DepreciationCalculator-shZj6pwx.js";import{c as pe,d as he}from"./pdfJapaneseService-D1N1wNyh.js";import{W as ue}from"./WizardProgress-Cf72EM6B.js";import{A as D}from"./arrow-left-B0TMViCY.js";import{B as S}from"./building-2-BjF2V6NY.js";import{B as I}from"./book-open-BLHWOQ_9.js";import{C as je}from"./calculator-D8eOG1Ma.js";import{W as be}from"./wallet-CPyD2Yee.js";import{D as Ne}from"./download-B1A3RFjc.js";import{A as k}from"./arrow-right-YBay0vsy.js";import{C as fe}from"./circle-check-big-DmSb12v6.js";import{R as f}from"./refresh-cw-Bn714JZc.js";import{W as ge}from"./wrench-DTFJCHrV.js";import{I as $}from"./info-BRD8O0HW.js";import{C as ye}from"./copy-C6Q9fCnQ.js";import"./circle-question-mark-C5sOGnto.js";import"./pdfAutoFillService-34BIRZFS.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],we=ee("piggy-bank",ve),C=[{id:1,title:"会社情報",icon:S,description:"会社基本情報の入力"},{id:2,title:"減価償却",icon:je,description:"資産の登録と計算"},{id:3,title:"損益計算",icon:T,description:"売上・経費の確認"},{id:4,title:"法人税計算",icon:we,description:"法人税等の計算"},{id:5,title:"消費税確認",icon:be,description:"消費税の確認"},{id:6,title:"書類作成",icon:Ne,description:"PDF出力"}],Ce=({corporateInfo:s,setCorporateInfo:n,handleInfoChange:l,handleTranscribe:c})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-1",children:"会社基本情報"}),e.jsx("p",{className:"text-text-muted",children:"法人税申告に必要な会社情報を入力してください。"})]}),e.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors text-primary text-sm font-medium whitespace-nowrap",children:[e.jsx(f,{className:"w-4 h-4"}),"登録データから転記"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["会社名 ",e.jsx("span",{className:"text-error",children:"*"})]}),e.jsx("input",{type:"text",value:s.companyName,onChange:r=>n({...s,companyName:r.target.value}),className:"input-base",placeholder:"株式会社〇〇"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"代表者名"}),e.jsx("input",{type:"text",value:s.representativeName,onChange:r=>n({...s,representativeName:r.target.value}),className:"input-base",placeholder:"山田 太郎"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"法人番号"}),e.jsx("input",{type:"text",value:s.corporateNumber,onChange:r=>n({...s,corporateNumber:r.target.value}),className:"input-base",placeholder:"1234567890123"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"資本金"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:"¥"}),e.jsx("input",{type:"number",value:s.capital,onChange:r=>n({...s,capital:Number(r.target.value)}),className:"input-base pl-8"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"所在地"}),e.jsx("input",{type:"text",value:s.address,onChange:r=>n({...s,address:r.target.value}),className:"input-base",placeholder:"東京都渋谷区..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"事業年度（開始）"}),e.jsx("input",{type:"date",value:s.fiscalYearStart,onChange:r=>l({fiscalYearStart:r.target.value}),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"事業年度（終了）"}),e.jsx("input",{type:"date",value:s.fiscalYearEnd,onChange:r=>l({fiscalYearEnd:r.target.value}),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"所轄税務署"}),e.jsx("input",{type:"text",value:s.taxOffice||"",onChange:r=>l({taxOffice:r.target.value}),className:"input-base",placeholder:"例：芝税務署"})]})]}),e.jsxs("div",{className:"bg-info-light border border-info/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-info flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"中小法人の税制優遇"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"資本金1億円以下の中小法人は、年800万円以下の所得に対して15%の軽減税率が適用されます。"})]})]})]}),Te=({assets:s,onDepreciationCalculate:n,handleTranscribe:l})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-1",children:"減価償却資産の登録"}),e.jsx("p",{className:"text-text-muted",children:"10万円以上の資産や、減価償却が必要な資産を登録してください。"})]}),e.jsxs("button",{onClick:l,className:"flex items-center justify-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors text-primary text-sm font-medium whitespace-nowrap",children:[e.jsx(f,{className:"w-4 h-4"}),"取引データから転記"]})]}),e.jsx(oe,{initialAssets:s,onCalculate:n})]}),ke=({financialData:s,corporateInfo:n})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:"損益計算書"}),e.jsxs("p",{className:"text-text-muted mb-6",children:[n.fiscalYear,"年度の取引データから自動集計した結果です。"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-success-light border border-success/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-success font-medium",children:"売上高"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:a(s.revenue)})]}),e.jsxs("div",{className:"bg-error-light border border-error/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-error font-medium",children:"販管費"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:a(s.operatingExpenses)})]}),e.jsxs("div",{className:"bg-primary-light border border-primary/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-primary font-medium",children:"営業利益"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:a(s.operatingIncome)})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[e.jsx("h4",{className:"font-medium text-text-main mb-4",children:"損益計算書"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"売上高"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.revenue)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"売上原価"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.costOfSales)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border bg-surface-highlight px-2 -mx-2",children:[e.jsx("span",{className:"font-medium text-text-main",children:"売上総利益"}),e.jsx("span",{className:"font-bold text-text-main",children:a(s.grossProfit)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"販売費及び一般管理費"}),e.jsx("span",{className:"font-medium text-error",children:a(s.operatingExpenses)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border bg-primary-light px-2 -mx-2",children:[e.jsx("span",{className:"font-medium text-text-main",children:"営業利益"}),e.jsx("span",{className:"font-bold text-primary",children:a(s.operatingIncome)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"営業外損益"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.nonOperatingIncome-s.nonOperatingExpenses)})]}),e.jsxs("div",{className:"flex justify-between py-2 bg-success-light px-2 -mx-2 rounded",children:[e.jsx("span",{className:"font-bold text-text-main",children:"税引前当期純利益"}),e.jsx("span",{className:"font-bold text-success",children:a(s.incomeBeforeTax)})]})]})]}),s.expensesByCategory.length>0&&e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[e.jsx("h4",{className:"font-medium text-text-main mb-4",children:"経費内訳（上位5件）"}),e.jsx("div",{className:"space-y-3",children:s.expensesByCategory.slice(0,5).map((l,c)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-surface-highlight rounded-lg flex items-center justify-center text-sm font-medium text-text-muted",children:c+1}),e.jsx("span",{className:"text-text-main",children:l.category})]}),e.jsx("span",{className:"font-medium text-text-main",children:a(l.amount)})]},c))})]})]}),Se=({taxResult:s,corporateInfo:n,handleCopy:l,copiedField:c})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:"法人税等の計算"}),e.jsx("p",{className:"text-text-muted mb-6",children:"課税所得に基づいて法人税等を自動計算しました。"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-text-muted",children:"課税所得"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:a(s.taxableIncome)})]}),e.jsxs("div",{className:"bg-primary-light border border-primary/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-primary font-medium",children:"法人税等合計"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:a(s.totalTax)}),e.jsxs("p",{className:"text-xs text-text-muted mt-2",children:["実効税率: ",de(s.effectiveTaxRate)]})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl divide-y divide-border",children:[e.jsx("div",{className:"p-4",children:e.jsx("h4",{className:"font-medium text-text-main",children:"法人税等の内訳"})}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-main",children:"法人税"}),n.capital<=1e8&&e.jsx("span",{className:"ml-2 text-xs text-success bg-success-light px-2 py-0.5 rounded",children:"中小法人軽減"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-text-main",children:a(s.corporateTax)}),e.jsx("button",{onClick:()=>l(s.corporateTax,"corporateTax"),className:`p-1.5 rounded transition-colors ${c==="corporateTax"?"bg-success text-white":"hover:bg-surface-highlight text-text-muted"}`,children:c==="corporateTax"?e.jsx(ne,{className:"w-4 h-4"}):e.jsx(ye,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"地方法人税"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.localCorporateTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"法人住民税"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.corporateInhabitantTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"法人事業税"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.businessTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-primary-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"税金合計"}),e.jsx("span",{className:"font-bold text-primary text-lg",children:a(s.totalTax)})]})]}),e.jsxs("div",{className:"bg-success-light border border-success/20 rounded-xl p-5 flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-text-main",children:"当期純利益"}),e.jsx("span",{className:"text-2xl font-bold text-success",children:a(s.netIncome)})]}),s.taxableIncome<=0&&e.jsxs("div",{className:"bg-warning-light border border-warning/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"課税所得がありません"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"今期は課税所得がないため、法人税は発生しません（均等割のみ発生）。"})]})]})]}),Ye=({consumptionTaxResult:s})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:"消費税の確認"}),e.jsx("p",{className:"text-text-muted mb-6",children:"売上・仕入に係る消費税を集計しました。"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl divide-y divide-border",children:[e.jsx("div",{className:"p-4",children:e.jsx("h4",{className:"font-medium text-text-main",children:"消費税計算"})}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"課税売上高"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.taxableRevenue)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"売上に係る消費税"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.outputTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"課税仕入高"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.taxablePurchases)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"仕入に係る消費税"}),e.jsx("span",{className:"font-medium text-error",children:a(s.inputTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-primary-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"納付消費税額（国税）"}),e.jsx("span",{className:"font-bold text-primary",children:a(s.netConsumptionTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"地方消費税"}),e.jsx("span",{className:"font-medium text-text-main",children:a(s.localConsumptionTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-success-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"消費税等合計"}),e.jsx("span",{className:"font-bold text-success text-lg",children:a(s.totalConsumptionTax)})]})]}),e.jsxs("div",{className:"bg-info-light border border-info/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-info flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"免税事業者の確認"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"基準期間の課税売上高が1,000万円以下の場合、消費税の納税義務が免除される場合があります。"})]})]})]}),Be=({corporateInfo:s,financialData:n,taxResult:l,isLoading:c,generatePDF:r,handleOpenInEditor:N})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-main mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-primary"}),"書類の作成・ダウンロード"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"入力内容を確認して、必要な書類をダウンロードしてください。"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl divide-y divide-border",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"会社名"}),e.jsx("span",{className:"font-medium text-text-main",children:s.companyName||"（未入力）"})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"事業年度"}),e.jsxs("span",{className:"font-medium text-text-main",children:[s.fiscalYear,"年度"]})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"売上高"}),e.jsx("span",{className:"font-medium text-success",children:a(n.revenue)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"営業利益"}),e.jsx("span",{className:"font-medium text-primary",children:a(n.operatingIncome)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"法人税等"}),e.jsx("span",{className:"font-medium text-error",children:a(l.totalTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-success-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"当期純利益"}),e.jsx("span",{className:"font-bold text-success",children:a(l.netIncome)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>r("financial"),disabled:c,className:"flex items-center justify-center gap-2 p-6 bg-surface border border-border rounded-xl hover:border-primary hover:bg-primary-light transition-colors",children:[c?e.jsx(f,{className:"w-6 h-6 animate-spin text-primary"}):e.jsx(T,{className:"w-6 h-6 text-primary"}),e.jsx("div",{className:"text-left",children:e.jsx("p",{className:"text-sm text-text-muted",children:"損益計算書・貸借対照表"})})]}),e.jsxs("button",{onClick:()=>{if(n){const g=P.generateFinancialStatementCSV({...s,...n,fiscalYear:s.fiscalYear,taxableIncome:l.taxableIncome,estimatedTax:l.totalTax});P.downloadCSV(g,`financial_statements_${s.companyName}_${s.fiscalYear}.csv`),h.success("財務諸表CSVを出力しました")}},disabled:c,className:"flex items-center justify-center gap-2 p-6 bg-surface border border-border rounded-xl hover:border-primary hover:bg-primary-light transition-colors",children:[e.jsx(I,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-text-main",children:"財務諸表データ(CSV)"}),e.jsx("p",{className:"text-sm text-text-muted",children:"e-Tax取込用"})]})]}),e.jsxs("button",{onClick:()=>r("corporate"),disabled:c,className:"flex items-center justify-center gap-2 p-6 bg-surface border border-border rounded-xl hover:border-primary hover:bg-primary-light transition-colors",children:[c?e.jsx(f,{className:"w-6 h-6 animate-spin text-primary"}):e.jsx(S,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-text-main",children:"法人税申告書"}),e.jsx("p",{className:"text-sm text-text-muted",children:"法人税の概要"})]})]})]}),e.jsx("div",{className:"bg-surface-highlight rounded-xl p-5 border border-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-text-main flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-primary"}),"申告書を詳細に編集する"]}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"別表の調整や、細かい数字の修正が必要な場合は、詳細エディタをご利用ください。"})]}),e.jsxs("button",{onClick:N,className:"btn-secondary whitespace-nowrap",children:["詳細エディタで開く",e.jsx(k,{className:"w-4 h-4 ml-2"})]})]})}),e.jsxs("div",{className:"bg-warning-light border border-warning/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"ご注意"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"この書類は参考資料です。正式な法人税申告は税理士にご相談いただくか、 e-Taxにて提出してください。"})]})]}),e.jsx("div",{className:"bg-surface border border-border rounded-xl p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-5 h-5 text-text-muted"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-main",children:"PDF座標キャリブレーター"}),e.jsx("p",{className:"text-sm text-text-muted",children:"公式PDFフォームの座標調整ツール"})]})]}),e.jsxs("a",{href:"/tools/coordinate_picker.html",target:"_blank",rel:"noopener noreferrer",className:"btn-ghost text-sm flex items-center gap-1",children:["開く",e.jsx(k,{className:"w-4 h-4"})]})]})})]}),Ke=()=>{const{user:s}=se(),{currentBusinessType:n}=te(),{transactions:l}=ae(s==null?void 0:s.id,n==null?void 0:n.business_type),c=re(),[r,N]=o.useState(1),[g,Y]=o.useState(!1),[W,B]=o.useState(null),M=()=>{if(window.confirm(`現在の計算結果を詳細エディタに転記して開きますか？
（エディタの既存データは上書きされます）`)){const t=_.calculateDataFromTransactions(l,i);_.saveData({...A,...t,companyInfo:{...A.companyInfo,corporateName:i.companyName,representativeName:i.representativeName,corporateNumber:i.corporateNumber||"",address:i.address||"",taxOffice:i.taxOffice||"",capitalAmount:i.capital,fiscalYearStart:i.fiscalYearStart,fiscalYearEnd:i.fiscalYearEnd}}),c("/corporate-tax/input")}},y=new Date().getFullYear(),[i,v]=o.useState({companyName:"",representativeName:"",corporateNumber:"",address:"",taxOffice:"",capital:1e7,fiscalYearStart:`${y-1}-04-01`,fiscalYearEnd:`${y}-03-31`,fiscalYear:y-1,employeeCount:1}),L=t=>{v(m=>({...m,...t}))},[V,E]=o.useState([]),[p,z]=o.useState(0),U=(t,m)=>{z(t),E(m)},d=o.useMemo(()=>{const t=le(l,i.fiscalYear);if(p>0){const m=t.expensesByCategory.findIndex(x=>x.category==="減価償却費");m>=0?t.expensesByCategory[m].amount+=p:t.expensesByCategory.push({category:"減価償却費",amount:p}),t.operatingExpenses+=p,t.operatingIncome-=p,t.ordinaryIncome-=p,t.incomeBeforeTax-=p,t.expensesByCategory.sort((x,j)=>j.amount-x.amount)}return t},[l,i.fiscalYear,p]),u=o.useMemo(()=>ce(d,i),[d,i]),q=o.useMemo(()=>me(d.revenue,d.operatingExpenses),[d]),G=()=>{r<C.length&&N(r+1)},H=()=>{r>1&&N(r-1)},Z=()=>{if(!n){h.error("登録された事業情報が見つかりません。連携設定で登録してください。");return}v(t=>({...t,companyName:n.company_name||t.companyName,representativeName:n.representative_name||t.representativeName,corporateNumber:n.tax_number||t.corporateNumber,address:n.address||t.address})),h.success("事業情報を転記しました")},J=()=>{if(!l||l.length===0){h.error("取引データが見つかりません。");return}const t=xe(l,i.fiscalYear);if(t.length===0){h.error("転記可能な減価償却資産（タグ: depreciation_asset）が見つかりません。");return}E(t),h.success(`${t.length}件の減価償却資産を転記しました`)},K=async(t,m)=>{try{await navigator.clipboard.writeText(String(t).replace(/[¥,]/g,"")),B(m),setTimeout(()=>B(null),2e3)}catch(x){console.error("コピーに失敗しました:",x)}},Q=async t=>{Y(!0);try{const m={companyName:i.companyName||"（会社名未入力）",representativeName:i.representativeName,address:i.address,corporateNumber:i.corporateNumber,capital:i.capital,businessType:"corporation",revenue:d.revenue,expenses:d.operatingExpenses,netIncome:u.netIncome,expensesByCategory:d.expensesByCategory,fiscalYear:i.fiscalYear,taxableIncome:u.taxableIncome,estimatedTax:u.totalTax};let x,j;t==="corporate"?(x=await pe(m),j=`法人税申告書_${i.fiscalYear}年度.pdf`):(x=await he(m),j=`決算報告書_${i.fiscalYear}年度.pdf`);const R=new Blob([x],{type:"application/pdf"}),F=URL.createObjectURL(R),b=document.createElement("a");b.href=F,b.download=j,document.body.appendChild(b),b.click(),document.body.removeChild(b),window.open(F,"_blank")}catch(m){console.error("PDF生成エラー:",m)}finally{Y(!1)}},X=()=>{switch(r){case 1:return e.jsx(Ce,{corporateInfo:i,setCorporateInfo:v,handleInfoChange:L,handleTranscribe:Z});case 2:return e.jsx(Te,{assets:V,onDepreciationCalculate:U,handleTranscribe:J});case 3:return e.jsx(ke,{financialData:d,corporateInfo:i});case 4:return e.jsx(Se,{taxResult:u,corporateInfo:i,handleCopy:K,copiedField:W});case 5:return e.jsx(Ye,{consumptionTaxResult:q});case 6:return e.jsx(Be,{corporateInfo:i,financialData:d,taxResult:u,isLoading:g,generatePDF:Q,handleOpenInEditor:M});default:return null}};return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("main",{className:"w-full px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{to:"/dashboard",className:"mr-4 p-2 rounded-lg hover:bg-surface-highlight transition-colors",children:e.jsx(D,{className:"w-6 h-6 text-text-muted hover:text-text-main"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-text-main flex items-center gap-2",children:[e.jsx(S,{className:"w-7 h-7 text-primary"}),"法人税申告サポート"]}),e.jsx("p",{className:"text-text-muted mt-1",children:"法人決算・税務申告のサポート"})]})]}),e.jsxs(w,{to:"/corporate-tax-guide",className:"flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors text-primary",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"申告ガイド"})]})]}),e.jsx(ue,{currentStep:r,steps:C.map(t=>({number:t.id,title:t.title,description:t.description}))}),e.jsx("div",{className:"bg-surface rounded-xl border border-border p-6 md:p-8 mb-8 shadow-sm",children:X()}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("button",{onClick:H,disabled:r===1,className:`btn-ghost ${r===1?"invisible":""}`,children:[e.jsx(D,{className:"w-5 h-5 mr-2"}),"戻る"]}),r<C.length?e.jsxs("button",{onClick:G,className:"btn-primary min-w-[200px]",children:["次へ進む",e.jsx(k,{className:"w-5 h-5 ml-2"})]}):e.jsxs(w,{to:"/dashboard",className:"btn-primary min-w-[200px]",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"}),"ダッシュボードへ"]})]})]})})};export{Ke as default};
