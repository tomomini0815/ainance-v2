import{g as D,c as C}from"./CorporateTaxService-8ijqz51P.js";const s={companyInfo:{corporateName:"",corporateNameKana:"",corporateNumber:"",postalCode:"",address:"",phoneNumber:"",representativeName:"",representativeNameKana:"",representativeAddress:"",businessType:"",taxOffice:"",fiscalYearStart:"",fiscalYearEnd:"",filingDate:"",capitalAmount:1e6,employeeCount:1,groupCompanyType:"single",blueFormApproval:!0},beppyo1:{taxableIncome:0,corporateTaxAmount:0,specialTaxCredit:0,nationalInterimPayment:0,interimPayment:0,nationalTaxPayable:0,localCorporateTaxAmount:0,localInterimPayment:0,localTaxPayable:0,prefecturalTax:0,municipalTax:0,inhabitantInterimPayment:0,inhabitantTaxPayable:0,enterpriseTax:0,specialLocalEnterpriseTax:0,enterpriseInterimPayment:0,enterpriseTaxPayable:0,totalTaxAmount:0,refundAmount:0},beppyo4:{netIncomeFromPL:0,nonDeductibleTaxes:0,nonDeductibleEntertainment:0,excessDepreciation:0,additions:[],otherAdditions:[],deductibleEnterpriseTax:0,dividendExclusion:0,subtractions:[],otherSubtractions:[],taxableIncome:0},beppyo5:{retainedEarningsItems:[{id:"1",description:"利益準備金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"2",description:"別途積立金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"3",description:"繰越利益剰余金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"4",description:"未払法人税等",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"5",description:"未払事業税",beginAmount:0,increase:0,decrease:0,endAmount:0}],retainedEarningsBegin:0,currentIncrease:0,currentDecrease:0,totalRetainedEarningsEnd:0,capitalBegin:1e6,capitalIncrease:0,capitalDecrease:0,capitalEnd:1e6},beppyo5_2:{items:[],totalPaid:0,taxesPayable:{corporate:0,inhabitant:0,enterprise:0,localCorporate:0}},beppyo16:{assets:[],totalDepreciation:0,totalAllowable:0,excessAmount:0},beppyo15:{totalEntertainmentExpenses:0,foodAndDrinkExpenses:0,otherEntertainmentExpenses:0,capitalAmount:1e6,socialExpenses:0,deductibleExpenses:0,deductionLimit:8e6,excessAmount:0},beppyo2:{shareholders:[],totalShares:100,isFamilyCompany:!0},businessOverview:{sales:0,costOfSales:0,grossProfit:0,operatingExpenses:0,operatingIncome:0,ordinaryIncome:0,netIncome:0,directorsCompensation:0,employeesSalary:0,rent:0,taxesAndDues:0,entertainmentExpenses:0,depreciation:0},calibration:{globalShiftX:0,globalShiftY:0}},g="ainance_corporate_tax_input_data",w={saveData:e=>{try{localStorage.setItem(g,JSON.stringify(e))}catch(t){console.error("Failed to save corporate tax input data:",t)}},getData:()=>{try{const e=localStorage.getItem(g);if(e){const t=JSON.parse(e);return{...s,...t,companyInfo:{...s.companyInfo,...t.companyInfo||{}},beppyo1:{...s.beppyo1,...t.beppyo1||{}},beppyo4:{...s.beppyo4,...t.beppyo4||{}},beppyo5:{...s.beppyo5,...t.beppyo5||{}},beppyo5_2:{...s.beppyo5_2,...t.beppyo5_2||{}},beppyo16:{...s.beppyo16,...t.beppyo16||{}},beppyo15:{...s.beppyo15,...t.beppyo15||{}},beppyo2:{...s.beppyo2,...t.beppyo2||{}},businessOverview:{...s.businessOverview,...t.businessOverview||{}},calibration:{...s.calibration,...t.calibration||{}}}}}catch(e){console.error("Failed to load corporate tax input data:",e)}return s},resetData:()=>{localStorage.removeItem(g)},calculateDataFromTransactions:(e,t,i)=>{const d=new Date().getFullYear()-1,p=D(e,d,i),n=w.getData(),o=(t==null?void 0:t.capital)||(i==null?void 0:i.capital)||n.companyInfo.capitalAmount||1e6,a=(i==null?void 0:i.retainedEarnings)||0,c=C(p,{...n.companyInfo,...t,capital:o}),u=r=>{var m;return((m=p.expensesByCategory.find(I=>I.category.includes(r)))==null?void 0:m.amount)||0},f=u("役員報酬"),A=u("地代家賃"),E=u("租税公課"),x=u("交際費")+u("接待交際費"),S=u("減価償却費"),v=u("給料")+u("人件費"),h=u("飲食"),T=Math.max(0,(x||0)-8e6),y=e.filter(r=>{var m;return((m=r.tags)==null?void 0:m.includes("depreciation_asset"))&&new Date(r.date).getFullYear()===d}).map(r=>{var m;return{id:r.id,name:((m=r.description)==null?void 0:m.split(" ")[0])||"固定資産",acquisitionDate:r.date,acquisitionCost:Math.abs(Number(r.amount)||0),usefulLife:5,depreciationMethod:"straightLine",currentDepreciation:Math.abs(Number(r.amount)||0)/5,allowableLimit:Math.abs(Number(r.amount)||0)/5,bookValueEnd:Math.abs(Number(r.amount)||0)*.8}}),b=p.incomeBeforeTax||0;return{businessOverview:{sales:p.revenue||0,costOfSales:p.costOfSales||0,grossProfit:p.grossProfit||0,operatingExpenses:p.operatingExpenses||0,operatingIncome:p.operatingIncome||0,ordinaryIncome:p.ordinaryIncome||0,netIncome:b,directorsCompensation:f,employeesSalary:v,rent:A,taxesAndDues:E,entertainmentExpenses:x,depreciation:S},beppyo1:{...s.beppyo1,taxableIncome:Math.max(0,c.taxableIncome||0),corporateTaxAmount:Math.max(0,c.corporateTax||0),localCorporateTaxAmount:Math.max(0,c.localCorporateTax||0),prefecturalTax:Math.max(0,c.prefecturalTax||0),municipalTax:Math.max(0,c.municipalTax||0),enterpriseTax:Math.max(0,c.businessTax||0),totalTaxAmount:Math.max(0,c.totalTax||0),nationalTaxPayable:Math.max(0,c.corporateTax||0),localTaxPayable:Math.max(0,c.localCorporateTax||0),inhabitantTaxPayable:Math.max(0,(c.prefecturalTax||0)+(c.municipalTax||0)),enterpriseTaxPayable:Math.max(0,c.businessTax||0),interimPayment:0},beppyo4:{...s.beppyo4,netIncomeFromPL:b,nonDeductibleTaxes:E||0,nonDeductibleEntertainment:T||0,taxableIncome:Math.max(0,c.taxableIncome||0),additions:[],subtractions:[]},beppyo5:{...s.beppyo5,retainedEarningsBegin:a,currentIncrease:b,currentDecrease:0,totalRetainedEarningsEnd:a+b,capitalBegin:o,capitalEnd:o,retainedEarningsItems:(s.beppyo5.retainedEarningsItems||[]).map(r=>r.description==="繰越利益剰余金"?{...r,beginAmount:a,increase:b,endAmount:a+b}:r)},beppyo15:{...s.beppyo15,totalEntertainmentExpenses:x||0,foodAndDrinkExpenses:h||0,otherEntertainmentExpenses:(x||0)-(h||0),capitalAmount:o,socialExpenses:x||0,deductibleExpenses:h||0,excessAmount:T||0},beppyo16:{...s.beppyo16,assets:y.length>0?y:s.beppyo16.assets,totalDepreciation:y.reduce((r,m)=>r+(m.currentDepreciation||0),0),totalAllowable:y.reduce((r,m)=>r+(m.allowableLimit||0),0)}}}},O={generateFinancialStatementCSV:e=>{const t=a=>"businessOverview"in a;let i="",l=0,d=0,p=0;t(e)?(i="",l=new Date().getFullYear()-1,d=e.businessOverview.sales,p=e.businessOverview.operatingExpenses+e.businessOverview.costOfSales):(i=e.companyName||"",l=e.fiscalYear,d=e.revenue,p=e.expenses);const n=[];n.push(["識別番号","会社名","年度","帳票区分","科目名","金額","貸借区分"]);const o=["",i,`${l}年度`];if(n.push([...o,"損益計算書","売上高",String(d),"貸方"]),t(e)){const a=e.businessOverview;n.push([...o,"損益計算書","売上原価",String(a.costOfSales),"借方"]),n.push([...o,"損益計算書","販売費及び一般管理費計",String(a.operatingExpenses),"借方"]),n.push([...o,"損益計算書","　役員報酬",String(a.directorsCompensation),"借方"]),n.push([...o,"損益計算書","　給料賃金",String(a.employeesSalary),"借方"]),n.push([...o,"損益計算書","　地代家賃",String(a.rent),"借方"]),n.push([...o,"損益計算書","　租税公課",String(a.taxesAndDues),"借方"]),n.push([...o,"損益計算書","　交際費",String(a.entertainmentExpenses),"借方"]),n.push([...o,"損益計算書","　減価償却費",String(a.depreciation),"借方"]),n.push([...o,"損益計算書","営業利益",String(a.operatingIncome),"貸方"]),n.push([...o,"損益計算書","経常利益",String(a.ordinaryIncome),"貸方"]),n.push([...o,"損益計算書","税引前当期純利益",String(a.netIncome),"貸方"])}else n.push([...o,"損益計算書","費用合計",String(p),"借方"]),e.expensesByCategory.forEach(a=>{n.push([...o,"損益計算書",`　${a.category}`,String(a.amount),"借方"])}),n.push([...o,"損益計算書","当期純利益",String(e.netIncome),"貸方"]);return n.map(a=>a.join(",")).join(`\r
`)},downloadCSV:(e,t)=>{const i=new Blob([new Uint8Array([239,187,191]),e],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");if(l.download!==void 0){const d=URL.createObjectURL(i);l.setAttribute("href",d),l.setAttribute("download",t),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}};export{w as C,O as a,s as i};
