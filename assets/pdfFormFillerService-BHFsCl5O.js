async function b(l,e,c){const o={success:!1,filledFields:[],skippedFields:[],errors:[],method:"AcroForm"};try{const n=l.getForm(),s=n.getFields();if(s.length===0)return o.errors.push("No AcroForm fields found in PDF"),o;console.log(`[AcroForm] Found ${s.length} fields in ${c}`);const t=s.map(i=>i.getName());console.log("[AcroForm] Available fields:",t);for(const i of s){const r=i.getName(),p=a(r,e,c);if(p==null){o.skippedFields.push(r);continue}try{const u=n.getTextField(r),f=typeof p=="number"?m(p):String(p);u.setText(f),u.enableReadOnly(),o.filledFields.push(r),console.log(`[AcroForm] ✓ Filled "${r}" = "${f}"`)}catch(u){o.errors.push(`Failed to fill "${r}": ${u.message}`)}}o.success=o.filledFields.length>0;try{n.flatten(),console.log("[AcroForm] Form flattened successfully")}catch(i){console.warn("[AcroForm] Could not flatten form:",i)}}catch(n){o.errors.push(`AcroForm processing failed: ${n.message}`)}return o}function a(l,e,c){const o=l.toLowerCase().replace(/[_\s]/g,"");if(c==="beppyo1"){const n={所得金額:e.beppyo4.taxableIncome,課税標準:e.beppyo1.taxableIncome,法人税額:e.beppyo1.corporateTaxAmount,控除税額:e.beppyo1.specialTaxCredit,中間納付:e.beppyo1.interimPayment,差引税額:e.beppyo1.corporateTaxAmount-e.beppyo1.specialTaxCredit-e.beppyo1.interimPayment};for(const[s,t]of Object.entries(n))if(o.includes(s.replace(/[_\s]/g,"")))return t}if(c==="beppyo4"){const n=e.beppyo4.additions.reduce((i,r)=>i+r.amount,0),s=e.beppyo4.subtractions.reduce((i,r)=>i+r.amount,0),t={当期利益:e.beppyo4.netIncomeFromPL,加算:n,減算:s,所得金額:e.beppyo4.taxableIncome};for(const[i,r]of Object.entries(t))if(o.includes(i.replace(/[_\s]/g,"")))return r}if(c==="beppyo5_1"){const n={期首残高:e.beppyo5.retainedEarningsBegin,当期変動:e.beppyo5.currentIncrease-e.beppyo5.currentDecrease,期末残高:e.beppyo5.retainedEarningsEnd,利益準備金:e.beppyo5.retainedEarningsEnd};for(const[s,t]of Object.entries(n))if(o.includes(s.replace(/[_\s]/g,"")))return t}if(c==="beppyo15"){const n={交際費:e.beppyo15.socialExpenses,接待飲食費:e.beppyo15.deductibleExpenses,損金算入限度額:e.beppyo15.deductionLimit,損金不算入額:e.beppyo15.excessAmount};for(const[s,t]of Object.entries(n))if(o.includes(s.replace(/[_\s]/g,"")))return t}if(c==="beppyo16"){const n={償却実施額:e.beppyo16.totalDepreciation,償却限度額:e.beppyo16.totalAllowable,償却超過額:e.beppyo16.excessAmount};for(const[s,t]of Object.entries(n))if(o.includes(s.replace(/[_\s]/g,"")))return t}return null}function m(l,e=!1){if(l===0)return"0";const o=Math.abs(l).toLocaleString("ja-JP",{maximumFractionDigits:0,useGrouping:!0});return l<0?e?`(${o})`:`-${o}`:o}function y(l){try{return l.getForm().getFields().length>0}catch{return!1}}export{b as fillAcroFormFields,m as formatTaxNumber,y as hasAcroFormFields};
