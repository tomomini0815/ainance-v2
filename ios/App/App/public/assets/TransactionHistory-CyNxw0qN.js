import{b as he,a as ue,d as be,r as i,n as pe,j as e,L as W,P as O,F,i as z,k as I,X as U,f as ge,o as fe,T as _,p as Z}from"./index-ANsWalRW.js";import B from"./TransactionForm-BhvcRTBO.js";import{A as ee}from"./arrow-left-CzwRZ0lz.js";import{J as te,F as je}from"./japanese-yen-CIZa0TSV.js";import"./clock-D5R1C44l.js";import"./calendar-BT1WDC-V.js";import"./star-CFjU12yw.js";import"./zap-6v6_cTkh.js";const Fe=()=>{const{currentBusinessType:d}=he(),{isAuthenticated:Ne,user:A,loading:ve}=ue(),{transactions:h,loading:se,createTransaction:re,updateTransaction:ae,deleteTransaction:E,fetchTransactions:g}=be(A==null?void 0:A.id,d==null?void 0:d.business_type),[k,R]=i.useState(""),[q,b]=i.useState(!1),[j,N]=i.useState(null),[u,$]=i.useState([]),[P,ne]=i.useState(!1),[v,H]=i.useState(""),[c,D]=i.useState({start:"",end:""}),[o,J]=i.useState({min:"",max:""}),[V,ie]=i.useState("date"),[M,le]=i.useState("desc"),[m,L]=i.useState(1),T=10;i.useEffect(()=>{d!=null&&d.id&&g()},[d,g]);const X=pe();i.useEffect(()=>{const s=new URLSearchParams(X.search).get("search");s&&R(s)},[X.search]),i.useEffect(()=>{const t=async()=>{d!=null&&d.id&&(await new Promise(s=>setTimeout(s,100)),g())};return window.addEventListener("transactionRecorded",t),()=>{window.removeEventListener("transactionRecorded",t)}},[d,g]),i.useEffect(()=>{const t=async()=>{console.log("transactionApprovedイベントを受信"),d!=null&&d.id&&(await new Promise(s=>setTimeout(s,100)),g())};return window.addEventListener("transactionApproved",t),()=>{window.removeEventListener("transactionApproved",t)}},[d,g]);const de=i.useMemo(()=>{const t=h.map(s=>s.category);return Array.from(new Set(t)).filter(Boolean)},[h]),C=i.useMemo(()=>{let t=[...h];return k&&(t=t.filter(s=>s.item&&s.item.toLowerCase().includes(k.toLowerCase())||s.description&&s.description.toLowerCase().includes(k.toLowerCase())||s.category&&s.category.toLowerCase().includes(k.toLowerCase()))),v&&(t=t.filter(s=>s.category===v)),c.start&&(t=t.filter(s=>s.date>=c.start)),c.end&&(t=t.filter(s=>s.date<=c.end)),o.min&&(t=t.filter(s=>s.amount>=Number(o.min))),o.max&&(t=t.filter(s=>s.amount<=Number(o.max))),t.sort((s,n)=>{let x,f;switch(V){case"amount":x=s.amount,f=n.amount;break;case"item":x=s.item.toLowerCase(),f=n.item.toLowerCase();break;default:x=new Date(s.date),f=new Date(n.date)}return M==="asc"?x>f?1:-1:x<f?1:-1}),t},[h,k,v,c,o,V,M]),S=Math.ceil(C.length/T),p=i.useMemo(()=>{const t=(m-1)*T,s=t+T;return C.slice(t,s)},[C,m]),w=i.useMemo(()=>{console.log("取引履歴 - 取引データ:",h);const t=r=>{if(typeof r=="number")return r;if(typeof r=="string"){const a=parseFloat(r);return isNaN(a)?0:a}if(typeof r=="object"&&r!==null){const a=r.value||r.amount||r.number||0;if(typeof a=="number")return a;if(typeof a=="string"){const l=parseFloat(a);return isNaN(l)?0:l}return 0}return 0},s=h.filter(r=>{if(r.type==="income")return!0;if(r.type==="expense")return!1;const a=t(r.amount),l=!isNaN(a)&&isFinite(a)&&a>0;return console.log(`取引履歴 - 取引ID ${r.id}: type=${r.type}, 元のamount=${JSON.stringify(r.amount)}, 数値化後=${a}, 収入判定=${l}`),l}),n=h.filter(r=>{if(r.type==="expense")return!0;if(r.type==="income")return!1;const a=t(r.amount),l=!isNaN(a)&&isFinite(a)&&a<0;return console.log(`取引履歴 - 取引ID ${r.id}: type=${r.type}, 元のamount=${JSON.stringify(r.amount)}, 数値化後=${a}, 支出判定=${l}`),l}),x=s.reduce((r,a)=>{const l=t(a.amount),y=!isNaN(l)&&isFinite(l)?Math.abs(l):0;return console.log(`取引履歴 - 収入計算: ${r} + ${y} = ${r+y}`),r+y},0),f=n.reduce((r,a)=>{const l=t(a.amount),y=!isNaN(l)&&isFinite(l)?Math.abs(l):0;return console.log(`取引履歴 - 支出計算: ${r} + ${y} = ${r+y}`),r+y},0),Q={total:h.length,income:x,expense:f,balance:x-f};return console.log("取引履歴 - 統計情報計算結果:",Q),console.log("取引履歴 - 収入取引:",s),console.log("取引履歴 - 支出取引:",n),Q},[h]),ce=()=>{u.length===p.length?$([]):$(p.map(t=>t.id))},Y=t=>{u.includes(t)?$(u.filter(s=>s!==t)):$([...u,t])},oe=async()=>{if(window.confirm(`${u.length}件の取引を削除してもよろしいですか？`))try{for(const t of u)await E(t);$([])}catch(t){console.error("一括削除に失敗:",t)}},G=async t=>{try{const s=localStorage.getItem("user");if(s)try{const n=JSON.parse(s);t.creator=n.id}catch(n){console.error("ユーザー情報の解析に失敗しました:",n)}if(!t.type){const n=typeof t.amount=="string"?parseFloat(t.amount):t.amount;t.type=n>0?"income":"expense",console.log("typeプロパティを自動設定:",t.type)}await re(t),await g(),window.dispatchEvent(new CustomEvent("transactionRecorded")),b(!1)}catch(s){console.error("取引の作成に失敗:",s)}},me=async t=>{if(j)try{const s={...t,creator:j.creator},n=await ae(j.id,s);if(n.error)throw n.error;await new Promise(x=>setTimeout(x,100)),await g(),await new Promise(x=>setTimeout(x,100)),window.dispatchEvent(new CustomEvent("transactionRecorded")),N(null),alert("取引が正常に更新されました")}catch(s){console.error("取引の更新に失敗:",s),alert(`取引の更新に失敗しました: ${s.message||"不明なエラーが発生しました"}`)}},xe=()=>{H(""),D({start:"",end:""}),J({min:"",max:""}),R("")},K=i.useMemo(()=>{let t=0;return v&&t++,(c.start||c.end)&&t++,(o.min||o.max)&&t++,t},[v,c,o]);return se?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-text-muted",children:"データを読み込んでいます..."})]})}):!h||h.length===0?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(W,{to:"/dashboard",className:"mr-4 p-2 rounded-lg hover:bg-surface-highlight transition-colors",children:e.jsx(ee,{className:"w-6 h-6 text-text-muted hover:text-text-main"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-text-main",children:"取引履歴"}),e.jsx("p",{className:"text-text-muted mt-1",children:"すべての取引履歴を確認・管理できます"})]})]})}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:()=>b(!0),className:"btn-primary flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"新規取引"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-6",children:[e.jsx("div",{className:"bg-surface rounded-xl shadow-sm p-4 border border-border hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"総取引数"}),e.jsx("div",{className:"text-xl font-bold mt-1 text-primary",children:"0"})]}),e.jsx("div",{className:"rounded-lg bg-primary/5 p-2",children:e.jsx(F,{className:"w-5 h-5 text-primary"})})]})}),e.jsx("div",{className:"bg-surface rounded-xl shadow-sm p-4 border border-border hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"収入"}),e.jsx("div",{className:"text-xl font-bold mt-1 text-green-500",children:"¥0"})]}),e.jsx("div",{className:"rounded-lg bg-green-500/5 p-2",children:e.jsx(z,{className:"w-5 h-5 text-green-500"})})]})}),e.jsx("div",{className:"bg-surface rounded-xl shadow-sm p-4 border border-border hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"支出"}),e.jsx("div",{className:"text-xl font-bold mt-1 text-red-500",children:"¥0"})]}),e.jsx("div",{className:"rounded-lg bg-red-500/5 p-2",children:e.jsx(I,{className:"w-5 h-5 text-red-500"})})]})}),e.jsx("div",{className:"rounded-xl shadow-sm p-4 border border-green-500/20 bg-green-500/5 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"収支"}),e.jsx("div",{className:"text-xl font-bold mt-1 text-green-500",children:"¥0"})]}),e.jsx("div",{className:"rounded-lg bg-green-500/5 p-2",children:e.jsx(te,{className:"w-5 h-5 text-green-500"})})]})})]}),e.jsxs("div",{className:"bg-surface rounded-xl shadow-sm border border-border p-8 text-center",children:[e.jsx(F,{className:"w-16 h-16 text-text-muted mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-medium text-text-main mb-2",children:"取引が見つかりません"}),e.jsx("p",{className:"text-text-muted mb-6",children:"まだ取引が登録されていないか、条件に一致する取引がありません"}),e.jsxs("button",{onClick:()=>b(!0),className:"btn-primary flex items-center mx-auto",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),"最初の取引を追加"]})]})]}),q&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-surface rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-xl border border-border",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-text-main",children:"最初の取引を追加"}),e.jsx("button",{onClick:()=>{b(!1),N(null)},className:"p-2 rounded-lg hover:bg-surface-highlight transition-colors",children:e.jsx(U,{className:"w-5 h-5 text-text-muted"})})]}),e.jsx(B,{transaction:j,onSubmit:G,onCancel:()=>{b(!1),N(null)}})]})})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(W,{to:"/dashboard",className:"mr-4 p-2 rounded-lg hover:bg-surface-highlight transition-colors",children:e.jsx(ee,{className:"w-6 h-6 text-text-muted hover:text-text-main"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-text-main",children:"取引履歴"}),e.jsx("p",{className:"text-text-muted mt-1",children:"すべての取引履歴を確認・管理できます"})]})]})}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:()=>b(!0),className:"btn-primary flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"新規取引"]})})]}),e.jsx("div",{className:"bg-surface rounded-xl shadow-sm p-4 border border-border hover:shadow-md transition-shadow mb-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"総取引数"}),e.jsx("div",{className:"rounded-lg bg-primary/5 p-2",children:e.jsx(F,{className:"w-5 h-5 text-primary"})})]}),e.jsx("div",{className:"text-xl font-bold text-primary mt-1",children:w.total})]}),e.jsxs("div",{className:"border border-border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"収入"}),e.jsx("div",{className:"rounded-lg bg-green-500/5 p-2",children:e.jsx(z,{className:"w-5 h-5 text-green-500"})})]}),e.jsxs("div",{className:"text-xl font-bold text-green-500 mt-1",children:["¥",w.income.toLocaleString()]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"支出"}),e.jsx("div",{className:"rounded-lg bg-red-500/5 p-2",children:e.jsx(I,{className:"w-5 h-5 text-red-500"})})]}),e.jsxs("div",{className:"text-xl font-bold text-red-500 mt-1",children:["¥",w.expense.toLocaleString()]})]}),e.jsxs("div",{className:"border border-border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-medium text-text-muted",children:"収支"}),e.jsx("div",{className:`rounded-lg p-2 ${w.balance>=0?"bg-green-500/5":"bg-red-500/5"}`,children:e.jsx(te,{className:`w-5 h-5 ${w.balance>=0?"text-green-500":"text-red-500"}`})})]}),e.jsxs("div",{className:`text-xl font-bold mt-1 ${w.balance>=0?"text-green-500":"text-red-500"}`,children:["¥",w.balance.toLocaleString()]})]})]})}),e.jsxs("div",{className:"bg-surface rounded-xl shadow-sm border border-border mb-6 overflow-hidden",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-muted w-5 h-5"}),e.jsx("input",{type:"text",value:k,onChange:t=>R(t.target.value),placeholder:"取引内容、カテゴリなどで検索...",className:"w-full pl-10 pr-4 py-2.5 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background focus:bg-surface transition-colors text-text-main placeholder-text-muted"})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>ne(!P),className:`px-4 py-2.5 text-sm rounded-lg transition-colors flex items-center space-x-2 ${P?"bg-primary/10 text-primary":"bg-surface-highlight text-text-muted hover:bg-border"}`,children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{children:"フィルタ"}),K>0&&e.jsx("span",{className:"bg-primary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:K}),e.jsx(fe,{className:`w-4 h-4 transition-transform ${P?"rotate-180":""}`})]}),(v||c.start||c.end||o.min||o.max)&&e.jsxs("button",{onClick:xe,className:"px-4 py-2.5 text-sm bg-surface-highlight text-text-muted rounded-lg hover:bg-border transition-colors flex items-center",children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),"クリア"]})]})]})}),P&&e.jsx("div",{className:"px-4 pb-4 border-t border-border",children:e.jsx("div",{className:"pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"カテゴリ"}),e.jsxs("select",{value:v,onChange:t=>H(t.target.value),className:"input-base",children:[e.jsx("option",{value:"",children:"すべて"}),de.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"開始日"}),e.jsx("input",{type:"date",value:c.start,onChange:t=>D({...c,start:t.target.value}),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"終了日"}),e.jsx("input",{type:"date",value:c.end,onChange:t=>D({...c,end:t.target.value}),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"最小金額"}),e.jsx("input",{type:"number",value:o.min,onChange:t=>J({...o,min:t.target.value}),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"最大金額"}),e.jsx("input",{type:"number",value:o.max,onChange:t=>J({...o,max:t.target.value}),className:"input-base"})]})]})})})]}),e.jsx("div",{className:"bg-surface rounded-xl shadow-sm border border-border mb-6 overflow-hidden",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"text-sm text-text-muted mr-2",children:"ソート:"}),e.jsxs("select",{value:V,onChange:t=>ie(t.target.value),className:"px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent bg-background focus:bg-surface transition-colors text-text-main",children:[e.jsx("option",{value:"date",children:"日付"}),e.jsx("option",{value:"amount",children:"金額"}),e.jsx("option",{value:"item",children:"項目"})]})]}),e.jsx("button",{onClick:()=>le(M==="asc"?"desc":"asc"),className:"px-3 py-2 text-sm bg-surface-highlight text-text-muted rounded-lg hover:bg-border transition-colors flex items-center",children:M==="asc"?"昇順":"降順"})]}),u.length>0&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-text-muted",children:[u.length,"件選択中"]}),e.jsxs("button",{onClick:oe,className:"px-3 py-2 text-sm bg-red-500/10 text-red-600 rounded-lg hover:bg-red-500/20 transition-colors flex items-center",children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),"削除"]})]})]})})}),e.jsxs("div",{className:"bg-surface rounded-xl shadow-sm border border-border overflow-hidden",children:[e.jsx("div",{className:"block md:hidden divide-y divide-border",children:p.length>0?p.map(t=>e.jsxs("div",{className:"p-4 hover:bg-surface-highlight transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:u.includes(t.id),onChange:()=>Y(t.id),className:"rounded border-border text-primary focus:ring-primary h-4 w-4 bg-background"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-main",children:t.item}),e.jsx("div",{className:"text-xs text-text-muted",children:new Date(t.date).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"})})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`font-bold ${t.type==="income"?"text-green-500":"text-red-500"}`,children:[t.type==="expense"?"-":"","¥",t.amount.toLocaleString()]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-5 font-medium rounded-full ${t.type==="income"?"bg-green-500/10 text-green-600":"bg-red-500/10 text-red-600"}`,children:t.category}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>{N(t),b(!0)},className:"p-1.5 rounded-lg transition-colors text-primary hover:text-primary/80 hover:bg-primary/10",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>E(t.id),className:"p-1.5 rounded-lg transition-colors text-red-500 hover:text-red-600 hover:bg-red-500/10",children:e.jsx(_,{className:"w-4 h-4"})})]})]})]},t.id)):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(F,{className:"w-12 h-12 text-text-muted mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-main mb-1",children:"取引が見つかりません"}),e.jsx("p",{className:"text-text-muted",children:"条件に一致する取引がありません"})]})}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surface-highlight",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider w-12",children:e.jsx("input",{type:"checkbox",checked:u.length===p.length&&p.length>0,onChange:ce,className:"rounded border-border text-primary focus:ring-primary h-4 w-4 bg-background"})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"項目"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-text-muted uppercase tracking-wider",children:"金額"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider hidden sm:table-cell",children:"日付"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"カテゴリ"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-text-muted uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-surface divide-y divide-border",children:p.length>0?p.map(t=>(t.approval_status,e.jsxs("tr",{className:"hover:bg-surface-highlight transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:u.includes(t.id),onChange:()=>Y(t.id),className:"rounded border-border text-primary focus:ring-primary h-4 w-4 bg-background"})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-text-main",children:t.item}),e.jsx("div",{className:"text-sm text-text-muted sm:hidden",children:new Date(t.date).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"})})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end",children:[t.type==="income"?e.jsx(z,{className:"w-4 h-4 text-green-500 mr-1"}):e.jsx(I,{className:"w-4 h-4 text-red-500 mr-1"}),e.jsxs("span",{className:t.type==="income"?"text-green-500":"text-red-500",children:[t.type==="expense"?"-":"",t.amount.toLocaleString()]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-text-muted hidden sm:table-cell",children:new Date(t.date).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-5 font-medium rounded-full ${t.type==="income"?"bg-green-500/10 text-green-600":"bg-red-500/10 text-red-600"}`,children:t.category})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{onClick:()=>{N(t),b(!0)},className:"p-2 rounded-lg transition-colors text-primary hover:text-primary/80 hover:bg-primary/10",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>E(t.id),className:"p-2 rounded-lg transition-colors text-red-500 hover:text-red-600 hover:bg-red-500/10",children:e.jsx(_,{className:"w-4 h-4"})})]})})]},t.id))):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(F,{className:"w-12 h-12 text-text-muted mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-main mb-1",children:"取引が見つかりません"}),e.jsx("p",{className:"text-text-muted",children:"条件に一致する取引がありません"})]})})})})]})}),p.length>0&&e.jsxs("div",{className:"bg-surface px-6 py-4 flex flex-col sm:flex-row items-center justify-between gap-4 border-t border-border",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>L(Math.max(1,m-1)),disabled:m===1,className:"relative inline-flex items-center px-4 py-2 border border-border text-sm font-medium rounded-md text-text-muted bg-surface hover:bg-surface-highlight disabled:opacity-50",children:"前へ"}),e.jsx("button",{onClick:()=>L(Math.min(S,m+1)),disabled:m===S,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-border text-sm font-medium rounded-md text-text-muted bg-surface hover:bg-surface-highlight disabled:opacity-50",children:"次へ"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsx("span",{className:"font-medium",children:Math.min((m-1)*T+1,C.length)})," 件から ",e.jsx("span",{className:"font-medium",children:Math.min(m*T,C.length)})," 件までを表示中（全 ",e.jsx("span",{className:"font-medium",children:C.length})," 件）"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>L(Math.max(1,m-1)),disabled:m===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-border bg-surface text-sm font-medium text-text-muted hover:bg-surface-highlight disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"前へ"}),"<"]}),[...Array(Math.min(5,S))].map((t,s)=>{const n=Math.max(1,Math.min(m-2,S-4))+s;return e.jsx("button",{onClick:()=>L(n),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${m===n?"z-10 bg-primary/10 border-primary text-primary":"bg-surface border-border text-text-muted hover:bg-surface-highlight"}`,children:n},n)}),e.jsxs("button",{onClick:()=>L(Math.min(S,m+1)),disabled:m===S,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-border bg-surface text-sm font-medium text-text-muted hover:bg-surface-highlight disabled:opacity-50",children:[e.jsx("span",{className:"sr-only",children:"次へ"}),">"]})]})})]})]})]})]}),q&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-surface rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-xl border border-border",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-text-main",children:j?"取引を編集":"新規取引作成"}),e.jsx("button",{onClick:()=>{b(!1),N(null)},className:"p-2 rounded-lg hover:bg-surface-highlight transition-colors",children:e.jsx(U,{className:"w-5 h-5 text-text-muted"})})]}),e.jsx(B,{transaction:j,onSubmit:j?me:G,onCancel:()=>{b(!1),N(null)}})]})})})]})};export{Fe as default};
