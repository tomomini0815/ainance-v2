import{e as y,a as v,f as w,r as g,j as e,L as k,d as p,P as E,F as f}from"./index-DC9j6qQS.js";const F=({transactions:o,onOpenCreateModal:h,showCreateButton:b=!0})=>{const{currentBusinessType:a}=y(),{isAuthenticated:L,user:m,loading:$}=v(),{transactions:j,loading:N,fetchTransactions:c}=w(m==null?void 0:m.id,a==null?void 0:a.business_type);g.useEffect(()=>{a!=null&&a.id&&c()},[a,c]),g.useEffect(()=>{const t=()=>{a!=null&&a.id&&c()},s=()=>{a!=null&&a.id&&c()};return window.addEventListener("transactionRecorded",t),window.addEventListener("transactionApproved",s),()=>{window.removeEventListener("transactionRecorded",t),window.removeEventListener("transactionApproved",s)}},[a,c]);const u=t=>{const s="inline-flex items-center justify-center w-6 h-6 rounded-full mr-2 text-xs font-bold";switch(t){case"交通費":case"旅費交通費":return e.jsx("span",{className:`${s} bg-blue-500/20 text-blue-400`,children:"交"});case"食費":case"接待交際費":return e.jsx("span",{className:`${s} bg-emerald-500/20 text-emerald-400`,children:"食"});case"消耗品費":return e.jsx("span",{className:`${s} bg-purple-500/20 text-purple-400`,children:"消"});case"通信費":return e.jsx("span",{className:`${s} bg-amber-500/20 text-amber-400`,children:"通"});case"光熱費":case"水道光熱費":return e.jsx("span",{className:`${s} bg-rose-500/20 text-rose-400`,children:"光"});case"地代家賃":return e.jsx("span",{className:`${s} bg-indigo-500/20 text-indigo-400`,children:"家"});default:return e.jsx("span",{className:`${s} bg-slate-500/20 text-text-muted`,children:"他"})}},x=[...o.length>0?o:j].sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime());return N?e.jsxs("div",{className:"bg-white dark:bg-surface rounded-2xl p-6 border border-border shadow-sm transition-all duration-200 hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main",children:"最近の履歴"}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("div",{className:"h-4 w-20 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})})]}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-100 dark:bg-gray-800 rounded-lg animate-pulse",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-4 w-24 bg-gray-200 dark:bg-gray-700 rounded mb-2"}),e.jsx("div",{className:"h-3 w-16 bg-gray-200 dark:bg-gray-700 rounded"})]})]}),e.jsx("div",{className:"h-4 w-16 bg-gray-200 dark:bg-gray-700 rounded"})]},s))})]}):e.jsxs("div",{className:"bg-white dark:bg-surface rounded-2xl p-6 border border-border shadow-sm transition-all duration-200 hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main",children:"取引履歴"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(k,{to:"/transaction-history",className:"flex items-center text-sm text-primary hover:text-primary/80 font-medium transition-colors",children:["詳細一覧",e.jsx(p,{className:"w-4 h-4 ml-1"})]}),b&&h&&e.jsxs("button",{onClick:h,className:"flex items-center px-3 py-1.5 bg-primary text-white text-sm rounded-lg hover:bg-primary/90 transition-colors shadow-lg shadow-primary/20",children:[e.jsx(E,{className:"w-4 h-4 mr-1"}),"新規作成"]})]})]}),e.jsx("div",{className:"block md:hidden space-y-3",children:x.length>0?x.slice(0,10).map(t=>{let s=t.amount;typeof t.amount=="string"?s=parseFloat(t.amount):typeof t.amount=="number"?s=t.amount:s=0;const l=!isNaN(s)&&isFinite(s),d=t.type==="income",n=t.type==="expense",r=d?!0:n?!1:l&&s>0,i=n?!0:d?!1:l&&s<0;return e.jsxs("div",{className:"bg-surface-highlight rounded-xl p-4 border border-border hover:border-primary/50 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start flex-1",children:[u(t.category),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-text-main text-sm mb-1",children:t.item}),e.jsx("div",{className:"text-xs text-text-muted",children:new Date(t.date).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"})})]})]}),e.jsx("div",{className:"text-right ml-3",children:e.jsxs("div",{className:`font-bold text-base ${r?"text-green-500":i?"text-red-500":"text-text-muted"}`,children:[r?"+":i?"-":"","¥",l?Math.abs(s).toLocaleString():"N/A"]})})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:`inline-flex px-2.5 py-1 text-xs font-medium rounded-full ${r?"bg-green-500/10 text-green-600":i?"bg-red-500/10 text-red-600":"bg-slate-500/10 text-text-muted"}`,children:t.category})})]},t.id)}):e.jsx("div",{className:"py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-surface-highlight flex items-center justify-center mb-3",children:e.jsx(f,{className:"w-6 h-6 text-slate-600"})}),e.jsx("p",{className:"text-text-muted text-sm",children:"取引がありません"})]})})}),e.jsx("div",{className:"hidden md:block overflow-x-auto max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"項目"}),e.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"金額"}),e.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"日付"}),e.jsx("th",{className:"text-center py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"カテゴリ"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:x.length>0?x.slice(0,10).map(t=>{let s=t.amount;typeof t.amount=="string"?s=parseFloat(t.amount):typeof t.amount=="number"?s=t.amount:s=0,t.approval_status;const l=!isNaN(s)&&isFinite(s),d=t.type==="income",n=t.type==="expense",r=d?!0:n?!1:l&&s>0,i=n?!0:d?!1:l&&s<0;return console.log("Transaction processing:",{id:t.id,amount:s,type:t.type,isExplicitIncome:d,isExplicitExpense:n,isFinalIncome:r,isFinalExpense:i}),e.jsxs("tr",{className:"hover:bg-white/5 transition-colors group",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center",children:[u(t.category),e.jsx("div",{children:e.jsx("div",{className:"font-medium text-text-main text-sm group-hover:text-white transition-colors",children:t.item})})]})}),e.jsx("td",{className:"py-4 px-4 text-right font-medium",children:e.jsxs("span",{className:`${r?"text-green-500":i?"text-red-500":"text-text-muted"}`,children:[r?"+":i?"-":"","¥",l?Math.abs(s).toLocaleString():"N/A"]})}),e.jsx("td",{className:"py-4 px-4 text-sm text-text-muted",children:new Date(t.date).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric"})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("span",{className:`inline-flex px-2.5 py-1 text-xs font-medium rounded-full ${r?"bg-green-500/10 text-green-600":i?"bg-red-500/10 text-red-600":"bg-slate-500/10 text-text-muted"}`,children:t.category})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-surface-highlight flex items-center justify-center mb-3",children:e.jsx(f,{className:"w-6 h-6 text-slate-600"})}),e.jsx("p",{className:"text-text-muted text-sm",children:"取引がありません"})]})})})})]})}),e.jsxs("div",{className:"flex items-center justify-center mt-6 space-x-2",children:[e.jsx("button",{className:"w-8 h-8 rounded-lg bg-primary text-white flex items-center justify-center text-sm font-medium shadow-lg shadow-primary/25 hover:bg-primary/90 transition-all",children:"1"}),e.jsx("button",{className:"w-8 h-8 rounded-lg bg-surface text-text-muted flex items-center justify-center text-sm font-medium hover:bg-surface-highlight hover:text-text-main transition-all border border-border",children:"2"}),e.jsx("button",{className:"p-2 text-text-muted hover:text-text-secondary transition-colors",children:e.jsx(p,{className:"w-4 h-4"})})]})]})};export{F as default};
