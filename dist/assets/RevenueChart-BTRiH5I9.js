import{r as y,j as e}from"./index-DnAF104x.js";import{L as S,C as R,a as q,b as B,P as D,c as E,p as Y,d as P,e as W,i as z}from"./index-BNYGJ7Qt.js";R.register(q,B,D,E,Y,P,W,z);const Q=({transactions:h})=>{const[o,u]=y.useState("monthly"),v=y.useMemo(()=>{const t={};let s=[];const c=new Date,x=c.getFullYear();if(o==="monthly"){const r=c.getMonth()>=11?x:x-1,n=c.getMonth()>=11?0:c.getMonth()+1;for(let a=0;a<12;a++){const l=new Date(r,n+a,1),i=`${l.getFullYear()}年${l.getMonth()+1}月`;s.push(i),t[i]={revenue:0,expense:0}}}else if(o==="quarterly"){const r=Math.floor(c.getMonth()/3)+1;for(let n=3;n>=0;n--){let a=x,l=r-n;l<=0&&(a-=1,l+=4);const i=`${a}年 Q${l}`;s.push(i),t[i]={revenue:0,expense:0}}}else if(o==="yearly")for(let r=4;r>=0;r--){const a=`${x-r}年`;s.push(a),t[a]={revenue:0,expense:0}}h.forEach(r=>{const n=typeof r.amount=="string"?parseFloat(r.amount):r.amount,a=new Date(r.date),l=a.getFullYear(),i=a.getMonth()+1;let d="";if(o==="monthly")d=`${l}年${i}月`;else if(o==="quarterly"){const w=Math.ceil(i/3);d=`${l}年 Q${w}`}else o==="yearly"&&(d=`${l}年`);t[d]&&(r.type==="income"?t[d].revenue+=Math.abs(n):r.type==="expense"?t[d].expense+=Math.abs(n):n>0?t[d].revenue+=n:n<0&&(t[d].expense+=Math.abs(n)))});const M=s.map(r=>t[r].revenue),L=s.map(r=>t[r].expense),$=s.map(r=>t[r].revenue-t[r].expense);return{labels:s,revenue:M,expense:L,profit:$}},[h,o]),{labels:j,revenue:f,expense:b,profit:k}=v,m=f.reduce((t,s)=>t+s,0),p=b.reduce((t,s)=>t+s,0),g=m-p,C={labels:j,datasets:[{label:"収益",data:f,borderColor:"#06b6d4",backgroundColor:"rgba(6, 182, 212, 0.1)",tension:.4,pointBackgroundColor:"#06b6d4",pointBorderColor:"#06b6d4",pointRadius:0,pointHoverRadius:6,fill:!0},{label:"支出",data:b,borderColor:"#f472b6",backgroundColor:"rgba(244, 114, 182, 0.1)",tension:.4,pointBackgroundColor:"#f472b6",pointBorderColor:"#f472b6",pointRadius:0,pointHoverRadius:6,fill:!0},{label:"利益",data:k,borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4,pointBackgroundColor:"#10b981",pointBorderColor:"#10b981",pointRadius:0,pointHoverRadius:6,fill:!0,borderDash:[5,5]}]},N={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,boxWidth:9,boxHeight:9,padding:20,color:"#94a3b8",font:{size:12,family:"Inter"}}},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(15, 23, 42, 0.9)",titleColor:"#f8fafc",bodyColor:"#e2e8f0",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,padding:10,callbacks:{label:function(t){let s=t.dataset.label||"";return s&&(s+=": "),t.parsed.y!==null&&(s+=t.parsed.y.toLocaleString()+"円"),s}}}},scales:{x:{display:!0,grid:{display:!1,color:"rgba(255, 255, 255, 0.05)"},ticks:{color:"#64748b",font:{size:11}}},y:{display:!0,grid:{color:"rgba(255, 255, 255, 0.05)"},ticks:{color:"#64748b",font:{size:11},callback:function(t){return t>=1e6?t/1e6+"M":t>=1e3?t/1e3+"k":t}}}},interaction:{mode:"nearest",axis:"x",intersect:!1}};return e.jsxs("div",{className:"bg-white dark:bg-surface rounded-2xl p-6 border border-border shadow-sm transition-all duration-200 hover:shadow-md h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main",children:"収益・支出・利益推移"}),e.jsxs("div",{className:"flex space-x-1 bg-surface-highlight/50 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>u("monthly"),className:`text-xs px-3 py-1.5 rounded-md font-medium transition-colors ${o==="monthly"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-main"}`,children:"月次"}),e.jsx("button",{onClick:()=>u("quarterly"),className:`text-xs px-3 py-1.5 rounded-md font-medium transition-colors ${o==="quarterly"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-main"}`,children:"四半期"}),e.jsx("button",{onClick:()=>u("yearly"),className:`text-xs px-3 py-1.5 rounded-md font-medium transition-colors ${o==="yearly"?"bg-primary/20 text-primary":"text-text-muted hover:text-text-main"}`,children:"年次"})]})]}),e.jsx("div",{className:"chart-container h-72 w-full flex-shrink-0",children:e.jsx(S,{data:C,options:N})}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-4 flex-1 min-h-0",children:[e.jsxs("div",{className:"card-metric border-l-[#06b6d4] bg-surface p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 text-[#06b6d4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),e.jsxs("p",{className:"text-xs text-text-muted font-medium",children:["総収益 (",o==="monthly"||o==="quarterly"?"過去1年":"過去5年",")"]})]}),e.jsxs("p",{className:"text-lg font-bold text-text-main truncate",title:`¥${m.toLocaleString()}`,children:["¥",m.toLocaleString()]})]}),e.jsxs("div",{className:"card-metric border-l-[#f472b6] bg-surface p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 text-[#f472b6]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})}),e.jsxs("p",{className:"text-xs text-text-muted font-medium",children:["総支出 (",o==="monthly"||o==="quarterly"?"過去1年":"過去5年",")"]})]}),e.jsxs("p",{className:"text-lg font-bold text-text-main truncate",title:`¥${p.toLocaleString()}`,children:["¥",p.toLocaleString()]})]}),e.jsxs("div",{className:"card-metric border-l-[#10b981] bg-surface p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 text-[#10b981]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("p",{className:"text-xs text-text-muted font-medium",children:["純利益 (",o==="monthly"||o==="quarterly"?"過去1年":"過去5年",")"]})]}),e.jsxs("p",{className:"text-lg font-bold text-text-main truncate",title:`¥${g.toLocaleString()}`,children:["¥",g.toLocaleString()]})]})]})]})};export{Q as default};
