import{r as d,j as e,q as N,P as f,x as C}from"./index-Dp8kLXFF.js";import{d as S,f as l}from"./CorporateTaxService-8ijqz51P.js";import{C as k}from"./circle-question-mark-D3kTiSec.js";import{C as v}from"./calculator-CPGCmKU4.js";const L=({onCalculate:g,initialAssets:w=[]})=>{const[r,h]=d.useState(w),[c,x]=d.useState(!1),[p,m]=d.useState(!1),M=[{name:"定額法",desc:"取得価額に一定の償却率を乗じて、毎年一定額を償却する方法です。"},{name:"定率法",desc:"未償却残高に一定の償却率を乗じて、当初ほど多く、年々少なく償却する方法です。"},{name:"一括償却",desc:"20万円未満の資産を、耐用年数に関わらず3年間で均等に償却（各年1/3）する方法です。"},{name:"生産高比例法",desc:"自動車や鉱業用資産など、利用実績（走行距離等）に比例して償却する方法です。"},{name:"リース期間定額法",desc:"所有権移転外ファイナンス・リース資産を、リース期間を耐用年数として償却する方法です。"},{name:"少額特例",desc:"中小企業の特例として、30万円未満の資産を取得時に全額経費（即時償却）できる制度です。"}],[s,a]=d.useState(()=>{const t=new Date,i=t.getFullYear(),n=t.getMonth()+1;let b=t.toISOString().slice(0,7);return n<=3&&(b=`${i-1}-12`),{name:"",quantity:1,unit:"台",acquisitionDate:b,acquisitionCost:0,depreciationMethod:"straightLine",usefulLife:5,businessRatio:100,currentYearMonths:12}}),o=r.map(t=>S(t)),u=o.reduce((t,i)=>t+i.currentDepreciation,0);d.useEffect(()=>{g(u,r)},[u,r]);const y=()=>{if(!s.name||s.acquisitionCost<=0)return;const t={...s,id:Math.random().toString(36).substr(2,9)};h([...r,t]),a(i=>({...i,name:"",acquisitionCost:0})),x(!1)},j=t=>{h(r.filter(i=>i.id!==t))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 relative",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main",children:"減価償却費の計算"}),e.jsxs("div",{className:"group relative",onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),onClick:()=>m(!p),children:[e.jsx(k,{className:"w-5 h-5 text-text-muted cursor-help hover:text-primary transition-colors"}),p&&e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-72 sm:w-80 bg-surface border border-border rounded-xl shadow-2xl p-4 z-50 animate-in fade-in slide-in-from-top-1",children:[e.jsxs("h4",{className:"font-bold text-text-main mb-3 pb-2 border-b border-border text-sm flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-primary"}),"償却方法の解説"]}),e.jsx("div",{className:"space-y-3",children:M.map((t,i)=>e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-bold text-primary block mb-0.5",children:["【",t.name,"】"]}),e.jsx("p",{className:"text-xs text-text-muted leading-relaxed",children:t.desc})]},i))}),e.jsx("p",{className:"mt-3 pt-3 border-t border-border text-[10px] text-text-muted text-center sm:hidden",children:"タップで閉じます"})]})]})]}),e.jsxs("div",{className:"bg-primary/10 px-4 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm text-primary font-medium mr-2",children:"減価償却費合計"}),e.jsx("span",{className:"text-xl font-bold text-primary",children:l(u)})]})]}),e.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-xl",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-surface-highlight text-text-muted font-medium border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 min-w-[150px]",children:"資産名称"}),e.jsx("th",{className:"p-3 min-w-[100px]",children:"面積/数量"}),e.jsx("th",{className:"p-3 min-w-[120px]",children:"取得年月"}),e.jsx("th",{className:"p-3 min-w-[120px]",children:"取得価額"}),e.jsx("th",{className:"p-3 min-w-[100px]",children:"償却方法"}),e.jsx("th",{className:"p-3 min-w-[80px]",children:"耐用年数"}),e.jsx("th",{className:"p-3 min-w-[80px]",children:"償却率"}),e.jsx("th",{className:"p-3 min-w-[80px]",children:"使用月数"}),e.jsxs("th",{className:"p-3 min-w-[120px] bg-primary/5",children:["本年分普通",e.jsx("br",{}),"償却費"]}),e.jsxs("th",{className:"p-3 min-w-[80px]",children:["事業専用",e.jsx("br",{}),"割合(%)"]}),e.jsxs("th",{className:"p-3 min-w-[120px]",children:["本年分必要",e.jsx("br",{}),"経費算入額"]}),e.jsxs("th",{className:"p-3 min-w-[120px]",children:["期末残高",e.jsx("br",{}),"(未償却残高)"]}),e.jsx("th",{className:"p-3 w-[50px]"})]})}),e.jsxs("tbody",{className:"divide-y divide-border bg-surface",children:[r.map((t,i)=>{const n=o[i];return e.jsxs("tr",{className:"hover:bg-surface-highlight/50 transition-colors",children:[e.jsx("td",{className:"p-3 font-medium text-text-main",children:t.name}),e.jsxs("td",{className:"p-3 text-text-main",children:[t.quantity,t.unit]}),e.jsx("td",{className:"p-3 text-text-muted",children:t.acquisitionDate}),e.jsx("td",{className:"p-3 text-white font-mono",children:l(t.acquisitionCost)}),e.jsx("td",{className:"p-3 text-text-main",children:t.depreciationMethod==="straightLine"?"定額法":t.depreciationMethod==="decliningBalance"?"定率法":t.depreciationMethod==="lumpSum"?"一括":t.depreciationMethod==="unitsOfProduction"?"生産高比例":t.depreciationMethod==="leasePeriod"?"リース期間":"少額特例"}),e.jsx("td",{className:"p-3 text-center text-text-main",children:t.depreciationMethod==="unitsOfProduction"?"-":t.depreciationMethod==="immediateSME"?"即時":t.depreciationMethod==="lumpSum"?"3年":`${t.usefulLife}年`}),e.jsx("td",{className:"p-3 text-center text-text-muted",children:t.depreciationMethod==="unitsOfProduction"?`${t.currentYearUnits}/${t.totalEstimatedUnits}`:t.depreciationMethod==="immediateSME"?"-":n.depreciationRate.toFixed(3)}),e.jsx("td",{className:"p-3 text-center text-text-main",children:t.depreciationMethod==="immediateSME"||t.depreciationMethod==="unitsOfProduction"?"-":`${t.currentYearMonths}ヶ月`}),e.jsx("td",{className:"p-3 text-right font-medium text-white bg-primary/5",children:l(n.currentDepreciation)}),e.jsxs("td",{className:"p-3 text-center text-text-main",children:[t.businessRatio,"%"]}),e.jsx("td",{className:"p-3 text-right font-bold text-white",children:l(n.currentDepreciation)}),e.jsx("td",{className:"p-3 text-right text-white",children:l(n.bookValue)}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>j(t.id),className:"text-text-muted hover:text-error transition-colors",children:e.jsx(N,{className:"w-4 h-4"})})})]},t.id)}),r.length===0&&!c&&e.jsx("tr",{children:e.jsx("td",{colSpan:13,className:"p-8 text-center text-text-muted",children:"資産が登録されていません。「資産を追加」ボタンから登録してください。"})})]})]})}),e.jsxs("div",{className:"md:hidden space-y-4",children:[r.map((t,i)=>{const n=o[i];return e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-3 shadow-sm relative",children:[e.jsx("button",{onClick:()=>j(t.id),className:"absolute top-4 right-4 text-text-muted hover:text-error transition-colors p-1",children:e.jsx(N,{className:"w-4 h-4"})}),e.jsx("h4",{className:"font-bold text-text-main mb-3 pr-8 text-lg",children:t.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"取得価額"}),e.jsx("div",{className:"font-medium text-white",children:l(t.acquisitionCost)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"取得年月"}),e.jsx("div",{className:"font-medium text-text-main",children:t.acquisitionDate})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"償却方法"}),e.jsx("div",{className:"font-medium text-text-main",children:t.depreciationMethod==="straightLine"?"定額法":t.depreciationMethod==="decliningBalance"?"定率法":t.depreciationMethod==="lumpSum"?"一括":t.depreciationMethod==="unitsOfProduction"?"生産高比例":t.depreciationMethod==="leasePeriod"?"リース期間":"少額特例"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"耐用年数"}),e.jsx("div",{className:"font-medium text-text-main",children:t.depreciationMethod==="immediateSME"?"即時":t.depreciationMethod==="lumpSum"?"3年":`${t.usefulLife}年`})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"償却率"}),e.jsx("div",{className:"font-medium text-text-main",children:t.depreciationMethod==="unitsOfProduction"||t.depreciationMethod==="immediateSME"?"-":n.depreciationRate.toFixed(3)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"本年償却額"}),e.jsx("div",{className:"font-bold text-white",children:l(n.currentDepreciation)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"事業割合"}),e.jsxs("div",{className:"font-medium text-text-main",children:[t.businessRatio,"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-text-muted mb-0.5",children:"未償却残高"}),e.jsx("div",{className:"font-medium text-white",children:l(n.bookValue)})]})]})]},t.id)}),r.length===0&&!c&&e.jsxs("div",{className:"p-8 text-center text-text-muted border border-dashed border-border rounded-xl",children:["資産が登録されていません。",e.jsx("br",{}),"「資産を追加する」ボタンから登録してください。"]})]}),c?e.jsxs("div",{className:"bg-surface border border-primary/30 rounded-xl p-3 shadow-sm",children:[e.jsxs("h4",{className:"font-medium text-text-main mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-primary"}),"新規資産の登録"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-1 sm:col-span-2 lg:col-span-2",children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"資産名称 *"}),e.jsx("input",{type:"text",value:s.name,onChange:t=>a({...s,name:t.target.value}),className:"input-base w-full",placeholder:"例: パソコン、営業車"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"取得価額 *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:s.acquisitionCost||"",onChange:t=>a({...s,acquisitionCost:Number(t.target.value)}),className:"input-base w-full pr-8"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted text-xs pointer-events-none",children:"円"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"取得年月"}),e.jsx("input",{type:"month",value:s.acquisitionDate,onChange:t=>a({...s,acquisitionDate:t.target.value}),className:"input-base w-full",min:`${new Date().getFullYear()-10}-01`,max:`${new Date().getFullYear()+1}-12`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"償却方法"}),e.jsxs("select",{value:s.depreciationMethod,onChange:t=>a({...s,depreciationMethod:t.target.value}),className:"input-base w-full",children:[e.jsx("option",{value:"straightLine",children:"定額法"}),e.jsx("option",{value:"decliningBalance",children:"定率法"}),e.jsx("option",{value:"lumpSum",children:"一括償却（3年）"}),e.jsx("option",{value:"unitsOfProduction",children:"生産高比例法"}),e.jsx("option",{value:"leasePeriod",children:"リース期間定額法"}),e.jsx("option",{value:"immediateSME",children:"少額減価償却資産（特例）"})]})]}),s.depreciationMethod==="unitsOfProduction"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"推定総利用量"}),e.jsx("input",{type:"number",value:s.totalEstimatedUnits||"",onChange:t=>a({...s,totalEstimatedUnits:Number(t.target.value)}),className:"input-base w-full",placeholder:"例: 100000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"本年利用量"}),e.jsx("input",{type:"number",value:s.currentYearUnits||"",onChange:t=>a({...s,currentYearUnits:Number(t.target.value)}),className:"input-base w-full",placeholder:"例: 1000"})]})]}):e.jsxs(e.Fragment,{children:[s.depreciationMethod!=="immediateSME"&&s.depreciationMethod!=="lumpSum"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"耐用年数 (年)"}),e.jsx("input",{type:"number",value:s.usefulLife,onChange:t=>a({...s,usefulLife:Number(t.target.value)}),className:"input-base w-full",min:"1"})]}),s.depreciationMethod==="lumpSum"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"耐用年数 (年)"}),e.jsx("input",{type:"text",value:"3",disabled:!0,className:"input-base w-full bg-surface-highlight cursor-not-allowed"})]})]}),s.depreciationMethod!=="immediateSME"&&s.depreciationMethod!=="lumpSum"&&s.depreciationMethod!=="unitsOfProduction"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"本年中の償却期間 (月)"}),e.jsx("input",{type:"number",value:s.currentYearMonths,onChange:t=>a({...s,currentYearMonths:Math.min(12,Math.max(1,Number(t.target.value)))}),className:"input-base w-full",min:"1",max:"12"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-text-muted block mb-1",children:"事業専用割合 (%)"}),e.jsx("input",{type:"number",value:s.businessRatio,onChange:t=>a({...s,businessRatio:Math.min(100,Math.max(0,Number(t.target.value)))}),className:"input-base w-full",min:"0",max:"100"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx("button",{onClick:()=>x(!1),className:"btn-secondary py-2 px-4",children:"キャンセル"}),e.jsxs("button",{onClick:y,disabled:!s.name||s.acquisitionCost<=0,className:"btn-primary py-2 px-4 flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"追加する"]})]})]}):e.jsxs("button",{onClick:()=>x(!0),className:"w-full md:w-auto md:mx-auto md:px-12 py-3 md:py-2.5 border-2 border-dashed border-primary rounded-xl text-primary bg-primary-light transition-colors flex items-center justify-center gap-2",children:[e.jsx(f,{className:"w-5 h-5"}),"資産を追加する"]}),e.jsxs("div",{className:"bg-info-light border border-info/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(C,{className:"w-5 h-5 text-info flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"減価償却の記帳について"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"ここで計算された償却費の合計額は、自動的に損益計算書の「減価償却費」として計上されます。 10万円未満の資産は消耗品費として処理できます（青色申告の場合は30万円未満を少額減価償却資産として即時償却できる特例もあります）。"})]})]})]})};export{L as D};
