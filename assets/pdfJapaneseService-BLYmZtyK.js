const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdfDigitBoxService-B8NyRDuh.js","assets/pdfAutoFillService-C6llV050.js","assets/index-Dp8kLXFF.js","assets/index-D-EzV8lL.css","assets/pdfAnchorDetector-CcGx4JeL.js"])))=>i.map(i=>d[i]);
import{_ as ie}from"./index-Dp8kLXFF.js";import{P as J,r as l,f as le,a as ge}from"./pdfAutoFillService-C6llV050.js";const ue={交通費:"旅費交通費",旅費交通費:"旅費交通費",通信費:"通信費",水道光熱費:"水道光熱費",消耗品費:"消耗品費",接待交際費:"接待交際費",広告宣伝費:"広告宣伝費",地代家賃:"地代家賃",外注費:"外注工賃",給与:"給料賃金",雑費:"雑費",減価償却費:"減価償却費",修繕費:"修繕費",保険料:"損害保険料",福利厚生費:"福利厚生費",支払利息:"支払利息",租税公課:"租税公課",荷造運賃:"荷造運賃",その他:"雑費",未分類:"雑費","Travel & Transportation":"旅費交通費",Communication:"通信費",Utilities:"水道光熱費",Supplies:"消耗品費",Entertainment:"接待交際費",Advertising:"広告宣伝費",Rent:"地代家賃",Outsourcing:"外注工賃",Salaries:"給料賃金",Miscellaneous:"雑費",Depreciation:"減価償却費",Repairs:"修繕費",Insurance:"損害保険料",Benefits:"福利厚生費",Interest:"支払利息","Taxes & Dues":"租税公課",Shipping:"荷造運賃",Other:"雑費",Uncategorized:"雑費"};async function ne(o){o.registerFontkit(le);try{const u=await fetch("/fonts/NotoSansCJKjp-Regular.otf").then(m=>m.arrayBuffer()),g=await fetch("/fonts/NotoSansCJKjp-Bold.otf").then(m=>m.arrayBuffer()),s=await o.embedFont(u),i=await o.embedFont(g);return{regular:s,bold:i}}catch(u){console.error("日本語フォントのロードに失敗:",u);const g=u instanceof Error?u.message:String(u);throw new Error(`日本語フォントのロードに失敗しました (${g})。public/fonts/にフォントファイルを正しく配置してください。`)}}function A(o){return o===0?"0":o.toLocaleString("ja-JP")}function re(o){return`令和${o-2018}年`}async function me(o){const u=await J.create(),g=u.addPage([595.28,841.89]),{regular:s,bold:i}=await ne(u),{width:m,height:d}=g.getSize(),c={primary:l(.1,.2,.4),secondary:l(.15,.3,.5),text:l(.1,.1,.1),muted:l(.45,.45,.45),line:l(.6,.6,.6),headerBg:l(.92,.94,.98),highlight:l(.94,.96,1),green:l(.15,.55,.25),red:l(.75,.2,.2),lightGreen:l(.88,.96,.88),lightRed:l(1,.93,.93)},n=18,r=24,a={text:(p,F,f,I={})=>{g.drawText(p,{x:F,y:f,size:I.size||10,font:I.font||s,color:I.color||c.text})},line:(p,F,f,I,O=.5)=>{g.drawLine({start:{x:p,y:F},end:{x:f,y:I},thickness:O,color:c.line})},rect:(p,F,f,I,O)=>{g.drawRectangle({x:p,y:F,width:f,height:I,color:O})}};a.rect(0,d-60,m,60,c.primary),a.text("法 人 税 申 告 書",190,d-38,{size:24,font:i,color:l(1,1,1)}),a.text("（参考資料）",390,d-38,{size:12,color:l(.8,.85,.9)});let t=d-78;a.text(`${o.companyName||"会社名"}`,50,t,{size:13,font:i}),a.text(`${o.fiscalYear}年度（${re(o.fiscalYear)}度）`,300,t,{size:11}),a.text(`作成日: ${new Date().toLocaleDateString("ja-JP")}`,450,t,{size:9,color:c.muted}),t-=20,a.line(40,t,555,t,1.5),t-=15,a.rect(40,t-r,515,r,c.secondary),a.text("第1部　法人情報",50,t-17,{size:12,font:i,color:l(1,1,1)}),t-=r+8,[["会社名（商号）",o.companyName||"―"],["代表者氏名",o.representativeName||"―"],["法人番号",o.corporateNumber||"―"],["本店所在地",o.address||"―"],["資本金",o.capital?`${A(o.capital)}円`:"―"]].forEach(([p,F],f)=>{f%2===0&&a.rect(40,t-n,515,n,c.highlight),a.line(40,t-n,555,t-n),a.text(p,55,t-n+5,{size:10}),a.text(F,200,t-n+5,{size:10}),t-=n}),t-=15,a.rect(40,t-r,515,r,c.secondary),a.text("第2部　損益の計算",50,t-17,{size:12,font:i,color:l(1,1,1)}),t-=r+8,a.rect(40,t-n-2,515,n+2,c.highlight),a.line(40,t-n-2,555,t-n-2),a.text("売上高",55,t-n+3,{size:11}),a.text(`${A(o.revenue)}円`,450,t-n+3,{size:11}),t-=n+4,a.line(40,t-n,555,t-n),a.text("売上原価・経費合計",55,t-n+5,{size:10}),a.text(`${A(o.expenses)}円`,450,t-n+5,{size:10}),t-=n+2,a.rect(40,t-n-4,515,n+4,c.lightGreen),a.line(40,t-n-4,555,t-n-4,1),a.line(40,t,555,t,1),a.text("当期純利益",55,t-n+1,{size:12,font:i}),a.text(`${A(o.netIncome)}円`,440,t-n+1,{size:12,font:i,color:o.netIncome>=0?c.green:c.red}),t-=n+20,a.rect(40,t-r,515,r,c.secondary),a.text("第3部　税額の計算",50,t-17,{size:12,font:i,color:l(1,1,1)}),t-=r+8;const v=o.taxableIncome,R=v<=8e6?.15:.232,P=Math.floor(v*R),T=Math.floor(P*.103),x=Math.floor(v*.07),G=P+T+x;[{label:"課税所得金額",value:`${A(v)}円`,highlight:!0},{label:`法人税額（税率${(R*100).toFixed(1)}%）`,value:`${A(P)}円`},{label:"地方法人税（10.3%）",value:`${A(T)}円`},{label:"事業税（概算7%）",value:`${A(x)}円`}].forEach((p,F)=>{p.highlight?a.rect(40,t-n,515,n,c.highlight):F%2===1&&a.rect(40,t-n,515,n,l(.98,.98,.98)),a.line(40,t-n,555,t-n),a.text(p.label,55,t-n+5,{size:10}),a.text(p.value,450,t-n+5,{size:10}),t-=n}),t-=8,a.rect(40,t-n-8,515,n+8,c.lightRed),a.line(40,t-n-8,555,t-n-8,1.5),a.line(40,t,555,t,1.5),a.text("税額合計（概算）",55,t-n-1,{size:13,font:i}),a.text(`${A(G)}円`,430,t-n-1,{size:13,font:i,color:c.red}),t-=n+35,a.rect(40,t-r,515,r,c.secondary),a.text("第4部　別表五(一)相当：利益積立金の計算",50,t-17,{size:12,font:i,color:l(1,1,1)}),t-=r+8;const S=o.beginningRetainedEarnings||0,E=o.netIncome,Y=S+E;return[["期首利益積立金（前期末残高）",A(S)+"円"],["当期の純利益（増加額）",A(E)+"円"],["期末利益積立金（当期末残高）",A(Y)+"円"]].forEach(([p,F],f)=>{const I=f===2;I?a.rect(40,t-n-2,515,n+2,c.highlight):f%2===0&&a.rect(40,t-n,515,n,l(.98,.98,.98)),a.line(40,t-n,555,t-n),a.text(p,55,t-n+5,{size:10,font:I?i:s}),a.text(F,430,t-n+5,{size:10,font:I?i:s}),t-=n+(I?2:0)}),t-=10,a.text("※ 利益剰余金（期末）＝ 期首残高 ＋ 当期純利益（税引後）",55,t,{size:8,color:c.muted}),a.line(40,75,555,75),a.text("※ この書類はAinanceで作成した参考資料です。",45,58,{size:9,color:c.muted}),a.text("※ 正式な申告には税理士への相談またはe-Taxをご利用ください。",45,44,{size:9,color:c.muted}),u.save()}async function we(o){const u=await J.create(),g=u.addPage([595.28,841.89]),{regular:s,bold:i}=await ne(u),{width:m,height:d}=g.getSize(),c={primary:l(.1,.2,.4),secondary:l(.15,.3,.5),text:l(.1,.1,.1),muted:l(.45,.45,.45),line:l(.6,.6,.6),headerBg:l(.92,.94,.98),highlight:l(.94,.96,1),green:l(.15,.55,.25),red:l(.75,.2,.2),lightGreen:l(.88,.96,.88),lightBlue:l(.88,.93,1)},n=16,r=20,a=22,t={text:(b,z,$,C={})=>{g.drawText(b,{x:z,y:$,size:C.size||9,font:C.font||s,color:C.color||c.text})},line:(b,z,$,C,oe=.5)=>{g.drawLine({start:{x:b,y:z},end:{x:$,y:C},thickness:oe,color:c.line})},rect:(b,z,$,C,oe)=>{g.drawRectangle({x:b,y:z,width:$,height:C,color:oe})}};t.rect(0,d-55,m,55,c.primary),t.text("決 算 報 告 書",210,d-35,{size:22,font:i,color:l(1,1,1)}),t.text("（財務三表）",360,d-35,{size:14,color:l(.85,.85,.9)});let e=d-72;t.text(`${o.companyName||"会社名"}`,50,e,{size:12,font:i}),o.fiscalYearStart&&o.fiscalYearEnd?t.text(`自 ${o.fiscalYearStart}　至 ${o.fiscalYearEnd}`,210,e,{size:10}):t.text(`${o.fiscalYear}年度（${re(o.fiscalYear)}度）`,280,e,{size:10}),t.text("（単位：円）",400,e,{size:10}),t.text(`作成日: ${new Date().toLocaleDateString("ja-JP")}`,480,e,{size:9,color:c.muted}),e-=18,t.line(40,e,555,e,1.5),e-=12;const v=o.operatingIncome??o.revenue-o.expenses,R=o.costOfSales??0,P=o.grossProfit??o.revenue-R,T=o.nonOperatingIncome??0,x=o.nonOperatingExpenses??0,G=o.ordinaryIncome??v+T-x,N=o.cash??o.beginningCash??0,S=(o.accountsReceivable??0)+(o.beginningReceivable??0),E=(o.inventory??0)+(o.beginningInventory??0),Y=(o.fixedAssets??0)+(o.beginningFixedAssets??0),B=o.totalAssets??N+S+E+Y,p=(o.accountsPayable??0)+(o.beginningPayable??0),F=(o.shortTermLoans??0)+(o.beginningShortTermLoans??0),f=(o.longTermLoans??0)+(o.beginningLongTermLoans??0),I=o.totalLiabilities??p+F+f,O=o.capital||o.beginningCapital||o.estimatedCapital||0,j=o.beginningRetainedEarnings??0,W=o.retainedEarnings??j+o.netIncome,h=o.depreciation??0,_=o.netIncome+h,w=0,y=0,D=_+w+y,L=40,H=250,K=e;t.rect(L,e-a,H,a,c.secondary),t.text("損益計算書（P/L）",L+70,e-15,{size:11,font:i,color:l(1,1,1)}),e-=a+4,[{label:"売上高",value:o.revenue,isHighlight:!0},{label:"売上原価",value:R},{label:"売上総利益",value:P,isSubtotal:!0},{label:"販売費及び一般管理費",value:o.operatingExpenses||o.expenses-R},{label:"営業利益",value:v,isSubtotal:!0,color:v>=0?c.green:c.red},{label:"営業外収益",value:T},{label:"営業外費用",value:x},{label:"経常利益",value:G,isSubtotal:!0},{label:"当期純利益",value:o.netIncome,isTotal:!0,color:o.netIncome>=0?c.green:c.red}].forEach(b=>{const z=b.isTotal?n+4:n;b.isTotal?t.rect(L,e-z,H,z,c.lightGreen):b.isSubtotal?t.rect(L,e-z,H,z,c.headerBg):b.isHighlight&&t.rect(L,e-z,H,z,c.highlight),t.line(L,e-z,L+H,e-z),t.text(b.label,L+8,e-z+5,{size:b.isTotal?10:9,font:b.isSubtotal||b.isTotal?i:s}),t.text(`${A(b.value)}`,L+H-60,e-z+5,{size:b.isTotal?10:9,font:b.isSubtotal||b.isTotal?i:s,color:b.color||c.text}),e-=z});const q=e;e=K;const k=305,se=250,M=122;t.rect(k,e-a,se,a,c.secondary),t.text("貸借対照表（B/S）",k+70,e-15,{size:11,font:i,color:l(1,1,1)}),e-=a+4,t.rect(k,e-r,M,r,l(.85,.9,.95)),t.text("資産の部",k+35,e-14,{size:10,font:i}),t.rect(k+M+6,e-r,M,r,l(.95,.9,.88)),t.text("負債・純資産の部",k+M+15,e-14,{size:10,font:i}),e-=r+2;const ce=[{label:"流動資産",isSection:!0},{label:"　現金預金",value:N},{label:"　売掛金",value:S},{label:"　棚卸資産",value:E},{label:"固定資産",isSection:!0},{label:"　有形固定資産",value:Y},{label:"資産合計",value:B,isTotal:!0}],ae=I+O+W,pe=[{label:"流動負債",isSection:!0},{label:"　買掛金",value:p},{label:"　短期借入金",value:F},{label:"純資産の部",isSection:!0},{label:"　資本金",value:O},{label:"　利益剰余金",value:W},{label:"負債純資産合計",value:ae,isTotal:!0}];let U=e,V=e;ce.forEach(b=>{const z=b.isTotal?n+2:n-1;b.isTotal?t.rect(k,U-z,M,z,c.lightGreen):b.isSection&&t.rect(k,U-z,M,z,c.highlight),t.line(k,U-z,k+M,U-z),t.text(b.label,k+4,U-z+4,{size:8,font:b.isSection||b.isTotal?i:s}),b.value!==void 0&&t.text(A(b.value),k+M-45,U-z+4,{size:8,font:b.isTotal?i:s}),U-=z}),pe.forEach(b=>{const z=b.isTotal?n+2:n-1,$=k+M+6;b.isTotal?t.rect($,V-z,M,z,c.lightGreen):b.isSection&&t.rect($,V-z,M,z,c.highlight),t.line($,V-z,$+M,V-z),t.text(b.label,$+4,V-z+4,{size:8,font:b.isSection||b.isTotal?i:s}),b.value!==void 0&&t.text(A(b.value),$+M-48,V-z+4,{size:8,font:b.isTotal?i:s}),V-=z}),e=Math.min(q,U,V)-20,t.rect(40,e-a,m-80,a,c.secondary),t.text("キャッシュ・フロー計算書（C/F）",200,e-15,{size:11,font:i,color:l(1,1,1)}),e-=a+6;const X=165,fe=10;return[{title:"営業活動によるCF",items:[{label:"税引前当期純利益",value:o.netIncome},{label:"減価償却費",value:h},{label:"売上債権の増減",value:-Math.floor(S*.1)},{label:"仕入債務の増減",value:Math.floor(p*.1)}],total:_},{title:"投資活動によるCF",items:[{label:"固定資産の取得",value:w},{label:"投資有価証券の取得",value:0}],total:w},{title:"財務活動によるCF",items:[{label:"借入金の返済",value:y},{label:"配当金の支払",value:0}],total:y}].forEach((b,z)=>{const $=40+z*(X+fe);let C=e;t.rect($,C-r,X,r,c.headerBg),t.line($,C-r,$+X,C-r),t.text(b.title,$+25,C-14,{size:9,font:i}),C-=r+2,b.items.forEach(oe=>{t.line($,C-n,$+X,C-n),t.text(oe.label,$+6,C-n+5,{size:8}),t.text(A(oe.value),$+X-50,C-n+5,{size:8}),C-=n}),t.rect($,C-n-2,X,n+2,c.lightBlue),t.line($,C-n-2,$+X,C-n-2,1),t.text("小計",$+6,C-n+3,{size:9,font:i}),t.text(A(b.total),$+X-50,C-n+3,{size:9,font:i,color:b.total>=0?c.green:c.red})}),e=e-(r+n*4+n+2+15),t.rect(40,e-r,m-80,r,c.lightGreen),t.line(40,e-r,555,e-r,1.5),t.line(40,e,555,e,1.5),t.text("現金及び現金同等物の増減額",50,e-14,{size:11,font:i}),t.text(`${A(D)}円`,440,e-14,{size:11,font:i,color:D>=0?c.green:c.red}),e-=r+5,t.line(40,e-n,555,e-n),t.text("現金及び現金同等物の期末残高",50,e-n+5,{size:10}),t.text(`${A(N+D)}円`,440,e-n+5,{size:10,font:i}),t.line(40,70,555,70),t.text("※ この決算報告書はAinanceで作成した参考資料です。",45,55,{size:8,color:c.muted}),t.text("※ 貸借対照表・キャッシュフロー計算書は売上・経費データからの概算です。正確な作成には税理士へご相談ください。",45,43,{size:8,color:c.muted}),u.save()}async function ze(o){var i,m,d,c;const g=await fetch(`/templates/kakutei1&2.pdf?t=${Date.now()}`).then(n=>n.arrayBuffer()),s={name:o.name,address:o.address,phone:o.phone,tradeName:o.tradeName,revenue:o.revenue,expenses:o.expenses,netIncome:o.netIncome,businessIncome:o.netIncome,totalIncome:o.netIncome,taxableIncome:o.taxableIncome,estimatedTax:o.estimatedTax,fiscalYear:o.fiscalYear,fiscalYearStart:o.fiscalYearStart,fiscalYearEnd:o.fiscalYearEnd,isBlueReturn:!!o.isBlueReturn,expensesByCategory:o.expensesByCategory,deductions:{basic:(i=o.deductions)==null?void 0:i.basic,blueReturn:(m=o.deductions)==null?void 0:m.blueReturn,socialInsurance:(d=o.deductions)==null?void 0:d.socialInsurance,lifeInsurance:(c=o.deductions)==null?void 0:c.lifeInsurance}};return await ge(g,s)}async function Te(o){var e;const u=await J.create(),g=u.addPage([595.28,841.89]),{regular:s,bold:i}=await ne(u),{width:m,height:d}=g.getSize(),c={primary:l(.2,.4,.8),text:l(.1,.1,.1),muted:l(.4,.4,.4),line:l(.5,.5,.5),highlight:l(.95,.95,1),green:l(.2,.6,.3)},n=(v,R,P,T={})=>{g.drawText(v,{x:R,y:P,size:T.size||10,font:T.font||s,color:T.color||c.text})},r=(v,R,P,T,x=.5)=>{g.drawLine({start:{x:v,y:R},end:{x:P,y:T},thickness:x,color:c.line})},a=(v,R,P,T,x)=>{g.drawRectangle({x:v,y:R,width:P,height:T,color:x})};a(0,d-60,m,60,c.primary),n("青色申告決算書",200,d-40,{size:20,font:i,color:l(1,1,1)}),n("（一般用）",340,d-40,{size:12,color:l(.9,.9,.9)});let t=d-85;if(n(`${re(o.fiscalYear)}分　所得税青色申告決算書`,50,t,{size:11,font:i}),o.tradeName&&n(`屋号: ${o.tradeName}`,350,t,{size:10}),n(`作成日: ${new Date().toLocaleDateString("ja-JP")}`,450,t,{size:9,color:c.muted}),t-=30,r(50,t,545,t,1),t-=25,n("損益計算書",50,t,{size:12,font:i,color:c.primary}),t-=20,a(50,t-5,495,20,c.highlight),r(50,t-5,545,t-5),n("売上（収入）金額　①",60,t,{font:i}),n(`${A(o.revenue)}円`,450,t,{font:i}),t-=30,n("経費",50,t,{size:11,font:i}),t-=20,a(50,t-15,495,15,l(.9,.9,.9)),r(50,t,545,t),r(50,t-15,545,t-15),n("勘定科目",60,t-11,{font:i,size:9}),n("金額",470,t-11,{font:i,size:9}),t-=18,o.expensesByCategory.forEach((v,R)=>{const P=ue[v.category]||v.category||"雑費";R%2===0&&a(50,t-15,495,15,l(.98,.98,.98)),r(50,t-15,545,t-15),n(P,60,t-11,{size:9}),n(A(v.amount),450,t-11,{size:9}),t-=15,t<200}),a(50,t-18,495,18,l(.95,.95,.95)),r(50,t-18,545,t-18),n("経費合計　㉑",60,t-13,{font:i}),n(`${A(o.expenses)}円`,445,t-13,{font:i}),t-=30,r(50,t-5,545,t-5),n("差引金額　① - ㉑",60,t),n(`${A(o.netIncome)}円`,450,t),t-=25,(e=o.deductions)!=null&&e.blueReturn){r(50,t-5,545,t-5),n("青色申告特別控除額",60,t),n(`${A(o.deductions.blueReturn)}円`,450,t),t-=25;const v=Math.max(0,o.netIncome-o.deductions.blueReturn);a(50,t-8,495,25,l(.95,1,.95)),r(50,t-8,545,t-8,1),r(50,t+17,545,t+17,1),n("所得金額　㊸",60,t+2,{font:i,size:11}),n(`${A(v)}円`,440,t+2,{font:i,size:11,color:c.green})}return r(50,60,545,60),n("※ この書類はAinanceで作成した参考資料です。",50,45,{size:8,color:c.muted}),n("※ 正式な申告には国税庁「確定申告書等作成コーナー」をご利用ください。",50,33,{size:8,color:c.muted}),u.save()}async function Be(o){const u=await J.create(),g=50,s=841.89,i=595.28;let m=u.addPage([i,s]);const{regular:d,bold:c}=await ne(u),n={primary:l(.1,.2,.4),text:l(.1,.1,.1),muted:l(.4,.4,.4),line:l(.8,.8,.8),headerBg:l(.95,.95,.98)};let r=s-g;const a=(T,x,G,N=10,S=d,E=n.text)=>{m.drawText(T,{x,y:G,size:N,font:S,color:E})},t=(T,x,G,N)=>{if(!T)return[];const S=T.split(""),E=[];let Y="";for(let B=0;B<S.length;B++){const p=S[B];G.widthOfTextAtSize(Y+p,x)<N?Y+=p:(E.push(Y),Y=p)}return E.push(Y),E},e=T=>r-T<g?(m=u.addPage([i,s]),r=s-g,!0):!1;e(80),a("補 助 金 申 請 書 （案）",g,r,18,c),r-=30,a(`申請補助金: ${o.subsidyName}`,g,r,12,c,n.primary),r-=20,a(`作成日: ${new Date().toLocaleDateString("ja-JP")}`,g,r,10,d,n.muted),r-=10,m.drawLine({start:{x:g,y:r},end:{x:i-g,y:r},thickness:1,color:n.primary}),r-=30;const v=i-g*2,R=10,P=16;for(const T of o.sections){e(40),m.drawRectangle({x:g,y:r-20,width:v,height:24,color:n.headerBg}),a(T.title,g+10,r-14,11,c,n.primary),r-=35;const x=T.content.split(`
`);for(const G of x){const N=t(G,R,d,v);for(const S of N)e(P),a(S,g,r,R,d),r-=P;r-=5}r-=15}return u.save()}async function ve(o){const u=await J.create(),{regular:g,bold:s}=await ne(u),i={primary:l(.1,.2,.4),secondary:l(.15,.3,.5),text:l(.1,.1,.1),muted:l(.45,.45,.45),line:l(.6,.6,.6),headerBg:l(.92,.94,.98),highlight:l(.94,.96,1),lightGreen:l(.88,.96,.88),lightRed:l(1,.93,.93)},m=h=>({text:(_,w,y,D={})=>{const L=D.size||10,H=D.font||g,K=D.color||i.text;let te=w;if(D.align==="right"){const q=H.widthOfTextAtSize(_,L);te-=q}else if(D.align==="center"){const q=H.widthOfTextAtSize(_,L);te-=q/2}h.drawText(_,{x:te,y,size:L,font:H,color:K})},line:(_,w,y,D,L=.5)=>{h.drawLine({start:{x:_,y:w},end:{x:y,y:D},thickness:L,color:i.line})},rect:(_,w,y,D,L)=>{h.drawRectangle({x:_,y:w,width:y,height:D,color:L})},currency:(_,w,y,D=10)=>{const L=A(_),H=g,K=H.widthOfTextAtSize(L,D);h.drawText(L,{x:w-K,y,size:D,font:H,color:i.text})}}),d=u.addPage([595.28,841.89]),c=m(d),{width:n,height:r}=d.getSize();c.rect(0,r-150,n,150,i.primary),c.text("法人税申告書報告書",n/2,r-80,{size:28,font:s,color:l(1,1,1),align:"center"}),c.text(`${re(new Date().getFullYear())}度版`,n/2,r-120,{size:14,color:l(.9,.9,1),align:"center"}),c.text("会社名:",100,r-300,{size:14,color:i.muted}),c.text("（会社名未設定）",200,r-300,{size:18,font:s}),c.text("作成日:",100,r-350,{size:14,color:i.muted}),c.text(new Date().toLocaleDateString("ja-JP"),200,r-350,{size:18}),c.text("※ 本資料はAinanceで作成された参考資料です。",n/2,100,{size:10,color:i.muted,align:"center"}),c.text("正式な税務申告には、税理士の確認またはe-Taxをご利用ください。",n/2,80,{size:10,color:i.muted,align:"center"});const a=u.addPage([595.28,841.89]),t=m(a);Q(t,"別表一（一）","各事業年度の所得に係る申告書",r,n,i,s);let e=r-100;Z(t,"申告額の計算",e,n,i,s),e-=25;const v=(h,_,w,y,D=!1)=>{h.rect(50,y-20,300,20,D?i.headerBg:l(1,1,1)),h.rect(350,y-20,195,20,D?i.headerBg:l(1,1,1)),h.line(50,y-20,545,y-20),h.line(50,y,545,y),h.line(50,y,50,y-20),h.line(350,y,350,y-20),h.line(545,y,545,y-20),h.text(_,60,y-14,{size:10,font:D?s:g}),typeof w=="number"?h.currency(w,535,y-14,10):h.text(w,360,y-14,{size:10})};v(t,"1. 別表四の所得金額又は欠損金額",o.beppyo4.taxableIncome,e),e-=20,v(t,"2. 欠損金又は災害損失金の控除額",0,e),e-=20,v(t,"3. 翌期へ繰り越す欠損金又は災害損失金",0,e),e-=20,v(t,"4. 課税標準額 (1-2)",Math.max(0,o.beppyo1.taxableIncome),e),e-=20,e-=10,v(t,"5. 課税標準額に対する法人税額",o.beppyo1.corporateTaxAmount,e),e-=20,v(t,"6. 控除税額（所得税額等）",o.beppyo1.specialTaxCredit,e),e-=20,v(t,"7. 差引所得に対する法人税額 (5-6)",Math.max(0,o.beppyo1.corporateTaxAmount-o.beppyo1.specialTaxCredit),e),e-=20;const R=Math.floor(o.beppyo1.corporateTaxAmount*.103);v(t,"8. 地方法人税額（課税標準法人税額 × 10.3%）",R,e),e-=20,v(t,"9. 中間申告分の法人税額",o.beppyo1.interimPayment,e),e-=20;const P=Math.max(0,o.beppyo1.corporateTaxAmount-o.beppyo1.specialTaxCredit+R-o.beppyo1.interimPayment);v(t,"10. 差引確定法人税額",P,e,!0),e-=20;const T=u.addPage([595.28,841.89]),x=m(T);Q(x,"別表四","所得の金額の計算に関する明細書",r,n,i,s),e=r-100,Z(x,"損益の計算",e,n,i,s),e-=25,x.rect(50,e-20,250,20,i.headerBg),x.rect(300,e-20,120,20,i.headerBg),x.rect(420,e-20,125,20,i.headerBg),x.text("区分",150,e-14,{size:10,font:s,align:"center"}),x.text("総額",360,e-14,{size:10,font:s,align:"center"}),x.text("処分（留保）",480,e-14,{size:10,font:s,align:"center"}),x.line(50,e,545,e),x.line(50,e-20,545,e-20),x.line(50,e,50,e-20),x.line(300,e,300,e-20),x.line(420,e,420,e-20),x.line(545,e,545,e-20),e-=20;const G=(h,_,w)=>{x.line(50,e-20,545,e-20),x.line(50,e,50,e-20),x.line(300,e,300,e-20),x.line(420,e,420,e-20),x.line(545,e,545,e-20),x.text(h,60,e-14,{size:9}),x.currency(_,410,e-14,9),x.currency(w,535,e-14,9),e-=20};G("1. 当期純利益",o.beppyo4.netIncomeFromPL,o.beppyo4.netIncomeFromPL),o.beppyo4.additions.forEach(h=>{G(`(加) ${h.description}`,h.amount,h.amount)}),o.beppyo4.subtractions.forEach(h=>{G(`(減) ${h.description}`,h.amount,h.amount)}),x.rect(50,e-20,495,20,i.highlight),G("所得金額 (総額 + 加算 - 減算)",o.beppyo4.taxableIncome,o.beppyo4.taxableIncome);const N=u.addPage([595.28,841.89]),S=m(N);Q(S,"別表五(一)","利益積立金額の計算に関する明細書",r,n,i,s),e=r-100;const E=20;Z(S,"利益積立金額",e,n,i,s),e-=25;const Y=(h,_,w,y=!1)=>{S.rect(50,w-20,250,20,y?i.headerBg:l(1,1,1)),S.rect(300,w-20,245,20,y?i.headerBg:l(1,1,1)),S.line(50,w-20,545,w-20),S.line(50,w,545,w),S.line(50,w,50,w-20),S.line(300,w,300,w-20),S.line(545,w,545,w-20),S.text(h,60,w-14,{size:10,font:y?s:g}),S.currency(_,535,w-14,10)};Y("期首利益積立金額",o.beppyo5.retainedEarningsBegin,e),e-=20,Y("当期増加額",o.beppyo5.currentIncrease,e),e-=20,Y("当期減少額",o.beppyo5.currentDecrease,e),e-=20,Y("期末利益積立金額",o.beppyo5.totalRetainedEarningsEnd,e,!0),e-=20,e-=20,Z(S,"資本金等の額",e,n,i,s),e-=25,Y("期首資本金等の額",o.beppyo5.capitalBegin,e),e-=20,Y("期末資本金等の額",o.beppyo5.capitalEnd,e,!0),e-=20;const B=u.addPage([595.28,841.89]),p=m(B);Q(p,"別表五(二)","租税公課の納付状況等に関する明細書",r,n,i,s),e=r-100,Z(p,"納付状況",e,n,i,s),e-=25,p.rect(50,e-20,300,20,l(1,1,1)),p.rect(350,e-20,195,20,l(1,1,1)),p.line(50,e,545,e),p.line(50,e-20,545,e-20),p.line(50,e,50,e-20),p.line(350,e,350,e-20),p.line(545,e,545,e-20),p.text("当期納付税額計",60,e-14,{size:10}),p.currency(o.beppyo5_2.totalPaid,535,e-14,10),e-=20,e-=10,p.rect(50,e-20,190,20,i.headerBg),p.rect(240,e-20,150,20,i.headerBg),p.rect(390,e-20,155,20,i.headerBg),p.line(50,e,545,e),p.line(50,e-20,545,e-20),p.line(50,e,50,e-20),p.line(240,e,240,e-20),p.line(390,e,390,e-20),p.line(545,e,545,e-20),p.text("税目",110,e-15,{size:9,font:s,align:"center"}),p.text("納付日",315,e-15,{size:9,font:s,align:"center"}),p.text("金額",460,e-15,{size:9,font:s,align:"center"}),e-=20,o.beppyo5_2.items.forEach(h=>{p.rect(50,e-20,190,20,l(1,1,1)),p.rect(240,e-20,150,20,l(1,1,1)),p.rect(390,e-20,155,20,l(1,1,1)),p.line(50,e,545,e),p.line(50,e-20,545,e-20),p.line(50,e,50,e-20),p.line(240,e,240,e-20),p.line(390,e,390,e-20),p.line(545,e,545,e-20),p.text(h.description,60,e-15,{size:9}),p.text(h.paymentDate,315,e-15,{size:9,align:"center"}),p.currency(h.amount,535,e-15,9),e-=20});const F=u.addPage([595.28,841.89]),f=m(F);Q(f,"別表二","同族会社等の判定に関する明細書",r,n,i,s),e=r-100,Z(f,"基本情報",e,n,i,s),e-=25,f.rect(50,e-20,300,20,i.headerBg),f.rect(350,e-20,195,20,l(1,1,1)),f.line(50,e,545,e),f.line(50,e-20,545,e-20),f.line(50,e,50,e-20),f.line(350,e,350,e-20),f.line(545,e,545,e-20),f.text("発行済株式総数",60,e-14,{size:10,font:s}),f.currency(o.beppyo2.totalShares,535,e-14,10),e-=20,f.rect(50,e-20,300,20,i.headerBg),f.rect(350,e-20,195,20,l(1,1,1)),f.line(50,e,545,e),f.line(50,e-20,545,e-20),f.line(50,e,50,e-20),f.line(350,e,350,e-20),f.line(545,e,545,e-20),f.text("同族会社判定",60,e-14,{size:10,font:s}),f.text(o.beppyo2.isFamilyCompany?"該当":"非該当",360,e-14,{size:10}),e-=40,Z(f,"株主一覧",e,n,i,s),e-=25,f.rect(50,e-20,190,20,i.headerBg),f.rect(240,e-20,100,20,i.headerBg),f.rect(340,e-20,100,20,i.headerBg),f.rect(440,e-20,105,20,i.headerBg),f.line(50,e,545,e),f.line(50,e-20,545,e-20),f.line(50,e,50,e-20),f.line(240,e,240,e-20),f.line(340,e,340,e-20),f.line(440,e,440,e-20),f.line(545,e,545,e-20),f.text("株主名",60,e-15,{size:9,font:s}),f.text("持株数",320,e-15,{size:9,font:s,align:"right"}),f.text("割合",420,e-15,{size:9,font:s,align:"right"}),f.text("関係",450,e-15,{size:9,font:s}),e-=20,o.beppyo2.shareholders.forEach(h=>{f.rect(50,e-20,190,20,l(1,1,1)),f.rect(240,e-20,100,20,l(1,1,1)),f.rect(340,e-20,100,20,l(1,1,1)),f.rect(440,e-20,105,20,l(1,1,1)),f.line(50,e,545,e),f.line(50,e-20,545,e-20),f.line(50,e,50,e-20),f.line(240,e,240,e-20),f.line(340,e,340,e-20),f.line(440,e,440,e-20),f.line(545,e,545,e-20),f.text(h.name,60,e-15,{size:9}),f.currency(h.shares,330,e-15,9);const _=o.beppyo2.totalShares>0?(h.shares/o.beppyo2.totalShares*100).toFixed(1)+"%":"-";f.text(_,430,e-15,{size:9,align:"right"}),f.text(h.relationship,450,e-15,{size:9}),e-=20});const I=u.addPage([595.28,841.89]),O=m(I);Q(O,"別表十五","交際費等の損金算入に関する明細書",r,n,i,s),e=r-100,ee(O,"1. 交際費等の支出額",o.beppyo15.socialExpenses,e,n,i,E),e-=E,ee(O,"2. うち接待飲食費",o.beppyo15.deductibleExpenses,e,n,i,E),e-=E,ee(O,"3. 損金算入限度額",o.beppyo15.deductionLimit,e,n,i,E,!0),e-=E,ee(O,"4. 損金不算入額",o.beppyo15.excessAmount,e,n,i,E,!0),e-=E;const j=u.addPage([595.28,841.89]),W=m(j);return Q(W,"別表十六","減価償却資産の償却額の計算に関する明細書",r,n,i,s),e=r-100,ee(W,"当期償却実施額計",o.beppyo16.totalDepreciation,e,n,i,E),e-=E,ee(W,"償却限度額計",o.beppyo16.totalAllowable,e,n,i,E),e-=E,ee(W,"償却超過額",o.beppyo16.excessAmount,e,n,i,E,!0),e-=E,e-=20,W.rect(50,e-20,n-100,20,i.headerBg),W.text("資産名",60,e-15,{size:9,font:s}),W.text("取得価額",250,e-15,{size:9,font:s}),W.text("期末帳簿価額",380,e-15,{size:9,font:s}),e-=20,o.beppyo16.assets.forEach(h=>{W.line(50,e,n-50,e),W.text(h.name,60,e-15,{size:9}),W.currency(h.acquisitionCost,320,e-15,9),W.currency(h.bookValueEnd,450,e-15,9),e-=20}),u.save()}function he(o){const u=[];return typeof o.beppyo4.taxableIncome!="number"&&u.push("所得金額が数値ではありません"),o.beppyo1.corporateTaxAmount<0&&u.push("法人税額が負数です"),o.beppyo4.taxableIncome>999999999999&&u.push("所得金額が桁あふれしています(上限12桁)"),u}async function xe(o,u){var E,Y;const g=u.replace("_debug",""),s=u.includes("_debug");if(["beppyo1","beppyo4","beppyo5_1","beppyo5_2","beppyo15","beppyo16"].includes(g)){const{fillBeppyo1WithDigitBoxes:B,fillBeppyo4WithDigitBoxes:p,fillBeppyo5_1WithDigitBoxes:F,fillBeppyo5_2WithDigitBoxes:f,fillBeppyo15WithDigitBoxes:I,fillBeppyo16WithDigitBoxes:O,DEFAULT_CALIBRATION:j}=await ie(async()=>{const{fillBeppyo1WithDigitBoxes:D,fillBeppyo4WithDigitBoxes:L,fillBeppyo5_1WithDigitBoxes:H,fillBeppyo5_2WithDigitBoxes:K,fillBeppyo15WithDigitBoxes:te,fillBeppyo16WithDigitBoxes:q,DEFAULT_CALIBRATION:k}=await import("./pdfDigitBoxService-B8NyRDuh.js");return{fillBeppyo1WithDigitBoxes:D,fillBeppyo4WithDigitBoxes:L,fillBeppyo5_1WithDigitBoxes:H,fillBeppyo5_2WithDigitBoxes:K,fillBeppyo15WithDigitBoxes:te,fillBeppyo16WithDigitBoxes:q,DEFAULT_CALIBRATION:k}},__vite__mapDeps([0,1,2,3])),h={beppyo1:"/templates/beppyo1_official.pdf",beppyo4:"/templates/beppyo4_official.pdf",beppyo5_1:"/templates/beppyo5_1_official.pdf",beppyo5_2:"/templates/beppyo5_2_official.pdf",beppyo15:"/templates/beppyo15_official.pdf",beppyo16:"/templates/beppyo16_official.pdf"}[g],_=await fetch(`${h}?t=${Date.now()}`).then(D=>D.arrayBuffer()).then(D=>new Uint8Array(D)),w={globalShiftX:((E=o.calibration)==null?void 0:E.globalShiftX)||j.globalShiftX,globalShiftY:((Y=o.calibration)==null?void 0:Y.globalShiftY)||j.globalShiftY,digitCenterOffsetX:0,digitCenterOffsetY:0};let y;if(g==="beppyo1"?y=await B(_,o,w,s):g==="beppyo4"?y=await p(_,o,w,s):g==="beppyo5_1"?y=await F(_,o,w,s):g==="beppyo5_2"?y=await f(_,o,w,s):g==="beppyo15"?y=await I(_,o,w,s):g==="beppyo16"&&(y=await O(_,o,w,s)),y)return console.log(`[${g}] Digit-box filling complete:`,y.report),y.pdfBytes}const{fillAcroFormFields:m,hasAcroFormFields:d,formatTaxNumber:c}=await ie(async()=>{const{fillAcroFormFields:B,hasAcroFormFields:p,formatTaxNumber:F}=await import("./pdfFormFillerService-BHFsCl5O.js");return{fillAcroFormFields:B,hasAcroFormFields:p,formatTaxNumber:F}},[]),{fillByTextAnchors:n}=await ie(async()=>{const{fillByTextAnchors:B}=await import("./pdfAnchorDetector-CcGx4JeL.js");return{fillByTextAnchors:B}},__vite__mapDeps([4,1,2,3])),{getTemplateCoordinates:r,getFieldMappingsForTemplate:a}=await ie(async()=>{const{getTemplateCoordinates:B,getFieldMappingsForTemplate:p}=await import("./pdfTemplateRegistry-BehEEBCD.js");return{getTemplateCoordinates:B,getFieldMappingsForTemplate:p}},[]),t={timestamp:new Date().toISOString(),template:u,loadSuccess:!1,hasAcroForm:!1,passedDataValidation:!1,mappings:[],errors:[]},e=he(o);e.length>0?(t.errors.push(...e),console.warn("[PDF Validation] Pre-fill check failed:",e)):t.passedDataValidation=!0;const R={beppyo1:"/templates/beppyo1_official.pdf",beppyo4:"/templates/beppyo4_official.pdf",beppyo5_1:"/templates/beppyo5_1_official.pdf",beppyo5_2:"/templates/beppyo5_2_official.pdf",beppyo15:"/templates/beppyo15_official.pdf",beppyo16:"/templates/beppyo16_official.pdf"}[g];if(!R)throw new Error(`Unknown template type: ${g}`);const P=await fetch(`${R}?t=${Date.now()}`).then(B=>B.arrayBuffer()).then(B=>new Uint8Array(B));let T;try{T=await J.load(P,{ignoreEncryption:!0,throwOnInvalidObject:!1}),t.loadSuccess=!0}catch(B){if(g==="beppyo1"){const p=await fetch("/templates/beppyo1_official.pdf").then(F=>F.arrayBuffer());T=await J.load(new Uint8Array(p),{ignoreEncryption:!0,throwOnInvalidObject:!1}),t.loadSuccess=!0}else throw B}T.registerFontkit(le);const{regular:x}=await ne(T),G=T.getPages()[0];console.log(`
[PDF Filling] Starting 3-tier approach for ${g}`);let N=null;if(d(T)){if(console.log("[Tier 1] AcroForm fields detected, attempting to fill..."),t.hasAcroForm=!0,N=await m(T,o,g),N.success&&N.filledFields.length>0)return console.log(`[Tier 1] ✓ SUCCESS: Filled ${N.filledFields.length} fields via AcroForm`),t.mappings.push(...N.filledFields.map(B=>({key:B,value:"filled",method:"AcroForm"}))),T.save();console.log(`[Tier 1] ✗ FAILED: ${N.errors.join(", ")}`),t.errors.push(...N.errors)}else console.log("[Tier 1] No AcroForm fields found, skipping to Tier 2");console.log("[Tier 2] Attempting text anchor-based filling...");try{const B=await n(G,o,g,x);if(B.success&&B.filledFields.length>0)return console.log(`[Tier 2] ✓ SUCCESS: Filled ${B.filledFields.length} fields via anchors`),t.mappings.push(...B.filledFields.map(p=>({key:p,value:"filled",method:"Anchor"}))),T.save();console.log(`[Tier 2] ✗ FAILED: ${B.errors.join(", ")}`),t.errors.push(...B.errors)}catch(B){console.log(`[Tier 2] ✗ ERROR: ${B.message}`),t.errors.push(`Tier 2 error: ${B.message}`)}console.log("[Tier 3] Attempting fixed coordinate filling...");const S=r(g);if(S){const B=a(g,o);let p=0;for(const[F,f]of B.entries()){const I=S.fields.get(F);if(!I){t.errors.push(`No coordinates for field: ${F}`);continue}try{const O=typeof f=="number"?c(f):String(f),j=10;let W=I.x;if(I.align==="right"){const h=x.widthOfTextAtSize(O,j);W-=h}else if(I.align==="center"){const h=x.widthOfTextAtSize(O,j);W-=h/2}G.drawText(O,{x:W,y:I.y,size:j,font:x,color:l(0,0,.5)}),p++,t.mappings.push({key:F,value:f,method:"FixedCoord",coordinate:{x:I.x,y:I.y}}),console.log(`[Tier 3] ✓ Filled "${F}" = "${O}" at (${I.x}, ${I.y})`)}catch(O){t.errors.push(`Failed to fill ${F}: ${O.message}`)}}if(p>0)return console.log(`[Tier 3] ✓ SUCCESS: Filled ${p} fields via fixed coordinates`),T.save();console.log("[Tier 3] ✗ FAILED: No fields filled")}else console.log(`[Tier 3] ✗ No template coordinates found for ${g}`),t.errors.push(`No template coordinates for ${g}`);return console.error("[PDF Filling] All tiers failed!"),console.table(t.mappings),console.error("Errors:",t.errors),T.save()}async function Se(o){const u=await J.create();u.registerFontkit(le);const g=[{type:"beppyo1",name:"別表一"},{type:"beppyo4",name:"別表四"},{type:"beppyo5_1",name:"別表五一"},{type:"beppyo15",name:"別表十五"},{type:"beppyo16",name:"別表十六"}],s=[],i=[];for(const m of g)try{const d=await xe(o,m.type),c=await J.load(d),[n]=await u.copyPages(c,[0]);u.addPage(n),i.push(m.name)}catch(d){s.push(`${m.name}: ${d.message}`)}if(i.length===0)throw new Error(`公式テンプレートの読み込みにすべて失敗しました。
詳細:
${s.join(`
`)}`);return{pdfBytes:await u.save(),errors:s,successes:i}}function Q(o,u,g,s,i,m,d){o.rect(0,s-70,i,70,m.primary),o.text(u,50,s-45,{size:24,font:d,color:l(1,1,1)}),o.text(g,200,s-45,{size:12,color:l(.9,.9,1)})}function Z(o,u,g,s,i,m){o.rect(50,g-20,s-100,20,i.secondary),o.text(u,60,g-15,{size:10,font:m,color:l(1,1,1)})}function ee(o,u,g,s,i,m,d,c=!1){c&&o.rect(50,s-d,i-100,d,m.highlight),o.line(50,s-d,i-50,s-d),o.text(u,60,s-d+6,{size:10}),o.currency(g,i-60,s-d+6,10),o.line(50,s,50,s-d),o.line(i-50,s,i-50,s-d)}export{ze as a,Te as b,me as c,we as d,ve as e,Se as f,Be as g,xe as h};
