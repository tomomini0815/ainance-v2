import{c as se,r as o,j as e,L as re,F as y,P as D,T as ae}from"./index-9K-405_8.js";import{A as ie}from"./arrow-left-sDeMoclR.js";import{C as _,B as C}from"./calculator-BC2LNHSl.js";import{D as f}from"./download-CZ5zOA0_.js";import{P as ne}from"./pen-line-D82ecS7I.js";import{C as le}from"./calendar-CUy1vF5d.js";import{U as oe}from"./upload-Bci8jpA2.js";import{E as de}from"./eye-DJp6_7jp.js";import{S as ce}from"./send-QfPZQx6E.js";import{S as me}from"./share-2-D_Eneu1A.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],pe=se("printer",xe),ue=[{id:"1",title:"確定申告書",description:"年次確定申告書（個人事業主用）",deadline:"2024-03-15",required:!0,template_url:"/templates/individual/kakutei_shinkoku.pdf"},{id:"2",title:"青色申告決算書",description:"青色申告専用の決算書類",deadline:"2024-03-15",required:!0,template_url:"/templates/individual/seiroku_kessan.pdf"},{id:"3",title:"給与所得者の扶養控除等申告書",description:"従業員が提出する扶養控除申告書",deadline:"2024-01-31",required:!1,template_url:"/templates/individual/fuyou_koujo.pdf"}],Ce=()=>{const[T,he]=o.useState({_id:"1",business_type:"individual",company_name:"個人事業主"}),[S,l]=o.useState(ue.map(t=>({...t,status:"not_started",data_imported:!1,versions:[{id:"1",version:1,content:"初期バージョン",createdAt:new Date().toISOString(),createdBy:"ユーザー1"}],tags:[],comments:[]}))),[L,g]=o.useState(!1),[i,I]=o.useState(null),[u,O]=o.useState(""),[b,E]=o.useState("all"),[j,$]=o.useState("all"),[fe,ge]=o.useState(!1),A=Array.from(new Set(S.flatMap(t=>t.tags||[]))),v=(t,s)=>{l(r=>r.map(a=>a.id===t?{...a,status:s}:a))},B=t=>{l(s=>s.filter(r=>r.id!==t))},P=()=>{const t={id:Date.now().toString(),title:"新しい申告書類",description:"説明を入力してください",deadline:new Date().toISOString().split("T")[0],status:"not_started",required:!1,data_imported:!1,content:"",versions:[{id:"1",version:1,content:"初期バージョン",createdAt:new Date().toISOString(),createdBy:"ユーザー1"}],tags:[],comments:[]};l(s=>[t,...s])},[w,N]=o.useState(null),[c,m]=o.useState({}),F=t=>{N(t.id),m(t)},U=()=>{w&&c&&(l(t=>t.map(s=>s.id===w?{...s,...c}:s)),N(null),m({}))},M=[{id:1,title:"売上・経費の集計",description:"取引履歴から売上と経費を分類して集計します",icon:_},{id:2,title:"青色申告決算書の作成",description:"集計したデータをもとに決算書を作成します",icon:y},{id:3,title:"確定申告書の作成",description:"決算書のデータをもとに確定申告書を作成します",icon:C},{id:4,title:"電子申告または郵送",description:"e-Taxで電子申告するか、郵送で提出します",icon:f}],q=[{id:1,title:"第2会社の設立手続き",description:"新しい会社の設立登記と税務登記を行います",icon:D},{id:2,title:"取引の分離と記録",description:"第1会社と第2会社の取引を明確に分離して記録します",icon:_},{id:3,title:"各社の決算書作成",description:"各会社ごとに決算書を作成します",icon:y},{id:4,title:"法人税申告書の作成",description:"各会社の決算データをもとに法人税申告書を作成します",icon:C},{id:5,title:"電子申告または郵送",description:"e-Taxで電子申告するか、郵送で提出します",icon:f}],R=T.business_type==="individual"?M:q,H=t=>{const s=document.createElement("a");s.href=t.template_url||"#",s.download=`${t.title}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),v(t.id,"in_progress")},V=t=>{l(s=>s.map(r=>r.id===t?{...r,data_imported:!0}:r)),v(t,"in_progress")},z=t=>{v(t,"completed")},G=t=>{I(t),g(!0)},W=(t,s)=>{l(r=>r.map(a=>{if(a.id===t){const n={id:Date.now().toString(),content:s,createdAt:new Date().toISOString(),createdBy:"ユーザー1"};return{...a,comments:[...a.comments||[],n]}}return a}))},J=(t,s)=>{l(r=>r.map(a=>{if(a.id===t){const n=a.tags?[...a.tags,s]:[s];return{...a,tags:n}}return a}))},K=S.filter(t=>{const s=t.title.toLowerCase().includes(u.toLowerCase())||t.description.toLowerCase().includes(u.toLowerCase())||t.content&&t.content.toLowerCase().includes(u.toLowerCase()),r=b==="all"||t.status===b,a=j==="all"||t.tags&&t.tags.includes(j);return s&&r&&a}),Q=t=>{window.print()},X=t=>{navigator.share?navigator.share({title:t.title,text:t.description,url:window.location.href}).catch(s=>console.log("共有エラー:",s)):alert("このブラウザでは共有機能がサポートされていません")},Y=async()=>{try{alert("政府の公式ウェブサイトからテンプレートをダウンロードします。しばらくお待ちください...");const t="https://www.nta.go.jp/taxes/shiraberu/taxanswer/shotoku/1150.htm";try{const s=await fetch(t);if(!s.ok)throw new Error(`政府ウェブサイトからのダウンロードに失敗しました: ${s.status} ${s.statusText}`);const r=await s.text(),a=Z(r);if(a.length>0){const n=a[0],d=await fetch(n);if(!d.ok)throw new Error(`PDFのダウンロードに失敗しました: ${d.status} ${d.statusText}`);const x=await d.blob(),h=`政府テンプレート_${new Date().toISOString().split("T")[0]}.pdf`,k=URL.createObjectURL(x),p=document.createElement("a");p.href=k,p.download=h,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(k);const ee={id:Date.now().toString(),title:`政府テンプレート_${new Date().toISOString().split("T")[0]}`,description:"政府の公式ウェブサイトからダウンロードしたテンプレート",deadline:new Date().toISOString().split("T")[0],status:"not_started",required:!1,data_imported:!1,template_url:n,content:`政府ウェブサイトからダウンロードしたテンプレート: ${n}`,versions:[{id:"1",version:1,content:`初期バージョン: ${n}`,createdAt:new Date().toISOString(),createdBy:"政府ウェブサイト"}],tags:["政府","テンプレート"],comments:[]};l(te=>[ee,...te]),alert("政府の公式ウェブサイトからテンプレートをダウンロードしました")}else{alert("政府ウェブサイトからPDFリンクが見つかりませんでした。代替処理としてサンプルテンプレートを作成します。");const n={id:Date.now().toString(),title:`政府テンプレート_${new Date().toISOString().split("T")[0]}`,description:"政府ウェブサイトからダウンロードしたテンプレート（サンプル）",deadline:new Date().toISOString().split("T")[0],status:"not_started",required:!1,data_imported:!1,template_url:t,content:`これは政府ウェブサイトのテンプレートのサンプルです。実際のテンプレートは ${t} からダウンロードしてください。`,versions:[{id:"1",version:1,content:`これは政府ウェブサイトのテンプレートのサンプルです。実際のテンプレートは ${t} からダウンロードしてください。`,createdAt:new Date().toISOString(),createdBy:"政府ウェブサイト"}],tags:["政府","テンプレート","サンプル"],comments:[]};l(d=>[n,...d])}}catch(s){console.error("政府ウェブサイトからのテンプレートダウンロードエラー:",s),alert(`政府ウェブサイトからの直接ダウンロードに失敗しました。代替処理としてサンプルテンプレートを作成します。エラー: ${s instanceof Error?s.message:"不明なエラー"}`);const r={id:Date.now().toString(),title:`政府テンプレート_${new Date().toISOString().split("T")[0]}`,description:"政府ウェブサイトからダウンロードしたテンプレート（サンプル）",deadline:new Date().toISOString().split("T")[0],status:"not_started",required:!1,data_imported:!1,template_url:t,content:`これは政府ウェブサイトのテンプレートのサンプルです。実際のテンプレートは ${t} からダウンロードしてください。`,versions:[{id:"1",version:1,content:`これは政府ウェブサイトのテンプレートのサンプルです。実際のテンプレートは ${t} からダウンロードしてください。`,createdAt:new Date().toISOString(),createdBy:"政府ウェブサイト"}],tags:["政府","テンプレート","サンプル"],comments:[]};l(a=>[r,...a])}}catch(t){console.error("政府ウェブサイトからのテンプレートダウンロードエラー:",t),alert(`テンプレートのダウンロードに失敗しました: ${t instanceof Error?t.message:"不明なエラー"}`)}},Z=t=>{const s=[];return new DOMParser().parseFromString(t,"text/html").querySelectorAll('a[href$=".pdf"]').forEach(d=>{const x=d.getAttribute("href");if(x)try{const h=new URL(x,"https://www.nta.go.jp").href;s.push(h)}catch{console.warn("無効なPDFリンクをスキップしました:",x)}}),s};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(re,{to:"/dashboard",className:"flex items-center text-primary hover:text-primary/80 mb-4",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),"ダッシュボードに戻る"]}),e.jsx("h1",{className:"text-3xl font-bold text-text-main mb-2",children:"業態変換"}),e.jsx("p",{className:"text-text-muted",children:"個人事業主から法人（2社目）への変換手順をシミュレーションします"})]}),e.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-6 mb-8 border border-border",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-main mb-4",children:"変換手順"}),e.jsx("div",{className:"space-y-4",children:R.map(t=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(t.icon,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-medium text-text-main",children:t.title}),e.jsx("p",{className:"text-text-muted",children:t.description})]})]},t.id))})]}),e.jsxs("div",{className:"bg-surface rounded-lg shadow-md p-6 border border-border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-main",children:"必要な書類テンプレート"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:P,className:"flex items-center btn-primary",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"新しい書類"]}),e.jsxs("button",{onClick:Y,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"政府テンプレート"]})]})]}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"書類を検索...",className:"w-full px-4 py-2 bg-background border border-border rounded-md text-text-main focus:ring-2 focus:ring-primary focus:border-primary",value:u,onChange:t=>O(t.target.value)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{className:"px-4 py-2 bg-background border border-border rounded-md text-text-main focus:ring-2 focus:ring-primary focus:border-primary",value:b,onChange:t=>E(t.target.value),children:[e.jsx("option",{value:"all",children:"すべてのステータス"}),e.jsx("option",{value:"not_started",children:"未開始"}),e.jsx("option",{value:"in_progress",children:"進行中"}),e.jsx("option",{value:"completed",children:"完了"})]}),e.jsxs("select",{className:"px-4 py-2 bg-background border border-border rounded-md text-text-main focus:ring-2 focus:ring-primary focus:border-primary",value:j,onChange:t=>$(t.target.value),children:[e.jsx("option",{value:"all",children:"すべてのタグ"}),A.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:K.map(t=>{var s;return e.jsx("div",{className:"bg-surface border border-border rounded-lg p-4 hover:shadow-md transition-shadow",children:w===t.id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",className:"w-full px-3 py-2 bg-background border border-border rounded-md text-text-main focus:ring-2 focus:ring-primary focus:border-primary",value:c.title||"",onChange:r=>m({...c,title:r.target.value}),placeholder:"タイトル"}),e.jsx("textarea",{className:"w-full px-3 py-2 bg-background border border-border rounded-md text-text-main focus:ring-2 focus:ring-primary focus:border-primary",value:c.description||"",onChange:r=>m({...c,description:r.target.value}),placeholder:"説明",rows:2}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>{N(null),m({})},className:"px-3 py-1 text-text-muted hover:text-text-main",children:"キャンセル"}),e.jsx("button",{onClick:U,className:"px-3 py-1 bg-primary text-white rounded-md hover:bg-primary/90",children:"保存"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-lg font-medium text-text-main",children:t.title}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>F(t),className:"p-1 text-text-muted hover:text-primary",title:"編集",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(t.id),className:"p-1 text-text-muted hover:text-red-600",title:"削除",children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"text-text-muted text-sm mb-3",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[(s=t.tags)==null?void 0:s.map(r=>e.jsx("span",{className:"px-2 py-1 bg-primary/10 text-primary text-xs rounded-full",children:r},r)),e.jsx("button",{onClick:()=>{const r=prompt("新しいタグを入力してください:");r&&J(t.id,r)},className:"px-2 py-1 bg-surface-highlight text-text-main text-xs rounded-full hover:bg-border",children:"+"})]}),e.jsxs("div",{className:"flex items-center text-sm text-text-muted mb-3",children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:["期限: ",t.deadline]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="not_started"?"bg-surface-highlight text-text-muted":t.status==="in_progress"?"bg-yellow-500/10 text-yellow-600":"bg-green-500/10 text-green-600"}`,children:t.status==="not_started"?"未開始":t.status==="in_progress"?"進行中":"完了"}),t.data_imported&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-purple-500/10 text-purple-600 text-xs rounded-full",children:"データインポート済み"})]}),e.jsxs("div",{className:"flex space-x-1",children:[t.template_url&&e.jsx("button",{onClick:()=>H(t),className:"p-2 text-text-muted hover:text-primary",title:"テンプレートダウンロード",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>V(t.id),className:"p-2 text-text-muted hover:text-green-600",title:"データインポート",disabled:t.data_imported,children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>G(t),className:"p-2 text-text-muted hover:text-purple-600",title:"プレビュー",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{t.status==="completed"?alert("この書類はすでに提出されています"):z(t.id)},className:"p-2 text-text-muted hover:text-green-600",title:"提出",children:e.jsx(ce,{className:"h-4 w-4"})})]})]})]})},t.id)})})]})]}),L&&i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-surface rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden border border-border",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main",children:i.title}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>Q(),className:"p-2 text-text-muted hover:text-text-main",title:"印刷",children:e.jsx(pe,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>X(i),className:"p-2 text-text-muted hover:text-text-main",title:"共有",children:e.jsx(me,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>g(!1),className:"p-2 text-text-muted hover:text-text-main",title:"閉じる",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsxs("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-100px)] bg-surface",children:[i.content?e.jsx("div",{className:"prose max-w-none text-text-main",children:e.jsx("p",{children:i.content})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(y,{className:"h-12 w-12 text-text-muted mx-auto mb-4"}),e.jsx("p",{className:"text-text-muted",children:"プレビューするコンテンツがありません"}),e.jsx("p",{className:"text-text-muted text-sm mt-2",children:"データをインポートするか、コンテンツを追加してください"})]}),i.versions&&i.versions.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h4",{className:"text-md font-semibold text-text-main mb-3",children:"バージョン履歴"}),e.jsx("div",{className:"space-y-2",children:i.versions.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-surface-highlight rounded",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-text-main",children:["バージョン ",t.version]}),e.jsx("span",{className:"text-text-muted text-sm ml-2",children:new Date(t.createdAt).toLocaleString()})]}),e.jsx("span",{className:"text-text-muted text-sm",children:t.createdBy})]},t.id))})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h4",{className:"text-md font-semibold text-text-main mb-3",children:"コメント"}),i.comments&&i.comments.length>0?e.jsx("div",{className:"space-y-3",children:i.comments.map(t=>e.jsxs("div",{className:"p-3 bg-surface-highlight rounded",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-text-main",children:t.createdBy}),e.jsx("span",{className:"text-text-muted text-sm",children:new Date(t.createdAt).toLocaleString()})]}),e.jsx("p",{className:"mt-1 text-text-main",children:t.content})]},t.id))}):e.jsx("p",{className:"text-text-muted text-center py-4",children:"コメントはありません"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("textarea",{className:"w-full px-3 py-2 bg-background border border-border rounded-md text-text-main focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"コメントを追加...",rows:3}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{onClick:()=>{const t=document.querySelector('textarea[placeholder="コメントを追加..."]');t&&t.value.trim()!==""&&(W(i.id,t.value),t.value="")},className:"btn-primary",children:"コメントを追加"})})]})]})]}),e.jsx("div",{className:"flex justify-end p-4 border-t border-border",children:e.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-surface-highlight text-text-main rounded-md hover:bg-border",children:"閉じる"})})]})})]})};export{Ce as default};
