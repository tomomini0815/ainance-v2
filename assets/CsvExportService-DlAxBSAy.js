import{g as v,c as E}from"./CorporateTaxService-BzRMdiLF.js";const r={companyInfo:{corporateName:"",corporateNameKana:"",corporateNumber:"",postalCode:"",address:"",phoneNumber:"",representativeName:"",representativeNameKana:"",representativeAddress:"",businessType:"",taxOffice:"",fiscalYearStart:"",fiscalYearEnd:"",filingDate:"",capitalAmount:1e6,employeeCount:1,groupCompanyType:"single",blueFormApproval:!0},beppyo1:{taxableIncome:0,corporateTaxAmount:0,specialTaxCredit:0,nationalInterimPayment:0,nationalTaxPayable:0,localCorporateTaxAmount:0,localInterimPayment:0,localTaxPayable:0,prefecturalTax:0,municipalTax:0,inhabitantInterimPayment:0,inhabitantTaxPayable:0,enterpriseTax:0,specialLocalEnterpriseTax:0,enterpriseInterimPayment:0,enterpriseTaxPayable:0,totalTaxAmount:0,refundAmount:0},beppyo4:{netIncomeFromPL:0,nonDeductibleTaxes:0,nonDeductibleEntertainment:0,excessDepreciation:0,otherAdditions:[],deductibleEnterpriseTax:0,dividendExclusion:0,otherSubtractions:[],taxableIncome:0},beppyo5:{retainedEarningsItems:[{id:"1",description:"利益準備金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"2",description:"別途積立金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"3",description:"繰越利益剰余金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"4",description:"未払法人税等",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"5",description:"未払事業税",beginAmount:0,increase:0,decrease:0,endAmount:0}],retainedEarningsBegin:0,currentIncrease:0,currentDecrease:0,totalRetainedEarningsEnd:0,capitalBegin:1e6,capitalIncrease:0,capitalDecrease:0,capitalEnd:1e6},beppyo5_2:{items:[],totalPaid:0,taxesPayable:{corporate:0,inhabitant:0,enterprise:0,localCorporate:0}},beppyo16:{assets:[],totalDepreciation:0,totalAllowable:0,excessAmount:0},beppyo15:{totalEntertainmentExpenses:0,foodAndDrinkExpenses:0,otherEntertainmentExpenses:0,capitalAmount:1e6,deductionLimit:8e6,excessAmount:0},beppyo2:{shareholders:[],totalShares:100,isFamilyCompany:!0},businessOverview:{sales:0,costOfSales:0,grossProfit:0,operatingExpenses:0,operatingIncome:0,ordinaryIncome:0,netIncome:0,directorsCompensation:0,employeesSalary:0,rent:0,taxesAndDues:0,entertainmentExpenses:0,depreciation:0},calibration:{globalShiftX:0,globalShiftY:0}},d="ainance_corporate_tax_input_data",D={saveData:t=>{try{localStorage.setItem(d,JSON.stringify(t))}catch(n){console.error("Failed to save corporate tax input data:",n)}},getData:()=>{try{const t=localStorage.getItem(d);if(t){const n=JSON.parse(t);return{...r,...n,companyInfo:{...r.companyInfo,...n.companyInfo||{}},beppyo1:{...r.beppyo1,...n.beppyo1||{}},beppyo4:{...r.beppyo4,...n.beppyo4||{}},beppyo5:{...r.beppyo5,...n.beppyo5||{}},beppyo5_2:{...r.beppyo5_2,...n.beppyo5_2||{}},beppyo16:{...r.beppyo16,...n.beppyo16||{}},beppyo15:{...r.beppyo15,...n.beppyo15||{}},beppyo2:{...r.beppyo2,...n.beppyo2||{}},businessOverview:{...r.businessOverview,...n.businessOverview||{}},calibration:{...r.calibration,...n.calibration||{}}}}}catch(t){console.error("Failed to load corporate tax input data:",t)}return r},resetData:()=>{localStorage.removeItem(d)},calculateDataFromTransactions:(t,n)=>{const p=new Date().getFullYear()-1,s=v(t,p),m=D.getData(),o=(n==null?void 0:n.capital)||m.companyInfo.capitalAmount||1e6,e=E(s,{...m.companyInfo,...n,capital:o}),a=i=>{var c;return((c=s.expensesByCategory.find(S=>S.category.includes(i)))==null?void 0:c.amount)||0},h=a("役員報酬"),T=a("地代家賃"),x=a("租税公課"),u=a("交際費")+a("接待交際費"),f=a("減価償却費"),A=a("給料")+a("人件費"),y=a("飲食"),g=Math.max(0,(u||0)-8e6),b=t.filter(i=>{var c;return((c=i.tags)==null?void 0:c.includes("depreciation_asset"))&&new Date(i.date).getFullYear()===p}).map(i=>{var c;return{id:i.id,name:((c=i.description)==null?void 0:c.split(" ")[0])||"固定資産",acquisitionDate:i.date,acquisitionCost:Math.abs(Number(i.amount)||0),usefulLife:5,depreciationMethod:"straightLine",currentDepreciation:Math.abs(Number(i.amount)||0)/5,allowableLimit:Math.abs(Number(i.amount)||0)/5,bookValueEnd:Math.abs(Number(i.amount)||0)*.8}});return{businessOverview:{sales:s.revenue||0,costOfSales:s.costOfSales||0,grossProfit:s.grossProfit||0,operatingExpenses:s.operatingExpenses||0,operatingIncome:s.operatingIncome||0,ordinaryIncome:s.ordinaryIncome||0,netIncome:s.incomeBeforeTax||0,directorsCompensation:h,employeesSalary:A,rent:T,taxesAndDues:x,entertainmentExpenses:u,depreciation:f},beppyo1:{...r.beppyo1,taxableIncome:Math.max(0,e.taxableIncome||0),corporateTaxAmount:Math.max(0,e.corporateTax||0),localCorporateTaxAmount:Math.max(0,e.localCorporateTax||0),prefecturalTax:Math.max(0,e.prefecturalTax||0),municipalTax:Math.max(0,e.municipalTax||0),enterpriseTax:Math.max(0,e.businessTax||0),totalTaxAmount:Math.max(0,e.totalTax||0),nationalTaxPayable:Math.max(0,e.corporateTax||0),localTaxPayable:Math.max(0,e.localCorporateTax||0),inhabitantTaxPayable:Math.max(0,(e.prefecturalTax||0)+(e.municipalTax||0)),enterpriseTaxPayable:Math.max(0,e.businessTax||0)},beppyo4:{...r.beppyo4,netIncomeFromPL:s.incomeBeforeTax||0,nonDeductibleTaxes:x||0,nonDeductibleEntertainment:g||0,taxableIncome:Math.max(0,e.taxableIncome||0)},beppyo15:{...r.beppyo15,totalEntertainmentExpenses:u||0,foodAndDrinkExpenses:y||0,otherEntertainmentExpenses:(u||0)-(y||0),capitalAmount:o,excessAmount:g||0},beppyo16:{...r.beppyo16,assets:b.length>0?b:r.beppyo16.assets,totalDepreciation:b.reduce((i,c)=>i+(c.currentDepreciation||0),0),totalAllowable:b.reduce((i,c)=>i+(c.allowableLimit||0),0)}}}},C={generateFinancialStatementCSV:t=>{const n=a=>"businessOverview"in a;let l="",p=0,s=0,m=0;n(t)?(l="",p=new Date().getFullYear()-1,s=t.businessOverview.sales,m=t.businessOverview.operatingExpenses+t.businessOverview.costOfSales):(l=t.companyName||"",p=t.fiscalYear,s=t.revenue,m=t.expenses);const o=[];o.push(["識別番号","会社名","年度","帳票区分","科目名","金額","貸借区分"]);const e=["",l,`${p}年度`];if(o.push([...e,"損益計算書","売上高",String(s),"貸方"]),n(t)){const a=t.businessOverview;o.push([...e,"損益計算書","売上原価",String(a.costOfSales),"借方"]),o.push([...e,"損益計算書","販売費及び一般管理費計",String(a.operatingExpenses),"借方"]),o.push([...e,"損益計算書","　役員報酬",String(a.directorsCompensation),"借方"]),o.push([...e,"損益計算書","　給料賃金",String(a.employeesSalary),"借方"]),o.push([...e,"損益計算書","　地代家賃",String(a.rent),"借方"]),o.push([...e,"損益計算書","　租税公課",String(a.taxesAndDues),"借方"]),o.push([...e,"損益計算書","　交際費",String(a.entertainmentExpenses),"借方"]),o.push([...e,"損益計算書","　減価償却費",String(a.depreciation),"借方"]),o.push([...e,"損益計算書","営業利益",String(a.operatingIncome),"貸方"]),o.push([...e,"損益計算書","経常利益",String(a.ordinaryIncome),"貸方"]),o.push([...e,"損益計算書","税引前当期純利益",String(a.netIncome),"貸方"])}else o.push([...e,"損益計算書","費用合計",String(m),"借方"]),t.expensesByCategory.forEach(a=>{o.push([...e,"損益計算書",`　${a.category}`,String(a.amount),"借方"])}),o.push([...e,"損益計算書","当期純利益",String(t.netIncome),"貸方"]);return o.map(a=>a.join(",")).join(`\r
`)},downloadCSV:(t,n)=>{const l=new Blob([new Uint8Array([239,187,191]),t],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a");if(p.download!==void 0){const s=URL.createObjectURL(l);p.setAttribute("href",s),p.setAttribute("download",n),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)}}};export{D as C,C as a,r as i};
