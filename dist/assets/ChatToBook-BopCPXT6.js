import{c as Q,r as d,b as de,k as xe,d as me,u as pe,j as e,L as ue,h as z}from"./index-Y298rBAR.js";import{A as he}from"./arrow-left-BWVW-fKy.js";import{S as ge}from"./square-ecdLZ_G4.js";import{S as fe}from"./send-CvNSD-I6.js";import{C as P}from"./circle-check-big-CrIPLrmM.js";import{S as ye}from"./save-COR-D8h_.js";import{P as be}from"./pen-line-Cg_WzQ_K.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],G=Q("circle",we);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],ve=Q("mic",je),Ie=()=>{const[E,D]=d.useState(!1),[N,_]=d.useState(""),[b,w]=d.useState([]),[y,M]=d.useState(null),[x,C]=d.useState({}),[A,O]=d.useState(!1),[m,S]=d.useState([]),[Ne,ke]=d.useState([]),[R,L]=d.useState(null),[U,I]=d.useState(null),k=d.useRef(null),{user:l}=de(),{currentBusinessType:u}=xe(l==null?void 0:l.id),{transactions:j,createTransaction:q,updateTransaction:V,deleteTransaction:H,approveTransaction:J,fetchTransactions:h}=me(l==null?void 0:l.id,u==null?void 0:u.business_type),F=pe();d.useEffect(()=>{if(!("webkitSpeechRecognition"in window)){console.log("Web Speech API is not supported in this browser."),I("音声認識がこのブラウザでサポートされていません。ChromeまたはEdgeをご使用ください。");return}const t=new window.webkitSpeechRecognition;return t.continuous=!0,t.interimResults=!0,t.lang="ja-JP",t.onresult=r=>{let s="";for(let o=r.resultIndex;o<r.results.length;o++){const n=r.results[o][0].transcript;r.results[o].isFinal&&(s+=n+" ")}s&&_(o=>o+s)},t.onerror=r=>{console.error("音声認識エラー:",r.error),D(!1),I(null);let s="音声認識中にエラーが発生しました。";switch(r.error){case"no-speech":s="音声が検出されませんでした。もう一度お試しください。";break;case"audio-capture":s="音声入力デバイスが見つかりません。";break;case"not-allowed":s="音声認識の使用が許可されていません。ブラウザの設定をご確認ください。";break;case"service-not-allowed":s="音声認識サービスの使用が許可されていません。";break;case"bad-grammar":s="音声認識中に文法エラーが発生しました。";break;case"language-not-supported":s="指定された言語はサポートされていません。";break}I(s)},t.onend=()=>{D(!1)},k.current=t,()=>{k.current&&k.current.stop()}},[]),d.useEffect(()=>{console.log("ChatToBook - DBから取引データを取得中",{dbTransactionsCount:j.length,dbTransactionIds:j.map(t=>t.id)}),w(t=>{const r=j.map(i=>i.id),s=t.filter(i=>!r.includes(i.id)),o=[...j.map(i=>({id:i.id,date:i.date,description:i.description||i.item||"",amount:i.amount,category:i.category,type:i.type,created_at:i.created_at,updated_at:i.updated_at,approval_status:i.approval_status})),...s],n=o.filter((i,g,f)=>g===f.findIndex($=>$.id===i.id));return console.log("ChatToBook - 合成された取引データ:",{mergedCount:o.length,uniqueCount:n.length,dbTransactionIds:r,localTempDataCount:s.length}),n})},[j]),d.useEffect(()=>{const t=async()=>{console.log("ChatToBook - transactionRecordedイベントを受信"),u!=null&&u.id&&(await new Promise(r=>setTimeout(r,100)),h())};return window.addEventListener("transactionRecorded",t),()=>{window.removeEventListener("transactionRecorded",t)}},[u,h]),d.useEffect(()=>{const t=async()=>{console.log("ChatToBook - transactionApprovedイベントを受信"),u!=null&&u.id&&(await new Promise(r=>setTimeout(r,100)),h())};return window.addEventListener("transactionApproved",t),()=>{window.removeEventListener("transactionApproved",t)}},[u,h]);const X=()=>{k.current&&(I(null),k.current.start(),D(!0))},Y=()=>{k.current&&(k.current.stop(),D(!1))},Z=t=>{console.log("extractTransactionData - text:",t);const r=/(\d+(?:万)?(?:千)?(?:円)?)/g,s=t.match(r),o=[{keywords:["売上"],category:"業務委託収入",type:"income",priority:10},{keywords:["給与"],category:"給与",type:"income",priority:9},{keywords:["消耗品","文具","コピー","オフィス用品"],category:"消耗品費",type:"expense",priority:10},{keywords:["接待","会食","食事","ディナー","ランチ"],category:"接待交際費",type:"expense",priority:9},{keywords:["交通費","電車","バス","タクシー"],category:"旅費交通費",type:"expense",priority:7},{keywords:["食費","ランチ","ディナー","コーヒー"],category:"食費",type:"expense",priority:6},{keywords:["通信費","電話料金"],category:"通信費",type:"expense",priority:5},{keywords:["光熱費","電気","ガス","水道"],category:"水道光熱費",type:"expense",priority:5},{keywords:["修繕","修理"],category:"修繕費",type:"expense",priority:4},{keywords:["保険"],category:"保険料",type:"expense",priority:4},{keywords:["手数料"],category:"支払手数料",type:"expense",priority:4},{keywords:["新聞","図書"],category:"新聞図書費",type:"expense",priority:3},{keywords:["外注"],category:"外注費",type:"expense",priority:3},{keywords:["税金"],category:"租税公課",type:"expense",priority:3},{keywords:["広告","宣伝"],category:"広告宣伝費",type:"expense",priority:2},{keywords:["地代","家賃"],category:"地代家賃",type:"expense",priority:2},{keywords:["費用","費"],category:"雑費",type:"expense",priority:1}];let n="雑費",i="expense",g=0;for(const p of o)for(const v of p.keywords)t.includes(v)&&p.priority>g&&(n=p.category,i=p.type,g=p.priority);let f=0;if(s&&s.length>0){const p=s[0];if(p.includes("万")){const v=parseFloat(p.replace("万",""));f=isNaN(v)?0:v*1e4}else if(p.includes("千")){const v=parseFloat(p.replace("千",""));f=isNaN(v)?0:v*1e3}else f=parseFloat(p.replace(/[^\d]/g,""))||0}return{date:new Date().toISOString().split("T")[0],description:t,amount:f,category:n,type:i}},ee=()=>{N.trim()&&(console.log("processTranscript - transcript:",N),O(!0),setTimeout(()=>{const t=Z(N),s={id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const n=Math.random()*16|0;return(o=="x"?n:n&3|8).toString(16)}),...t,category:R||t.category};w(o=>[s,...o]),_(""),L(null),O(!1)},1e3))},te=t=>{M(t.id),C(t)},se=async()=>{if(y&&x)try{const t=await V(y,{date:x.date||"",item:x.description!==void 0?x.description:"",amount:x.amount||0,category:x.category||"未分類",type:x.type||"expense"});if(t.error)throw t.error;w(r=>r.map(s=>s.id===y?{...s,...x}:s)),await h(),console.log("handleSave - dbTransactions:",j),w(r=>{const s=[...r],o=s.findIndex(n=>n.id===y);if(o!==-1){const n=j.find(i=>i.id===y);n&&(s[o]={...s[o],...n})}return s}),M(null),C({})}catch(t){console.error("取引の更新に失敗しました:",t),alert("取引の更新に失敗しました: "+t.message)}},re=async t=>{try{const r=await H(t);if(r.error)throw r.error;w(s=>s.filter(o=>o.id!==t)),S(s=>s.filter(o=>o!==t))}catch(r){console.error("取引の削除に失敗しました:",r),alert("取引の削除に失敗しました: "+r.message)}},ae=async t=>{try{if(console.log("recordTransaction - 開始:",t),!(l!=null&&l.id)){alert("ユーザーが認証されていません。ログインしてください。"),console.error("ユーザーが認証されていません。userオブジェクト:",l);return}console.log("認証されたユーザーID:",l.id),console.log("DBから最新の取引データを取得中..."),await h();const r=j;console.log("DBから取得した最新の取引データ:",r);const s=t.id&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t.id)&&r.some(o=>o.id===t.id);if(console.log("既存の取引かどうか:",{isExistingTransaction:s,transactionId:t.id,dbTransactionsCount:r.length,dbTransactionIds:r.map(o=>o.id)}),s){console.log("既存取引の承認処理を開始");const o=await J(t.id);if(console.log("承認処理結果:",o),o.error)throw o.error;w(n=>n.map(i=>i.id===t.id?{...i,approval_status:"approved"}:i)),console.log("transactionApprovedイベントを発火"),window.dispatchEvent(new CustomEvent("transactionApproved")),console.log("recordTransaction - 取引を承認しました"),alert("取引が正常に承認されました"),await h(),console.log("recordTransaction - データ再取得完了"),window.dispatchEvent(new CustomEvent("transactionRecorded"))}else{console.log("新規取引作成処理を開始");const o=t.description.replace(/(\d+(?:万)?(?:千)?(?:円)?)/g,"").trim(),n=await q({item:o,amount:t.amount,date:t.date,category:t.category,type:t.type,creator:l.id,approval_status:"approved"});if(console.log("新規取引作成結果:",n),n.error)throw n.error;w(i=>i.filter(g=>g.id!==t.id)),console.log("recordTransaction - 新規取引を作成しました"),alert("取引が正常に作成されました"),await h(),console.log("recordTransaction - データ再取得完了"),window.dispatchEvent(new CustomEvent("transactionRecorded"))}}catch(r){if(console.error("取引の記録に失敗しました:",r),r.message.includes("認証セッションが切れました")){alert("認証セッションが切れました。ログインページにリダイレクトします。"),F("/login");return}alert("取引の記録に失敗しました: "+r.message)}},oe=async()=>{if(!(l!=null&&l.id)){alert("ユーザーが認証されていません。ログインしてください。"),console.error("ユーザーが認証されていません。userオブジェクト:",l);return}console.log("認証されたユーザーID:",l.id),console.log("DBから最新の取引データを取得中..."),await h();const t=j;console.log("DBから取得した最新の取引データ:",t);const r=b.filter(s=>m.includes(s.id));if(console.log("bulkRecordTransactions - 選択された取引:",r),console.log("bulkRecordTransactions - 現在のDB取引データ:",t),r.length===0){alert("記録する取引を選択してください");return}try{const s=r.filter(a=>a.id&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a.id)&&t.some(c=>c.id===a.id)),o=r.filter(a=>!a.id||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a.id)||!t.some(c=>c.id===a.id));console.log("取引分類結果:",{existingCount:s.length,newCount:o.length,existingTransactions:s.map(a=>({id:a.id,item:a.description})),newTransactions:o.map(a=>({id:a.id,item:a.description})),dbTransactionsCount:t.length,dbTransactionIds:t.map(a=>a.id)});const n=s.map(a=>(console.log("承認処理を実行:",a.id),J(a.id))),i=o.map(a=>{console.log("新規作成処理を実行:",a.id);const c=a.description.replace(/(\d+(?:万)?(?:千)?(?:円)?)/g,"").trim();return q({item:c,amount:a.amount,date:a.date,category:a.category,type:a.type,creator:l.id,approval_status:"approved"})}),g=await Promise.allSettled(n),f=await Promise.allSettled(i);console.log("bulkRecordTransactions - 承認結果:",g),console.log("bulkRecordTransactions - 作成結果:",f);const $=g.filter(a=>a.status==="fulfilled").length,p=f.filter(a=>a.status==="fulfilled").length,v=g.filter(a=>a.status==="rejected").length,ce=f.filter(a=>a.status==="rejected").length,K=$+p,W=v+ce;g.forEach((a,c)=>{if(a.status==="rejected"&&(console.error(`取引承認失敗 (${c+1}):`,a.reason),a.reason.message.includes("認証セッションが切れました"))){alert("認証セッションが切れました。ログインページにリダイレクトします。"),F("/login");return}}),f.forEach((a,c)=>{if(a.status==="rejected"&&(console.error(`新規取引作成失敗 (${c+1}):`,a.reason),a.reason.message.includes("認証セッションが切れました"))){alert("認証セッションが切れました。ログインページにリダイレクトします。"),F("/login");return}}),W>0?alert(`${K}件の取引が正常に記録されましたが、${W}件の取引の記録に失敗しました。詳細はコンソールを確認してください。`):alert(`${K}件の取引が正常に記録されました`),w(a=>{const c=[...a];for(let T=0;T<c.length;T++)s.some(B=>B.id===c[T].id)&&(c[T]={...c[T],approval_status:"approved"});return c.filter(T=>!o.some(B=>B.id===T.id))}),S([]),await h(),console.log("bulkRecordTransactions - データ再取得完了"),window.dispatchEvent(new CustomEvent("transactionRecorded")),window.dispatchEvent(new CustomEvent("transactionApproved"))}catch(s){console.error("取引の一括記録中にエラーが発生しました:",s),alert("取引の一括記録に失敗しました: "+s.message)}},ne=async()=>{if(m.length===0){alert("削除する取引を選択してください");return}if(window.confirm(`${m.length}件の取引を削除してもよろしいですか？`))try{const t=m.map(n=>H(n)),r=await Promise.allSettled(t),s=r.filter(n=>n.status==="fulfilled").length,o=r.filter(n=>n.status==="rejected").length;r.forEach((n,i)=>{n.status==="rejected"&&console.error(`取引削除失敗 (${i+1}):`,n.reason)}),o>0?alert(`${s}件の取引が正常に削除されましたが、${o}件の取引の削除に失敗しました。詳細はコンソールを確認してください。`):alert(`${s}件の取引が正常に削除されました`),w(n=>n.filter(i=>!m.includes(i.id))),S([]),await h()}catch(t){console.error("取引の一括削除中にエラーが発生しました:",t),alert("取引の一括削除に失敗しました: "+t.message)}},ie=t=>{S(r=>r.includes(t)?r.filter(s=>s!==t):[...r,t])},le=()=>{m.length===b.length&&b.length>0?S([]):S(b.map(t=>t.id))};return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(ue,{to:"/dashboard",className:"mr-4",children:e.jsx(he,{className:"w-6 h-6 text-text-muted hover:text-text-main"})}),e.jsx("h1",{className:"text-2xl font-bold text-text-main",children:"CHAT-TO-BOOK"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-surface rounded-xl shadow-sm border border-border p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-main mb-4",children:"音声入力"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("button",{onClick:E?Y:X,className:`flex items-center justify-center w-16 h-16 rounded-full ${E?"bg-red-500 hover:bg-red-600 animate-pulse":"bg-primary hover:bg-primary/90"} text-white transition-colors shadow-lg shadow-primary/25`,children:E?e.jsx(ge,{className:"w-8 h-8"}):e.jsx(ve,{className:"w-8 h-8"})})}),U&&e.jsx("div",{className:"text-center mb-4",children:e.jsx("p",{className:"text-sm text-red-500",children:U})}),e.jsx("div",{className:"text-center mb-4",children:e.jsx("p",{className:"text-sm text-text-muted",children:E?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("span",{className:"flex h-3 w-3 mr-2",children:[e.jsx("span",{className:"animate-ping absolute h-3 w-3 rounded-full bg-red-400 opacity-75"}),e.jsx("span",{className:"relative h-3 w-3 rounded-full bg-red-500"})]}),"音声認識中... 話してください"]}):"マイクボタンをクリックして開始"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-text-muted mb-2",children:"認識テキスト"}),e.jsx("textarea",{value:N,onChange:t=>_(t.target.value),rows:4,className:"w-full px-3 py-2 bg-background border border-border rounded-md text-text-main focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"音声認識されたテキストがここに表示されます..."}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[["売上","給与","交通費","食費","消耗品費","接待交際費","通信費","水道光熱費","雑費","未分類"].map(t=>e.jsx("button",{onClick:()=>L(R===t?null:t),className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border transition-colors ${R===t?"bg-primary/20 border-primary text-primary":"bg-surface-highlight text-text-main border-border hover:bg-surface-hover"}`,children:t},t)),R&&e.jsx("button",{onClick:()=>L(null),className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-surface-highlight text-text-muted border border-border hover:bg-surface-hover transition-colors",children:"クリア"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>_(""),disabled:!N.trim(),className:`px-4 py-2 rounded-md transition-colors ${N.trim()?"bg-gray-500 text-white hover:bg-gray-600":"bg-surface-highlight text-text-muted cursor-not-allowed"}`,children:"クリア"}),e.jsx("button",{onClick:ee,disabled:!N.trim()||A,className:`flex items-center px-4 py-2 rounded-md transition-colors ${!N.trim()||A?"bg-surface-highlight text-text-muted cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"処理中..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"取引に変換"]})})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl shadow-sm border border-border p-4",children:[e.jsx("h2",{className:"text-md font-semibold text-text-main mb-3",children:"使い方"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"border border-border rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-primary/10 rounded-full flex items-center justify-center mr-2 flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-xs",children:"1"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-main text-sm mb-1",children:"音声入力開始"}),e.jsx("p",{className:"text-xs text-text-muted",children:"マイクボタンをクリックして、取引内容を話してください。"})]})]})}),e.jsx("div",{className:"border border-border rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-primary/10 rounded-full flex items-center justify-center mr-2 flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-xs",children:"2"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-main text-sm mb-1",children:"テキスト確認"}),e.jsx("p",{className:"text-xs text-text-muted",children:"認識されたテキストを確認・編集してください。"})]})]})}),e.jsx("div",{className:"border border-border rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-primary/10 rounded-full flex items-center justify-center mr-2 flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-xs",children:"3"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-main text-sm mb-1",children:"取引に変換"}),e.jsx("p",{className:"text-xs text-text-muted",children:"「取引に変換」ボタンをクリックして、取引を登録してください。"})]})]})})]})]})]}),e.jsxs("div",{className:"bg-surface rounded-xl shadow-sm border border-border p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-text-main mb-4",children:"取引一覧"}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("p",{className:"text-sm text-text-muted",children:[b.length,"件の取引"]}),m.length>0&&e.jsxs("span",{className:"text-sm text-primary",children:[m.length,"件選択中"]})]}),e.jsx("div",{className:"flex space-x-2",children:m.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:ne,className:"flex items-center px-3 py-1 bg-red-500 text-white rounded-md text-sm hover:bg-red-600 transition-colors",children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),"一括削除 (",m.length,")"]}),e.jsxs("button",{onClick:oe,className:"flex items-center px-3 py-1 bg-green-600 text-white rounded-md text-sm hover:bg-green-700 transition-colors",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),"一括承認 (",m.length,")"]})]})})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surface-highlight",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:e.jsx("button",{onClick:le,className:"flex items-center",children:m.length===b.length&&b.length>0?e.jsx(P,{className:"w-4 h-4 text-primary"}):e.jsx(G,{className:"w-4 h-4 text-text-muted"})})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"日付"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"説明"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"金額"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"カテゴリ"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-text-muted uppercase tracking-wider",children:"操作"})]})}),e.jsx("tbody",{className:"bg-surface divide-y divide-border",children:b.map(t=>e.jsxs("tr",{className:"hover:bg-surface-highlight transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("button",{onClick:()=>ie(t.id),className:"flex items-center",disabled:t.approval_status==="approved",children:m.includes(t.id)?e.jsx(P,{className:"w-5 h-5 text-primary"}):e.jsx(G,{className:"w-5 h-5 text-text-muted"})})}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-main",children:y===t.id?e.jsx("input",{type:"date",value:x.date||t.date,onChange:r=>C(s=>({...s,date:r.target.value})),className:"w-full px-2 py-1 bg-background border border-border rounded text-sm text-text-main"}):t.date}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-main max-w-xs",children:y===t.id?e.jsx("input",{type:"text",value:x.description!==void 0?x.description:t.description,onChange:r=>C(s=>({...s,description:r.target.value})),className:"w-full px-2 py-1 bg-background border border-border rounded text-sm text-text-main"}):t.description}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-main",children:y===t.id?e.jsx("input",{type:"number",value:x.amount||t.amount,onChange:r=>C(s=>({...s,amount:Number(r.target.value)})),className:"w-full px-2 py-1 bg-background border border-border rounded text-sm text-text-main"}):e.jsxs("span",{className:t.type==="income"?"text-green-500":"text-red-500",children:[t.type==="income"?"+":"-","¥",t.amount.toLocaleString()]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-text-main",children:y===t.id?e.jsxs("select",{value:x.category||t.category,onChange:r=>C(s=>({...s,category:r.target.value})),className:"w-full px-2 py-1 bg-background border border-border rounded text-sm text-text-main",children:[e.jsx("option",{value:"売上",children:"売上"}),e.jsx("option",{value:"給与",children:"給与"}),e.jsx("option",{value:"交通費",children:"交通費"}),e.jsx("option",{value:"食費",children:"食費"}),e.jsx("option",{value:"消耗品費",children:"消耗品費"}),e.jsx("option",{value:"接待交際費",children:"接待交際費"}),e.jsx("option",{value:"通信費",children:"通信費"}),e.jsx("option",{value:"水道光熱費",children:"水道光熱費"}),e.jsx("option",{value:"雑費",children:"雑費"}),e.jsx("option",{value:"未分類",children:"未分類"})]}):t.category}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:y===t.id?e.jsx("button",{onClick:se,className:"text-green-500 hover:text-green-600 mr-2",children:e.jsx(ye,{className:"w-4 h-4"})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>ae(t),className:`mr-2 ${t.approval_status==="approved"?"text-gray-400 cursor-not-allowed":"text-green-500 hover:text-green-600"}`,disabled:t.approval_status==="approved",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>te(t),className:`mr-2 ${t.approval_status==="approved"?"text-gray-400 cursor-not-allowed":"text-primary hover:text-primary/80"}`,disabled:t.approval_status==="approved",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>re(t.id),className:t.approval_status==="approved"?"text-gray-400 cursor-not-allowed":"text-red-500 hover:text-red-600",disabled:t.approval_status==="approved",children:e.jsx(z,{className:"w-4 h-4"})})]})})]},t.id))})]}),b.filter(t=>t.approval_status!=="approved").length===0&&e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx("p",{children:"まだ取引がありません"}),e.jsx("p",{className:"text-sm mt-2",children:"音声入力で取引を追加してください"})]})]})]})]})})};export{Ie as default};
