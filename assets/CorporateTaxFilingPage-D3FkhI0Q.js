import{c as oe,a as pe,e as he,l as ue,u as be,r as u,n as je,j as e,L as E,F as P,G as g,p as fe,x as A,d as Ne,U as W}from"./index-Dp8kLXFF.js";import{P as ge,y as V}from"./PreviousYearImportModal-DlxkiOAO.js";import{y as ye}from"./yearlyBalanceSheetService-DGDZUcFr.js";import{g as ve,c as we,a as Ce,f as n,b as _e,e as Te}from"./CorporateTaxService-8ijqz51P.js";import{a as B,C as z,i as U}from"./CsvExportService-Drs7-n6I.js";import{D as ke}from"./DepreciationCalculator-D1Keq8T-.js";import{c as Ee,d as Se}from"./pdfJapaneseService-BLYmZtyK.js";import{W as Pe}from"./WizardProgress-D8zwgESq.js";import{A as q}from"./arrow-left-CvQkh7k3.js";import{B as $}from"./building-2-CVzLLuNe.js";import{B as G}from"./book-open-BZ1gPses.js";import{C as Ie}from"./calculator-CPGCmKU4.js";import{W as Fe}from"./wallet-C0KEvdIH.js";import{D as S}from"./download-r4GQeVQg.js";import{A as F}from"./arrow-right-CzxN8cLw.js";import{C as O}from"./circle-check-big-BY7tKmj7.js";import{R as T}from"./refresh-cw-Bjd82xU4.js";import{W as Oe}from"./wrench-1Ej6gCQe.js";import{I as H}from"./info-D5q4zrEh.js";import{C as Ae}from"./copy-BRzLxri2.js";import"./geminiAIService-DQoIspWT.js";import"./loader-circle-DrUCx8Vg.js";import"./save-fFq-WGpv.js";import"./circle-question-mark-D3kTiSec.js";import"./pdfAutoFillService-C6llV050.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],Me=oe("piggy-bank",$e),I=[{id:1,title:"会社情報",icon:$,description:"会社基本情報の入力"},{id:2,title:"減価償却",icon:Ie,description:"資産の登録と計算"},{id:3,title:"損益計算",icon:P,description:"売上・経費の確認"},{id:4,title:"法人税計算",icon:Me,description:"法人税等の計算"},{id:5,title:"消費税確認",icon:Fe,description:"消費税の確認"},{id:6,title:"書類作成",icon:S,description:"PDF出力"}],De=({corporateInfo:s,setCorporateInfo:r,handleInfoChange:a,handleTranscribe:d,prevYearSettlement:p,prevYearBS:b,setIsImportModalOpen:N})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-surface border border-border rounded-xl p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(W,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-text-main mb-1",children:"前期データの引き継ぎ"}),e.jsx("p",{className:"text-sm text-text-muted mb-4",children:"前期の決算データを取り込むことで、今期の収支比較やBSの期首残高設定がスムーズに行えます。"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[p?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-success font-medium",children:[e.jsx(O,{className:"w-4 h-4"}),p.year,"年度のデータが取込済みです"]}):e.jsxs("button",{onClick:()=>N(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-sm font-medium",children:[e.jsx(W,{className:"w-4 h-4"}),"前期データをインポート"]}),e.jsxs(E,{to:"/settlement-history",className:"inline-flex items-center gap-2 px-4 py-2 bg-surface-highlight border border-border text-text-muted hover:text-text-main rounded-lg transition-colors text-sm font-medium",children:[e.jsx(P,{className:"w-4 h-4"}),"履歴・引継ぎ管理"]})]})]})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-1",children:"会社基本情報"}),e.jsx("p",{className:"text-text-muted",children:"法人税申告に必要な会社情報を入力してください。"})]}),e.jsx("div",{className:"flex flex-col items-end gap-2",children:e.jsxs("button",{onClick:d,className:"flex items-center justify-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors text-primary text-sm font-medium whitespace-nowrap",children:[e.jsx(T,{className:"w-4 h-4"}),"登録データから転記"]})})]}),b?e.jsxs("div",{className:"bg-success-light border border-success/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-success flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"前期データ（バトンタッチ）の適用中"}),e.jsxs("p",{className:"text-sm text-text-muted mt-1",children:[b.year,"年度の確定済み決算データから、期首残高（資本金・利益剰余金など）を自動的に引き継いでいます。"]})]})]}):e.jsxs("div",{className:"bg-warning-light border border-warning/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"前期データの登録をお勧めします"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"「過去決算・引継ぎ管理」に前年度のB/Sを登録すると、期首残高が自動でバトンタッチ（引き継ぎ）されます。"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-text-main mb-2",children:["会社名 ",e.jsx("span",{className:"text-error",children:"*"})]}),e.jsx("input",{type:"text",value:s.companyName,onChange:x=>r({...s,companyName:x.target.value}),className:"input-base",placeholder:"株式会社〇〇"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"代表者名"}),e.jsx("input",{type:"text",value:s.representativeName,onChange:x=>r({...s,representativeName:x.target.value}),className:"input-base",placeholder:"山田 太郎"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"法人番号"}),e.jsx("input",{type:"text",value:s.corporateNumber,onChange:x=>r({...s,corporateNumber:x.target.value}),className:"input-base",placeholder:"1234567890123"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"資本金"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:"¥"}),e.jsx("input",{type:"number",value:s.capital,onChange:x=>r({...s,capital:Number(x.target.value)}),className:"input-base pl-8"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"所在地"}),e.jsx("input",{type:"text",value:s.address,onChange:x=>r({...s,address:x.target.value}),className:"input-base",placeholder:"東京都渋谷区..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"事業年度（開始）"}),e.jsx("input",{type:"date",value:s.fiscalYearStart,onChange:x=>a({fiscalYearStart:x.target.value}),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"事業年度（終了）"}),e.jsx("input",{type:"date",value:s.fiscalYearEnd,onChange:x=>a({fiscalYearEnd:x.target.value}),className:"input-base"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"所轄税務署"}),e.jsx("input",{type:"text",value:s.taxOffice||"",onChange:x=>a({taxOffice:x.target.value}),className:"input-base",placeholder:"例：芝税務署"})]})]}),e.jsxs("div",{className:"bg-info-light border border-info/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(H,{className:"w-5 h-5 text-info flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"中小法人の税制優遇"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"資本金1億円以下の中小法人は、年800万円以下の所得に対して15%の軽減税率が適用されます。"})]})]})]}),Le=({assets:s,onDepreciationCalculate:r,handleTranscribe:a})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-1",children:"減価償却資産の登録"}),e.jsx("p",{className:"text-text-muted",children:"10万円以上の資産や、減価償却が必要な資産を登録してください。"})]}),e.jsxs("button",{onClick:a,className:"flex items-center justify-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors text-primary text-sm font-medium whitespace-nowrap",children:[e.jsx(T,{className:"w-4 h-4"}),"取引データから転記"]})]}),e.jsx(ke,{initialAssets:s,onCalculate:r})]}),Ye=({financialData:s,corporateInfo:r,prevYearSettlement:a,showComparison:d,setShowComparison:p})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:"損益計算書"}),e.jsxs("p",{className:"text-text-muted mb-6",children:[r.fiscalYear,"年度の取引データから自動集計した結果です。"]})]}),a&&e.jsxs("div",{className:"flex items-center justify-between bg-surface border border-border rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-text-main block",children:["前期 (",a.year,"年度) と比較"]}),e.jsx("span",{className:"text-xs text-text-muted",children:"収益・費用の増減を確認できます"})]})]}),e.jsx("button",{onClick:()=>p(!d),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${d?"bg-primary":"bg-border"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${d?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-success-light border border-success/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-success font-medium",children:"売上高"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:n(s.revenue)}),d&&a&&e.jsxs("p",{className:`text-xs mt-2 font-medium ${s.revenue>=a.revenue?"text-success":"text-error"}`,children:[s.revenue>=a.revenue?"↑":"↓",n(Math.abs(s.revenue-a.revenue)),e.jsxs("span",{className:"text-text-muted ml-1 font-normal",children:["(",a.year,"度: ",n(a.revenue),")"]})]})]}),e.jsxs("div",{className:"bg-error-light border border-error/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-error font-medium",children:"販管費"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:n(s.operatingExpenses)}),d&&a&&e.jsxs("p",{className:`text-xs mt-2 font-medium ${s.operatingExpenses<=a.operating_expenses?"text-success":"text-error"}`,children:[s.operatingExpenses<=a.operating_expenses?"↓":"↑",n(Math.abs(s.operatingExpenses-a.operating_expenses)),e.jsxs("span",{className:"text-text-muted ml-1 font-normal",children:["(",a.year,"度: ",n(a.operating_expenses),")"]})]})]}),e.jsxs("div",{className:"bg-primary-light border border-primary/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-primary font-medium",children:"経常利益"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:n(s.ordinaryIncome)}),d&&a&&e.jsxs("p",{className:`text-xs mt-2 font-medium ${s.ordinaryIncome>=a.net_income?"text-success":"text-error"}`,children:[s.ordinaryIncome>=a.net_income?"↑":"↓",n(Math.abs(s.ordinaryIncome-a.net_income))]})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[e.jsx("h4",{className:"font-medium text-text-main mb-4",children:"損益計算書"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"売上高"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.revenue)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"売上原価"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.costOfSales)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border bg-surface-highlight px-2 -mx-2",children:[e.jsx("span",{className:"font-medium text-text-main",children:"売上総利益"}),e.jsx("span",{className:"font-bold text-text-main",children:n(s.grossProfit)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"販売費及び一般管理費"}),e.jsx("span",{className:"font-medium text-error",children:n(s.operatingExpenses)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border bg-primary-light px-2 -mx-2",children:[e.jsx("span",{className:"font-medium text-text-main",children:"営業利益"}),e.jsx("span",{className:"font-bold text-primary",children:n(s.operatingIncome)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-border",children:[e.jsx("span",{className:"text-text-muted",children:"営業外損益"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.nonOperatingIncome-s.nonOperatingExpenses)})]}),e.jsxs("div",{className:"flex justify-between py-2 bg-success-light px-2 -mx-2 rounded",children:[e.jsx("span",{className:"font-bold text-text-main",children:"税引前当期純利益"}),e.jsx("span",{className:"font-bold text-success",children:n(s.incomeBeforeTax)})]})]})]}),s.expensesByCategory.length>0&&e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[e.jsx("h4",{className:"font-medium text-text-main mb-4",children:"経費内訳（上位5件）"}),e.jsx("div",{className:"space-y-3",children:s.expensesByCategory.slice(0,5).map((b,N)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-surface-highlight rounded-lg flex items-center justify-center text-sm font-medium text-text-muted",children:N+1}),e.jsx("span",{className:"text-text-main",children:b.category})]}),e.jsx("span",{className:"font-medium text-text-main",children:n(b.amount)})]},N))})]})]}),We=({taxResult:s,corporateInfo:r,handleCopy:a,copiedField:d})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:"法人税等の計算"}),e.jsx("p",{className:"text-text-muted mb-6",children:"課税所得に基づいて法人税等を自動計算しました。"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-text-muted",children:"課税所得"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:n(s.taxableIncome)})]}),e.jsxs("div",{className:"bg-primary-light border border-primary/20 rounded-xl p-5",children:[e.jsx("p",{className:"text-sm text-primary font-medium",children:"法人税等合計"}),e.jsx("p",{className:"text-2xl font-bold text-text-main mt-1",children:n(s.totalTax)}),e.jsxs("p",{className:"text-xs text-text-muted mt-2",children:["実効税率: ",_e(s.effectiveTaxRate)]})]})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl divide-y divide-border",children:[e.jsx("div",{className:"p-4",children:e.jsx("h4",{className:"font-medium text-text-main",children:"法人税等の内訳"})}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-main",children:"法人税"}),r.capital<=1e8&&e.jsx("span",{className:"ml-2 text-xs text-success bg-success-light px-2 py-0.5 rounded",children:"中小法人軽減"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-text-main",children:n(s.corporateTax)}),e.jsx("button",{onClick:()=>a(s.corporateTax,"corporateTax"),className:`p-1.5 rounded transition-colors ${d==="corporateTax"?"bg-success text-white":"hover:bg-surface-highlight text-text-muted"}`,children:d==="corporateTax"?e.jsx(Ne,{className:"w-4 h-4"}):e.jsx(Ae,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"地方法人税"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.localCorporateTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"法人住民税"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.corporateInhabitantTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"法人事業税"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.businessTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-primary-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"税金合計"}),e.jsx("span",{className:"font-bold text-primary text-lg",children:n(s.totalTax)})]})]}),e.jsxs("div",{className:"bg-success-light border border-success/20 rounded-xl p-5 flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-text-main",children:"当期純利益"}),e.jsx("span",{className:"text-2xl font-bold text-success",children:n(s.netIncome)})]}),s.taxableIncome<=0&&e.jsxs("div",{className:"bg-warning-light border border-warning/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"課税所得がありません"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"今期は課税所得がないため、法人税は発生しません（均等割のみ発生）。"})]})]})]}),Ve=({consumptionTaxResult:s})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:"消費税の確認"}),e.jsx("p",{className:"text-text-muted mb-6",children:"売上・仕入に係る消費税を集計しました。"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl divide-y divide-border",children:[e.jsx("div",{className:"p-4",children:e.jsx("h4",{className:"font-medium text-text-main",children:"消費税計算"})}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"課税売上高"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.taxableRevenue)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"売上に係る消費税"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.outputTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"課税仕入高"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.taxablePurchases)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"仕入に係る消費税"}),e.jsx("span",{className:"font-medium text-error",children:n(s.inputTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-primary-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"納付消費税額（国税）"}),e.jsx("span",{className:"font-bold text-primary",children:n(s.netConsumptionTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-main",children:"地方消費税"}),e.jsx("span",{className:"font-medium text-text-main",children:n(s.localConsumptionTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-success-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"消費税等合計"}),e.jsx("span",{className:"font-bold text-success text-lg",children:n(s.totalConsumptionTax)})]})]}),e.jsxs("div",{className:"bg-info-light border border-info/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(H,{className:"w-5 h-5 text-info flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"免税事業者の確認"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"基準期間の課税売上高が1,000万円以下の場合、消費税の納税義務が免除される場合があります。"})]})]})]}),Be=({corporateInfo:s,financialData:r,taxResult:a,isLoading:d,generatePDF:p,handleOpenInEditor:b})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-main mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-primary"}),"書類の作成・ダウンロード"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"入力内容を確認して、必要な書類をダウンロードしてください。"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl divide-y divide-border",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"会社名"}),e.jsx("span",{className:"font-medium text-text-main",children:s.companyName||"（未入力）"})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"事業年度"}),e.jsxs("span",{className:"font-medium text-text-main",children:[s.fiscalYear,"年度"]})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"売上高"}),e.jsx("span",{className:"font-medium text-success",children:n(r.revenue)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"営業外収益"}),e.jsx("span",{className:"font-medium text-success",children:n(r.nonOperatingIncome)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"経常利益"}),e.jsx("span",{className:"font-medium text-primary",children:n(r.ordinaryIncome)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-text-muted",children:"法人税等"}),e.jsx("span",{className:"font-medium text-error",children:n(a.totalTax)})]}),e.jsxs("div",{className:"p-4 flex justify-between items-center bg-success-light",children:[e.jsx("span",{className:"font-bold text-text-main",children:"当期純利益"}),e.jsx("span",{className:"font-bold text-success",children:n(a.netIncome)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>p("financial"),disabled:d,className:"flex items-center justify-between p-6 bg-surface border border-border rounded-xl hover:border-primary hover:bg-primary/5 hover:shadow-md transition-all group w-full",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:d?e.jsx(T,{className:"w-6 h-6 animate-spin text-primary"}):e.jsx(P,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-text-main text-lg",children:"損益計算書・貸借対照表"}),e.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:"当期の決算状況をPDFで出力"})]})]}),!d&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-primary text-white rounded-lg text-sm font-bold shadow-sm transition-transform group-hover:scale-105",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"ダウンロード"})]})]}),e.jsxs("button",{onClick:()=>{if(r){const N=B.generateFinancialStatementCSV({...s,...r,fiscalYear:s.fiscalYear,taxableIncome:a.taxableIncome,estimatedTax:a.totalTax});B.downloadCSV(N,`financial_statements_${s.companyName}_${s.fiscalYear}.csv`),g.success("財務諸表CSVを出力しました")}},disabled:d,className:"flex items-center justify-between p-6 bg-surface border border-border rounded-xl hover:border-primary hover:bg-primary/5 hover:shadow-md transition-all group w-full",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-500/10 flex items-center justify-center group-hover:bg-indigo-500/20 transition-colors",children:e.jsx(G,{className:"w-6 h-6 text-indigo-500"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-text-main text-lg",children:"財務諸表データ(CSV)"}),e.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:"e-Taxソフト等への取込用"})]})]}),!d&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-indigo-500 text-white rounded-lg text-sm font-bold shadow-sm transition-transform group-hover:scale-105",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"CSV出力"})]})]}),e.jsxs("button",{onClick:()=>p("corporate"),disabled:d,className:"flex items-center justify-between p-6 bg-surface border border-border rounded-xl hover:border-primary hover:bg-primary/5 hover:shadow-md transition-all group w-full lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:d?e.jsx(T,{className:"w-6 h-6 animate-spin text-primary"}):e.jsx($,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-text-main text-lg",children:"法人税申告書（詳細）"}),e.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:"別表を含めた法人税申告のドラフト版"})]})]}),!d&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-primary text-white rounded-lg text-sm font-bold shadow-sm transition-transform group-hover:scale-105",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"ダウンロード"})]})]})]}),e.jsx("div",{className:"bg-surface-highlight rounded-xl p-5 border border-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-text-main flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-primary"}),"申告書を詳細に編集する"]}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"別表の調整や、細かい数字の修正が必要な場合は、詳細エディタをご利用ください。"})]}),e.jsxs("button",{onClick:b,className:"btn-secondary whitespace-nowrap",children:["詳細エディタで開く",e.jsx(F,{className:"w-4 h-4 ml-2"})]})]})}),e.jsxs("div",{className:"bg-warning-light border border-warning/20 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-main font-medium",children:"ご注意"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"この書類は参考資料です。正式な法人税申告は税理士にご相談いただくか、 e-Taxにて提出してください。"})]})]}),e.jsx("div",{className:"bg-surface border border-border rounded-xl p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-5 h-5 text-text-muted"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-main",children:"PDF座標キャリブレーター"}),e.jsx("p",{className:"text-sm text-text-muted",children:"公式PDFフォームの座標調整ツール"})]})]}),e.jsxs("a",{href:"/tools/coordinate_picker.html",target:"_blank",rel:"noopener noreferrer",className:"btn-ghost text-sm flex items-center gap-1",children:["開く",e.jsx(F,{className:"w-4 h-4"})]})]})})]}),hs=()=>{const{user:s}=pe(),{currentBusinessType:r}=he(),{transactions:a}=ue(s==null?void 0:s.id,r==null?void 0:r.business_type),d=be(),[p,b]=u.useState(1),[N,x]=u.useState(!1),[Z,M]=u.useState(null),[y,D]=u.useState(null),[m,J]=u.useState(null),[K,L]=u.useState(!1),[Q,X]=u.useState(!1);je.useEffect(()=>{(async()=>{if(s!=null&&s.id&&(r!=null&&r.business_type))try{const i=await V.getLatest(s.id,r.business_type);D(i);const h=await ye.getByYear(s.id,r.business_type,(i==null?void 0:i.year)||new Date().getFullYear()-1);h&&(J(h),k(o=>({...o,capital:h.net_assets_capital||o.capital})))}catch(i){console.error("前年度データの取得に失敗しました:",i)}})()},[s==null?void 0:s.id,r==null?void 0:r.business_type]);const R=()=>{if(window.confirm(`現在の計算結果を詳細エディタに転記して開きますか？
（エディタの既存データは上書きされます）`)){const t=z.calculateDataFromTransactions(a,l,(y==null?void 0:y.balance_sheet)||null);z.saveData({...U,...t,companyInfo:{...U.companyInfo,corporateName:l.companyName,representativeName:l.representativeName,corporateNumber:l.corporateNumber||"",address:l.address||"",taxOffice:l.taxOffice||"",capitalAmount:l.capital,fiscalYearStart:l.fiscalYearStart,fiscalYearEnd:l.fiscalYearEnd}}),d("/corporate-tax/input")}},v=new Date().getFullYear(),[l,k]=u.useState({companyName:"",representativeName:"",corporateNumber:"",address:"",taxOffice:"",capital:1e7,fiscalYearStart:`${v-1}-04-01`,fiscalYearEnd:`${v}-03-31`,fiscalYear:v-1,employeeCount:1}),ee=t=>{k(i=>({...i,...t}))},[se,Y]=u.useState([]),[j,te]=u.useState(0),ae=(t,i)=>{te(t),Y(i)},c=u.useMemo(()=>{const t={retainedEarnings:(m==null?void 0:m.net_assets_retained_earnings_total)||0,capital:(m==null?void 0:m.net_assets_capital)||l.capital,cash:(m==null?void 0:m.assets_current_cash)||0,receivable:m!=null&&m.assets_current_total?m.assets_current_total-(m.assets_current_cash||0):0,inventory:0,fixedAssets:m!=null&&m.assets_total?m.assets_total-(m.assets_current_total||0):0,payable:(m==null?void 0:m.liabilities_total)||0,shortTermLoans:0,longTermLoans:0},i=ve(a,l.fiscalYear,t);if(j>0){const h=i.expensesByCategory.findIndex(o=>o.category==="減価償却費");h>=0?i.expensesByCategory[h].amount+=j:i.expensesByCategory.push({category:"減価償却費",amount:j}),i.operatingExpenses+=j,i.operatingIncome-=j,i.ordinaryIncome-=j,i.incomeBeforeTax-=j,i.expensesByCategory.sort((o,C)=>C.amount-o.amount)}return i},[a,l.fiscalYear,j]),w=u.useMemo(()=>we(c,l),[c,l]),re=u.useMemo(()=>Ce(c.revenue,c.operatingExpenses),[c]),ne=()=>{p<I.length&&b(p+1)},ie=()=>{p>1&&b(p-1)},le=()=>{const t=r;if(!t){g.error("登録された事業情報が見つかりません。連携設定で登録してください。");return}const i=t.fiscal_year_start_month||(t.business_type==="corporation"?4:1),h=`${v-1}-${String(i).padStart(2,"0")}-01`,o=new Date(v-1,i-1,1);o.setFullYear(o.getFullYear()+1),o.setDate(o.getDate()-1);const C=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`;k(f=>({...f,companyName:(t==null?void 0:t.company_name)||f.companyName||"",representativeName:(t==null?void 0:t.representative_name)||f.representativeName||"",corporateNumber:((t==null?void 0:t.tax_number)||f.corporateNumber||"").replace(/^T/,""),address:(t==null?void 0:t.address)||f.address||"",capital:(t==null?void 0:t.capital_amount)||f.capital||0,fiscalYearStart:h,fiscalYearEnd:C})),g.success("事業情報を転記しました")},ce=()=>{if(!a||a.length===0){g.error("取引データが見つかりません。");return}const t=Te(a,l.fiscalYear);if(t.length===0){g.error("転記可能な減価償却資産（タグ: depreciation_asset）が見つかりません。");return}Y(t),g.success(`${t.length}件の減価償却資産を転記しました`)},me=async(t,i)=>{try{await navigator.clipboard.writeText(String(t).replace(/[¥,]/g,"")),M(i),setTimeout(()=>M(null),2e3)}catch(h){console.error("コピーに失敗しました:",h)}},de=async t=>{x(!0);try{const i={companyName:l.companyName||"（会社名未入力）",representativeName:l.representativeName,address:l.address,corporateNumber:l.corporateNumber,capital:l.capital,businessType:"corporation",revenue:c.revenue,expenses:c.operatingExpenses,netIncome:w.netIncome,expensesByCategory:c.expensesByCategory,fiscalYear:l.fiscalYear,fiscalYearStart:l.fiscalYearStart,fiscalYearEnd:l.fiscalYearEnd,taxableIncome:w.taxableIncome,estimatedTax:w.totalTax,costOfSales:c.costOfSales,grossProfit:c.grossProfit,operatingExpenses:c.operatingExpenses,operatingIncome:c.operatingIncome,nonOperatingIncome:c.nonOperatingIncome,nonOperatingExpenses:c.nonOperatingExpenses,ordinaryIncome:c.ordinaryIncome,cash:c.cash,accountsReceivable:c.accountsReceivable,inventory:c.inventory,fixedAssets:c.fixedAssets,totalAssets:c.totalAssets,accountsPayable:c.accountsPayable,shortTermLoans:c.shortTermLoans,longTermLoans:c.longTermLoans,totalLiabilities:c.totalLiabilities,beginningRetainedEarnings:c.beginningRetainedEarnings,beginningCapital:c.beginningCapital,depreciation:j};let h,o;t==="corporate"?(h=await Ee(i),o=`法人税申告書_${l.fiscalYear}年度.pdf`):(h=await Se(i),o=`決算報告書_${l.fiscalYear}年度.pdf`);const C=new Blob([h],{type:"application/pdf"}),f=URL.createObjectURL(C),_=document.createElement("a");_.href=f,_.download=o,document.body.appendChild(_),_.click(),document.body.removeChild(_),window.open(f,"_blank")}catch(i){console.error("PDF生成エラー:",i)}finally{x(!1)}},xe=()=>{switch(p){case 1:return e.jsx(De,{corporateInfo:l,setCorporateInfo:k,handleInfoChange:ee,handleTranscribe:le,prevYearSettlement:y,prevYearBS:m,setIsImportModalOpen:L});case 2:return e.jsx(Le,{assets:se,onDepreciationCalculate:ae,handleTranscribe:ce});case 3:return e.jsx(Ye,{financialData:c,corporateInfo:l,prevYearSettlement:y,showComparison:Q,setShowComparison:X});case 4:return e.jsx(We,{taxResult:w,corporateInfo:l,handleCopy:me,copiedField:Z});case 5:return e.jsx(Ve,{consumptionTaxResult:re});case 6:return e.jsx(Be,{corporateInfo:l,financialData:c,taxResult:w,isLoading:N,generatePDF:de,handleOpenInEditor:R});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("main",{className:"w-full px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{to:"/dashboard",className:"mr-4 p-2 rounded-lg hover:bg-surface-highlight transition-colors",children:e.jsx(q,{className:"w-6 h-6 text-text-muted hover:text-text-main"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-text-main flex items-center gap-2",children:[e.jsx($,{className:"w-7 h-7 text-primary"}),"法人税申告サポート"]}),e.jsx("p",{className:"text-text-muted mt-1",children:"法人決算・税務申告のサポート"})]})]}),e.jsxs(E,{to:"/corporate-tax-guide",className:"flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors text-primary",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"申告ガイド"})]})]}),e.jsx(Pe,{currentStep:p,steps:I.map(t=>({number:t.id,title:t.title,description:t.description}))}),e.jsx("div",{className:"bg-surface rounded-xl border border-border p-6 md:p-8 mb-8 shadow-sm",children:xe()}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("button",{onClick:ie,disabled:p===1,className:`btn-ghost ${p===1?"invisible":""}`,children:[e.jsx(q,{className:"w-5 h-5 mr-2"}),"戻る"]}),p<I.length?e.jsxs("button",{onClick:ne,className:"btn-primary min-w-[200px]",children:["次へ進む",e.jsx(F,{className:"w-5 h-5 ml-2"})]}):e.jsxs(E,{to:"/dashboard",className:"btn-primary min-w-[200px]",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),"ダッシュボードへ"]})]})]}),e.jsx(ge,{isOpen:K,onClose:()=>L(!1),userId:(s==null?void 0:s.id)||"",businessType:(r==null?void 0:r.business_type)||"corporation",onImportSuccess:()=>{s!=null&&s.id&&(r!=null&&r.business_type)&&V.getLatest(s.id,r.business_type).then(D),g.success("前期データをインポートしました")}})]})};export{hs as default};
