const _=[{min:0,max:195e4,rate:.05,deduction:0},{min:195e4,max:33e5,rate:.1,deduction:97500},{min:33e5,max:695e4,rate:.2,deduction:427500},{min:695e4,max:9e6,rate:.23,deduction:636e3},{min:9e6,max:18e6,rate:.33,deduction:1536e3},{min:18e6,max:4e7,rate:.4,deduction:2796e3},{min:4e7,max:1/0,rate:.45,deduction:4796e3}],h=65e4,T=48e4,I=[{type:"basic",name:"基礎控除",description:"全ての納税者が受けられる控除（48万円）",documents:[]},{type:"blue_return",name:"青色申告特別控除",description:"青色申告者が受けられる控除（最大65万円）",documents:["青色申告承認申請書"]},{type:"medical",name:"医療費控除",description:"年間10万円を超える医療費の控除",documents:["医療費の領収書","医療費控除の明細書"]},{type:"social_insurance",name:"社会保険料控除",description:"国民健康保険、国民年金などの控除",documents:["社会保険料控除証明書"]},{type:"small_business_mutual",name:"小規模企業共済等掛金控除",description:"小規模企業共済やiDeCoの掛金控除",documents:["掛金払込証明書"]},{type:"life_insurance",name:"生命保険料控除",description:"生命保険料の控除（最大12万円）",documents:["生命保険料控除証明書"]},{type:"earthquake_insurance",name:"地震保険料控除",description:"地震保険料の控除（最大5万円）",documents:["地震保険料控除証明書"]},{type:"spouse",name:"配偶者控除",description:"配偶者の所得に応じた控除",documents:[]},{type:"dependent",name:"扶養控除",description:"扶養親族に応じた控除",documents:[]},{type:"furusato",name:"ふるさと納税（寄附金控除）",description:"ふるさと納税による寄附金控除",documents:["寄附金受領証明書"]},{type:"housing_loan",name:"住宅ローン控除",description:"住宅ローンの年末残高に応じた控除",documents:["住宅借入金等特別控除証明書","年末残高証明書"]}],D=(t,s,o="individual",a=[])=>{const c=t.filter(e=>{var y;const r=new Date(e.date).getFullYear()===s,x=(y=e.tags)==null?void 0:y.includes("depreciation_asset");return r&&!x}),b=c.filter(e=>e.type==="income"),u=c.filter(e=>e.type==="expense"),m=b.reduce((e,n)=>e+Math.abs(Number(n.amount)||0),0),i=u.reduce((e,n)=>e+Math.abs(Number(n.amount)||0),0),d=m-i,f=Object.entries(u.reduce((e,n)=>{const r=n.category||"未分類";return e[r]=(e[r]||0)+Math.abs(Number(n.amount)||0),e},{})).map(([e,n])=>({category:e,amount:n,percentage:i>0?n/i*100:0})).sort((e,n)=>n.amount-e.amount),p=a.filter(e=>e.isApplicable).reduce((e,n)=>e+n.amount,0),l=Math.max(0,Math.floor((d-p)/1e3)*1e3),g=A(l);return{fiscalYear:s,businessType:o,totalRevenue:m,totalExpenses:i,netIncome:d,expensesByCategory:f,deductions:a,totalDeductions:p,taxableIncome:l,estimatedTax:g,status:"draft"}},A=t=>{for(const s of _)if(t<=s.max)return Math.floor(t*s.rate-s.deduction);return 0},C=(t=!0)=>{const s=[{id:"basic",type:"basic",name:"基礎控除",amount:T,description:"全ての納税者が受けられる控除",isApplicable:!0}];return t&&s.push({id:"blue_return",type:"blue_return",name:"青色申告特別控除",amount:h,description:"電子申告で最大65万円控除",isApplicable:!0}),s},E=async(t,s)=>{const o=[];return t.deductions.find(a=>a.type==="blue_return")||o.push("青色申告特別控除（65万円）の適用をご検討ください"),t.totalRevenue>0&&t.totalExpenses/t.totalRevenue<.3&&o.push("経費率が低めです。経費として計上できる支出がないか確認してみましょう"),t.taxableIncome>33e5&&o.push("小規模企業共済やiDeCoへの加入で節税効果が期待できます"),o.push("ふるさと納税で節税しながら地域貢献ができます"),o.push("経費の領収書は7年間保管が必要です"),{suggestions:o,estimatedSavings:Math.round(t.estimatedTax*.1)}},N=t=>new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",maximumFractionDigits:0}).format(t),M=t=>`${t.toFixed(1)}%`;export{I as A,M as a,E as b,D as c,N as f,C as g};
