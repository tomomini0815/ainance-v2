import{g as v,c as D}from"./CorporateTaxService-DGpGOaw1.js";const i={companyInfo:{corporateName:"",corporateNameKana:"",corporateNumber:"",postalCode:"",address:"",phoneNumber:"",representativeName:"",representativeNameKana:"",representativeAddress:"",businessType:"",taxOffice:"",fiscalYearStart:"",fiscalYearEnd:"",filingDate:"",capitalAmount:1e6,employeeCount:1,groupCompanyType:"single",blueFormApproval:!0},beppyo1:{taxableIncome:0,corporateTaxAmount:0,specialTaxCredit:0,nationalInterimPayment:0,interimPayment:0,nationalTaxPayable:0,localCorporateTaxAmount:0,localInterimPayment:0,localTaxPayable:0,prefecturalTax:0,municipalTax:0,inhabitantInterimPayment:0,inhabitantTaxPayable:0,enterpriseTax:0,specialLocalEnterpriseTax:0,enterpriseInterimPayment:0,enterpriseTaxPayable:0,totalTaxAmount:0,refundAmount:0},beppyo4:{netIncomeFromPL:0,nonDeductibleTaxes:0,nonDeductibleEntertainment:0,excessDepreciation:0,additions:[],otherAdditions:[],deductibleEnterpriseTax:0,dividendExclusion:0,subtractions:[],otherSubtractions:[],taxableIncome:0},beppyo5:{retainedEarningsItems:[{id:"1",description:"利益準備金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"2",description:"別途積立金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"3",description:"繰越利益剰余金",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"4",description:"未払法人税等",beginAmount:0,increase:0,decrease:0,endAmount:0},{id:"5",description:"未払事業税",beginAmount:0,increase:0,decrease:0,endAmount:0}],retainedEarningsBegin:0,currentIncrease:0,currentDecrease:0,totalRetainedEarningsEnd:0,capitalBegin:1e6,capitalIncrease:0,capitalDecrease:0,capitalEnd:1e6},beppyo5_2:{items:[],totalPaid:0,taxesPayable:{corporate:0,inhabitant:0,enterprise:0,localCorporate:0}},beppyo16:{assets:[],totalDepreciation:0,totalAllowable:0,excessAmount:0},beppyo15:{totalEntertainmentExpenses:0,foodAndDrinkExpenses:0,otherEntertainmentExpenses:0,capitalAmount:1e6,socialExpenses:0,deductibleExpenses:0,deductionLimit:8e6,excessAmount:0},beppyo2:{shareholders:[],totalShares:100,isFamilyCompany:!0},businessOverview:{sales:0,costOfSales:0,grossProfit:0,operatingExpenses:0,operatingIncome:0,ordinaryIncome:0,netIncome:0,directorsCompensation:0,employeesSalary:0,rent:0,taxesAndDues:0,entertainmentExpenses:0,depreciation:0},calibration:{globalShiftX:0,globalShiftY:0}},h="ainance_corporate_tax_input_data",C={saveData:e=>{try{localStorage.setItem(h,JSON.stringify(e))}catch(t){console.error("Failed to save corporate tax input data:",t)}},getData:()=>{try{const e=localStorage.getItem(h);if(e){const t=JSON.parse(e);return{...i,...t,companyInfo:{...i.companyInfo,...t.companyInfo||{}},beppyo1:{...i.beppyo1,...t.beppyo1||{}},beppyo4:{...i.beppyo4,...t.beppyo4||{}},beppyo5:{...i.beppyo5,...t.beppyo5||{}},beppyo5_2:{...i.beppyo5_2,...t.beppyo5_2||{}},beppyo16:{...i.beppyo16,...t.beppyo16||{}},beppyo15:{...i.beppyo15,...t.beppyo15||{}},beppyo2:{...i.beppyo2,...t.beppyo2||{}},businessOverview:{...i.businessOverview,...t.businessOverview||{}},calibration:{...i.calibration,...t.calibration||{}}}}}catch(e){console.error("Failed to load corporate tax input data:",e)}return i},resetData:()=>{localStorage.removeItem(h)},calculateDataFromTransactions:(e,t,p)=>{const d=new Date().getFullYear()-1,l=v(e,d,p),n=C.getData(),o=(t==null?void 0:t.capital)||(p==null?void 0:p.capital)||n.companyInfo.capitalAmount||1e6,a=(p==null?void 0:p.retainedEarnings)||0,s=D(l,{...n.companyInfo,...t,capital:o}),u=r=>{var m;return((m=l.expensesByCategory.find(S=>S.category.includes(r)))==null?void 0:m.amount)||0},T=u("役員報酬"),f=u("地代家賃"),g=u("租税公課"),b=u("交際費")+u("接待交際費"),A=u("減価償却費"),I=u("給料")+u("人件費"),y=u("飲食"),E=Math.max(0,(b||0)-8e6),x=e.filter(r=>{var m;return((m=r.tags)==null?void 0:m.includes("depreciation_asset"))&&new Date(r.date).getFullYear()===d}).map(r=>{var m;return{id:r.id,name:((m=r.description)==null?void 0:m.split(" ")[0])||"固定資産",acquisitionDate:r.date,acquisitionCost:Math.abs(Number(r.amount)||0),usefulLife:5,depreciationMethod:"straightLine",currentDepreciation:Math.abs(Number(r.amount)||0)/5,allowableLimit:Math.abs(Number(r.amount)||0)/5,bookValueEnd:Math.abs(Number(r.amount)||0)*.8}});return{businessOverview:{sales:l.revenue||0,costOfSales:l.costOfSales||0,grossProfit:l.grossProfit||0,operatingExpenses:l.operatingExpenses||0,operatingIncome:l.operatingIncome||0,ordinaryIncome:l.ordinaryIncome||0,netIncome:s.netIncome,directorsCompensation:T,employeesSalary:I,rent:f,taxesAndDues:g,entertainmentExpenses:b,depreciation:A},beppyo1:{...i.beppyo1,taxableIncome:Math.max(0,s.taxableIncome||0),corporateTaxAmount:Math.max(0,s.corporateTax||0),localCorporateTaxAmount:Math.max(0,s.localCorporateTax||0),prefecturalTax:Math.max(0,s.prefecturalTax||0),municipalTax:Math.max(0,s.municipalTax||0),enterpriseTax:Math.max(0,s.businessTax||0),totalTaxAmount:Math.max(0,s.totalTax||0),nationalTaxPayable:Math.max(0,s.corporateTax||0),localTaxPayable:Math.max(0,s.localCorporateTax||0),inhabitantTaxPayable:Math.max(0,(s.prefecturalTax||0)+(s.municipalTax||0)),enterpriseTaxPayable:Math.max(0,s.businessTax||0),interimPayment:0},beppyo4:{...i.beppyo4,netIncomeFromPL:s.netIncome,nonDeductibleTaxes:g||0,nonDeductibleEntertainment:E||0,taxableIncome:Math.max(0,s.taxableIncome||0),additions:[],subtractions:[]},beppyo5:{...i.beppyo5,retainedEarningsBegin:a,currentIncrease:s.netIncome,currentDecrease:0,totalRetainedEarningsEnd:a+s.netIncome,capitalBegin:o,capitalEnd:o,retainedEarningsItems:(i.beppyo5.retainedEarningsItems||[]).map(r=>r.description==="繰越利益剰余金"?{...r,beginAmount:a,increase:s.netIncome,endAmount:a+s.netIncome}:r)},beppyo15:{...i.beppyo15,totalEntertainmentExpenses:b||0,foodAndDrinkExpenses:y||0,otherEntertainmentExpenses:(b||0)-(y||0),capitalAmount:o,socialExpenses:b||0,deductibleExpenses:y||0,excessAmount:E||0},beppyo16:{...i.beppyo16,assets:x.length>0?x:i.beppyo16.assets,totalDepreciation:x.reduce((r,m)=>r+(m.currentDepreciation||0),0),totalAllowable:x.reduce((r,m)=>r+(m.allowableLimit||0),0)}}}},P={generateFinancialStatementCSV:e=>{const t=a=>"businessOverview"in a;let p="",c=0,d=0,l=0;t(e)?(p="",c=new Date().getFullYear()-1,d=e.businessOverview.sales,l=e.businessOverview.operatingExpenses+e.businessOverview.costOfSales):(p=e.companyName||"",c=e.fiscalYear,d=e.revenue,l=e.expenses);const n=[];n.push(["識別番号","会社名","年度","帳票区分","科目名","金額","貸借区分"]);const o=["",p,`${c}年度`];if(n.push([...o,"損益計算書","売上高",String(d),"貸方"]),t(e)){const a=e.businessOverview;n.push([...o,"損益計算書","売上原価",String(a.costOfSales),"借方"]),n.push([...o,"損益計算書","販売費及び一般管理費計",String(a.operatingExpenses),"借方"]),n.push([...o,"損益計算書","　役員報酬",String(a.directorsCompensation),"借方"]),n.push([...o,"損益計算書","　給料賃金",String(a.employeesSalary),"借方"]),n.push([...o,"損益計算書","　地代家賃",String(a.rent),"借方"]),n.push([...o,"損益計算書","　租税公課",String(a.taxesAndDues),"借方"]),n.push([...o,"損益計算書","　交際費",String(a.entertainmentExpenses),"借方"]),n.push([...o,"損益計算書","　減価償却費",String(a.depreciation),"借方"]),n.push([...o,"損益計算書","営業利益",String(a.operatingIncome),"貸方"]),n.push([...o,"損益計算書","経常利益",String(a.ordinaryIncome),"貸方"]),n.push([...o,"損益計算書","税引前当期純利益",String(a.netIncome),"貸方"])}else n.push([...o,"損益計算書","費用合計",String(l),"借方"]),e.expensesByCategory.forEach(a=>{n.push([...o,"損益計算書",`　${a.category}`,String(a.amount),"借方"])}),n.push([...o,"損益計算書","当期純利益",String(e.netIncome),"貸方"]);return n.map(a=>a.join(",")).join(`\r
`)},downloadCSV:(e,t)=>{const p=new Blob([new Uint8Array([239,187,191]),e],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a");if(c.download!==void 0){const d=URL.createObjectURL(p);c.setAttribute("href",d),c.setAttribute("download",t),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}}};export{C,P as a,i};
