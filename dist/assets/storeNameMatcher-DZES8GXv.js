var h=Object.defineProperty;var m=(r,e,a)=>e in r?h(r,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[e]=a;var l=(r,e,a)=>m(r,typeof e!="symbol"?e+"":e,a);class d{static normalize(e){return e.toUpperCase().replace(/\s+/g,"").replace(/[・．.]/g,"").replace(/[ー－-]/g,"").replace(/株式会社|（株）|\(株\)/g,"").trim()}static levenshteinDistance(e,a){const o=e.length,t=a.length,i=Array(o+1).fill(null).map(()=>Array(t+1).fill(0));for(let n=0;n<=o;n++)i[n][0]=n;for(let n=0;n<=t;n++)i[0][n]=n;for(let n=1;n<=o;n++)for(let s=1;s<=t;s++){const c=e[n-1]===a[s-1]?0:1;i[n][s]=Math.min(i[n-1][s]+1,i[n][s-1]+1,i[n-1][s-1]+c)}return i[o][t]}static similarityScore(e,a){const o=this.normalize(e),t=this.normalize(a);if(o===t)return 100;const i=Math.max(o.length,t.length);if(i===0)return 0;const n=this.levenshteinDistance(o,t);return Math.round((1-n/i)*100)}static generateVariations(e){const a=new Set([e]);a.add(this.normalize(e));for(const[o,t]of this.OCR_CONFUSION_PATTERNS){const i=e.replace(o,t);i!==e&&(a.add(i),a.add(this.normalize(i)))}return Array.from(a)}static findBestMatch(e,a){const o=this.normalize(e);let t={storeName:"",confidence:0,matchType:"none"};for(const i of a)if(this.normalize(i)===o)return{storeName:i,confidence:100,matchType:"exact"};for(const[i,n]of this.STORE_VARIATIONS)for(const s of n){const c=this.normalize(s);if(o.includes(c)||c.includes(o)){const f=this.similarityScore(e,s);f>t.confidence&&(t={storeName:i,confidence:Math.min(f+10,100),matchType:"variation"})}}if(t.confidence<80)for(const i of a){const n=this.similarityScore(e,i);n>=80&&n>t.confidence&&(t={storeName:i,confidence:n,matchType:"fuzzy"})}return t}static extractStoreCandidates(e){const a=e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0),o=[];for(let t=0;t<Math.min(5,a.length);t++){const i=a[t];this.isLikelyStoreName(i)&&(o.push(i),t<a.length-1&&o.push(i+a[t+1]))}return o}static isLikelyStoreName(e){return!(e.length<2||e.length>30||/\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/.test(e)||/\d{1,2}:\d{2}/.test(e)||/[¥￥]\s*[\d,]+/.test(e)||/\d+円/.test(e)||/(都|道|府|県|市|区|町|村)/.test(e)&&e.length>10||/\d{2,4}-\d{2,4}-\d{4}/.test(e))}static detectStoreName(e,a){console.log("🏪 高精度店舗名検出を開始...");const o=this.extractStoreCandidates(e);console.log(`  候補: ${o.length}件`);let t={storeName:"不明",confidence:0,method:"なし"};for(const i of o){const n=this.findBestMatch(i,a);n.confidence>t.confidence&&(t={storeName:n.storeName,confidence:n.confidence,method:n.matchType})}return console.log(`✅ 検出結果: ${t.storeName} (信頼度: ${t.confidence}%, 方法: ${t.method})`),t}}l(d,"OCR_CONFUSION_PATTERNS",[[/0/g,"O"],[/O/g,"0"],[/1/g,"I"],[/I/g,"1"],[/l/g,"1"],[/5/g,"S"],[/S/g,"5"],[/8/g,"B"],[/B/g,"8"],[/6/g,"G"],[/G/g,"6"],[/ロ/g,"口"],[/口/g,"ロ"],[/ー/g,"一"],[/一/g,"ー"],[/二/g,"ニ"],[/ニ/g,"二"],[/工/g,"エ"],[/エ/g,"工"],[/\s+/g,""],[/[・．.]/g,""],[/[ー－-]/g,""]]),l(d,"STORE_VARIATIONS",new Map([["セブンイレブン",["セブンイレブン","セブン-イレブン","セブン","セブン11","7-11","7-ELEVEN","7ELEVEN","セフンイレフン","セフン","セプンイレプン"]],["ローソン",["ローソン","LAWSON","Lawson","ナチュラルローソン","ローソンストア100","ロ一ソン","ローソソ","ロ－ソン"]],["ファミリーマート",["ファミリーマート","ファミマ","FamilyMart","FAMILY MART","Family Mart","ファミリ一マ一ト","ファミリ－マ－ト"]],["ミニストップ",["ミニストップ","MINISTOP","MiniStop","ミニスト","ミニストツプ","ミエストップ"]],["イオン",["イオン","AEON","aeon","Aeon","イオンモール","イオンスタイル","イオソ","1オン"]],["イトーヨーカドー",["イトーヨーカドー","ヨーカドー","ItoYokado","Ito Yokado","イト一ヨ一カド一"]],["ライフ",["ライフ","LIFE","Life","ライフコーポレーション","ライ7","ラィフ"]],["マクドナルド",["マクドナルド","McDonald's","McDonalds","マック","マクド","マクドエルド","マクド子ルド"]],["スターバックス",["スターバックス","スタバ","Starbucks","STARBUCKS","スターバックスコーヒー","スタ一バックス","スターハ゛ックス"]],["すき家",["すき家","SUKIYA","Sukiya","すきや","スキヤ","すき屋","すさ家"]],["吉野家",["吉野家","YOSHINOYA","Yoshinoya","よしのや","ヨシノヤ","吉野屋","古野家"]],["松屋",["松屋","MATSUYA","Matsuya","まつや","マツヤ","松屋フーズ","松家"]]]));export{d as StoreNameMatcher};
