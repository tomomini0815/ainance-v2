import{P as z,f as R,S as B,r as P}from"./pdfAutoFillService-Dbgeiub2.js";import"./index-C8W6MraP.js";const N={所得金額_row1:{anchorX:292.7,anchorY:568.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},法人税額_row2:{anchorX:293.3,anchorY:549.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},特別控除額_row3:{anchorX:293.3,anchorY:533.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},税額控除_row4:{anchorX:293.3,anchorY:514.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},利子税_row5:{anchorX:292,anchorY:496.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},控除税額_row6:{anchorX:292.7,anchorY:479.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},留保金額_row7:{anchorX:292.7,anchorY:460.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},同上税額_row8:{anchorX:292,anchorY:441.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},法人税額計1_row9:{anchorX:294.7,anchorY:407.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row10:{anchorX:294,anchorY:386.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row11:{anchorX:293.3,anchorY:368.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row12:{anchorX:292.7,anchorY:351.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},差引法人税額_row13:{anchorX:292.7,anchorY:333.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},中間申告_row14:{anchorX:294.7,anchorY:316.8,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row15:{anchorX:293.3,anchorY:295.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},法人税額計_row28:{anchorX:293.3,anchorY:276.1,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row16:{anchorX:560,anchorY:565.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row17:{anchorX:560,anchorY:547.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},所得合計_row18:{anchorX:560,anchorY:527.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row19:{anchorX:559.3,anchorY:509.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row20:{anchorX:560,anchorY:492.1,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row21:{anchorX:559.3,anchorY:470.8,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row22:{anchorX:560,anchorY:447.5,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row23:{anchorX:560,anchorY:421.5,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row24:{anchorX:560,anchorY:394.1,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row25:{anchorX:558.7,anchorY:340.1,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row26:{anchorX:558.7,anchorY:316.8,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},row27:{anchorX:560,anchorY:295.5,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12}},_={税務署名:{x:114,y:781.5,fontSize:9},法人名:{x:85.3,y:716.1,fontSize:9},法人番号:{x:83.3,y:695.3,fontSize:9},納税地:{x:84,y:752.1,fontSize:9},電話番号:{x:170,y:745.5,fontSize:9},代表者氏名:{x:85.3,y:665.9,fontSize:9},事業年度_年_自:{x:420.7,y:772.6,fontSize:9},事業年度_月_自:{x:461.3,y:772.6,fontSize:9},事業年度_日_自:{x:489.3,y:772.6,fontSize:9},事業年度_年_至:{x:508.7,y:772.6,fontSize:9},事業年度_月_至:{x:541.3,y:772.6,fontSize:9},事業年度_日_至:{x:572.7,y:772.6,fontSize:9}},A={当期利益_row1:{anchorX:327.3,anchorY:719.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},損金算入法人税_row2:{anchorX:326.7,anchorY:703.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},損金算入住民税_row3:{anchorX:326,anchorY:689.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},交際費不算入額_row4:{anchorX:325.3,anchorY:621.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},減価償却超過額_row5:{anchorX:325.3,anchorY:525.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},法人税等還付金_row33:{anchorX:326,anchorY:348.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},支出事業税_row34:{anchorX:325.3,anchorY:207.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},所得金額_row52:{anchorX:321.3,anchorY:68.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12}},T={法人名:{x:434.7,y:788.6,fontSize:9}},F={Item1_Col1:{anchorX:287.3,anchorY:709.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item1_Col2:{anchorX:366,anchorY:708.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item1_Col3:{anchorX:445.3,anchorY:708.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item1_Col4:{anchorX:525.3,anchorY:708.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item31_Col1:{anchorX:294.7,anchorY:219.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item31_Col2:{anchorX:373.3,anchorY:220.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item31_Col3:{anchorX:452.7,anchorY:219.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item31_Col4:{anchorX:532,anchorY:219.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item32_Col1:{anchorX:286.7,anchorY:146.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item32_Col2:{anchorX:366.7,anchorY:147.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item32_Col3:{anchorX:442.7,anchorY:147.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item32_Col4:{anchorX:522.7,anchorY:147.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item33_Col1:{anchorX:295.3,anchorY:132.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item33_Col4:{anchorX:532,anchorY:132.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12}},O={法人名:{x:100,y:780,fontSize:9}},$={法人税_1:{anchorX:252,anchorY:657.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},法人税_2:{anchorX:305.3,anchorY:659.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},法人税_3:{anchorX:357.3,anchorY:659.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},法人税_4:{anchorX:410,anchorY:658.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},住民税_1:{anchorX:250.7,anchorY:585.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},住民税_2:{anchorX:304.7,anchorY:584.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},住民税_3:{anchorX:356.7,anchorY:583.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},住民税_4:{anchorX:410.7,anchorY:584.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},事業税_1:{anchorX:252,anchorY:450.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},事業税_2:{anchorX:304.7,anchorY:451.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},事業税_3:{anchorX:356.7,anchorY:452.6,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},事業税_4:{anchorX:412,anchorY:451.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},納税充当金_繰入:{anchorX:304,anchorY:233.9,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},納税充当金_取崩:{anchorX:304.7,anchorY:219.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12}},L={法人名:{x:418,y:788.6,fontSize:9}},G={Item1_Col1:{anchorX:450,anchorY:650,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item2_Col1:{anchorX:450,anchorY:600,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item17_Col1:{anchorX:450,anchorY:300,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Item18_Col1:{anchorX:450,anchorY:250,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12}},M={法人名:{x:100,y:780,fontSize:9}},k={Row1_Col1:{anchorX:249.3,anchorY:725.3,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col2:{anchorX:280,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col3:{anchorX:360,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col4:{anchorX:440,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col5:{anchorX:520,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col1:{anchorX:200,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col2:{anchorX:280,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col3:{anchorX:360,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col4:{anchorX:440,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col5:{anchorX:520,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col1:{anchorX:200,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col2:{anchorX:280,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col3:{anchorX:360,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col4:{anchorX:440,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col5:{anchorX:520,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col1:{anchorX:200,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col2:{anchorX:280,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col3:{anchorX:360,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col4:{anchorX:440,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col5:{anchorX:520,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col1:{anchorX:200,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col2:{anchorX:280,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col3:{anchorX:360,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col4:{anchorX:440,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col5:{anchorX:520,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col1:{anchorX:200,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col2:{anchorX:280,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col3:{anchorX:360,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col4:{anchorX:440,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col5:{anchorX:520,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12}},I={Row1_Name:{x:100,y:700,fontSize:9},Row2_Name:{x:100,y:676,fontSize:9},Row3_Name:{x:100,y:652,fontSize:9},Row4_Name:{x:100,y:628,fontSize:9},Row5_Name:{x:100,y:604,fontSize:9},Row6_Name:{x:100,y:580,fontSize:9},法人名:{x:409.3,y:788.6,fontSize:9}},U={Row1_Col1:{anchorX:200,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col2:{anchorX:280,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col3:{anchorX:360,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col4:{anchorX:440,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row1_Col5:{anchorX:520,anchorY:700,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col1:{anchorX:200,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col2:{anchorX:280,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col3:{anchorX:360,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col4:{anchorX:440,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row2_Col5:{anchorX:520,anchorY:676,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col1:{anchorX:200,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col2:{anchorX:280,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col3:{anchorX:360,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col4:{anchorX:440,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row3_Col5:{anchorX:520,anchorY:652,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col1:{anchorX:200,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col2:{anchorX:280,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col3:{anchorX:360,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col4:{anchorX:440,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row4_Col5:{anchorX:520,anchorY:628,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col1:{anchorX:200,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col2:{anchorX:280,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col3:{anchorX:360,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col4:{anchorX:440,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row5_Col5:{anchorX:520,anchorY:604,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col1:{anchorX:200,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col2:{anchorX:280,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col3:{anchorX:360,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col4:{anchorX:440,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12},Row6_Col5:{anchorX:520,anchorY:580,boxWidth:16,boxSpacing:16,fontSize:10,maxDigits:12}},E={Row1_Name:{x:100,y:700,fontSize:9},Row2_Name:{x:100,y:676,fontSize:9},Row3_Name:{x:100,y:652,fontSize:9},Row4_Name:{x:100,y:628,fontSize:9},Row5_Name:{x:100,y:604,fontSize:9},Row6_Name:{x:100,y:580,fontSize:9},法人名:{x:100,y:780,fontSize:9}},v={globalShiftX:0,globalShiftY:0,digitCenterOffsetX:-5,digitCenterOffsetY:2};async function Y(l){l.registerFontkit(R);try{const i=await fetch("/fonts/NotoSansCJKjp-Regular.otf").then(m=>m.arrayBuffer());return await l.embedFont(i)}catch{return console.warn("[DigitBox] Could not load local Japanese font, falling back to Helvetica"),await l.embedStandardFont(B.Helvetica)}}function w(l,o,i,m,t=v){if(o==null)return{success:!1,digitsPlaced:0};const n=Math.abs(Math.floor(o)).toString().split("").reverse();n.length>i.maxDigits&&console.warn(`[DigitBox] Value ${o} exceeds max digits ${i.maxDigits}`);const e=t.globalShiftX+t.digitCenterOffsetX,u=t.globalShiftY+t.digitCenterOffsetY;return n.forEach((h,p)=>{if(p>=i.maxDigits)return;const c=i.anchorX-p*i.boxSpacing+e,s=i.anchorY+u;l.drawText(h,{x:c,y:s,size:i.fontSize,font:m,color:P(0,0,0)})}),console.log(`[DigitBox] Placed ${n.length} digits for value ${o}`),{success:!0,digitsPlaced:n.length}}function S(l,o,i,m,t=v){if(!o||o.trim()==="")return{success:!1};const f=i.x+t.globalShiftX,n=i.y+t.globalShiftY;let e=o;if(i.maxWidth){const u=i.fontSize*.6,h=Math.floor(i.maxWidth/u);o.length>h&&(e=o.substring(0,h-1)+"…")}return l.drawText(e,{x:f,y:n,size:i.fontSize,font:m,color:P(0,0,0)}),console.log(`[TextField] Placed: "${e.substring(0,20)}" at (${f}, ${n})`),{success:!0}}function K(l){if(!l)return null;const o=new Date(l);return isNaN(o.getTime())?null:{year:o.getFullYear()-2018,month:o.getMonth()+1,day:o.getDate()}}async function V(l,o,i=v,m=!1){const t={template:"beppyo1",fieldsAttempted:0,fieldsSucceeded:0,fieldDetails:[],calibrationUsed:i},f=await z.load(l,{ignoreEncryption:!0,throwOnInvalidObject:!1}),n=await Y(f),e=f.getPages()[0],{width:u,height:h}=e.getSize();if(console.log(`[DigitBox] Page size: ${u} x ${h}`),m)console.log("[DigitBox] DEBUG MODE - Drawing calibration marks");else{const c=[{fieldKey:"所得金額_row1",value:o.beppyo4.taxableIncome},{fieldKey:"法人税額_row2",value:o.beppyo1.corporateTaxAmount},{fieldKey:"差引法人税額_row13",value:o.beppyo1.nationalTaxPayable},{fieldKey:"所得合計_row18",value:o.beppyo4.taxableIncome},{fieldKey:"row19",value:o.beppyo1.specialTaxCredit},{fieldKey:"row22",value:o.beppyo1.nationalInterimPayment},{fieldKey:"法人税額計_row28",value:o.beppyo1.totalTaxAmount}];for(const s of c){const x=N[s.fieldKey];if(!x){console.warn(`[DigitBox] Unknown field: ${s.fieldKey}`);continue}console.log(`[DigitBox] Filled ${s.fieldKey} at (${x.anchorX}, ${x.anchorY})`),t.fieldsAttempted++;const a=w(e,s.value,x,n,i);a.success&&t.fieldsSucceeded++,t.fieldDetails.push({fieldName:s.fieldKey,value:s.value,success:a.success,coordinates:{x:x.anchorX,y:x.anchorY}})}}if(o.companyInfo){console.log("[TextField] Filling company information...",o.companyInfo);const c=o.companyInfo;if(c.corporateName){const a=_.法人名;a&&(S(e,c.corporateName,a,n,i),t.fieldsSucceeded++)}if(c.taxOffice){const a=_.税務署名;a&&(S(e,c.taxOffice,a,n,i),t.fieldsSucceeded++)}if(c.representativeName){const a=_.代表者氏名;a&&(S(e,c.representativeName,a,n,i),t.fieldsSucceeded++)}if(c.address){const a=_.納税地;a&&(S(e,c.address,a,n,i),t.fieldsSucceeded++)}if(c.phoneNumber){const a=_.電話番号;a&&(S(e,c.phoneNumber,a,n,i),t.fieldsSucceeded++)}const s=K(c.fiscalYearStart);s&&(S(e,String(s.year),_.事業年度_年_自,n,i),S(e,String(s.month),_.事業年度_月_自,n,i),S(e,String(s.day),_.事業年度_日_自,n,i));const x=K(c.fiscalYearEnd);x&&(S(e,String(x.year),_.事業年度_年_至,n,i),S(e,String(x.month),_.事業年度_月_至,n,i),S(e,String(x.day),_.事業年度_日_至,n,i)),c.corporateNumber&&S(e,c.corporateNumber,_.法人番号,n,i)}const p=await f.save();return console.log(`
===== DIGIT BOX FILLING REPORT =====`),console.log(`Template: ${t.template}`),console.log(`Success: ${t.fieldsSucceeded}/${t.fieldsAttempted}`),console.table(t.fieldDetails),console.log(`=====================================
`),{pdfBytes:p,report:t}}async function q(l,o,i=v,m=!1){var h;const t={template:"beppyo4",fieldsAttempted:0,fieldsSucceeded:0,fieldDetails:[],calibrationUsed:i},f=await z.load(l,{ignoreEncryption:!0,throwOnInvalidObject:!1}),n=await Y(f),e=f.getPages()[0];if(!m){const p=[{fieldKey:"当期利益_row1",value:o.beppyo4.netIncomeFromPL},{fieldKey:"損金算入法人税_row2",value:o.beppyo4.nonDeductibleTaxes},{fieldKey:"損金算入住民税_row3",value:o.beppyo4.inhabitantTax||0},{fieldKey:"交際費不算入額_row4",value:o.beppyo4.nonDeductibleEntertainment},{fieldKey:"減価償却超過額_row5",value:o.beppyo4.excessDepreciation},{fieldKey:"法人税等還付金_row33",value:o.beppyo4.taxRefunds||0},{fieldKey:"支出事業税_row34",value:o.beppyo4.deductibleEnterpriseTax},{fieldKey:"所得金額_row52",value:o.beppyo4.taxableIncome}];for(const c of p){const s=A[c.fieldKey];if(!s)continue;t.fieldsAttempted++;const x=w(e,c.value,s,n,i);x.success&&t.fieldsSucceeded++,t.fieldDetails.push({fieldName:c.fieldKey,value:c.value,success:x.success,coordinates:{x:s.anchorX,y:s.anchorY}})}if((h=o.companyInfo)!=null&&h.corporateName){const c=T.法人名;c&&(S(e,o.companyInfo.corporateName,c,n,i),t.fieldsSucceeded++)}}return{pdfBytes:await f.save(),report:t}}async function H(l,o,i,m){var h,p,c,s;const t=await z.load(l,{ignoreEncryption:!0});t.registerFontkit(R);const f=await Y(t),n=t.getPages()[0],e={template:"beppyo5_1",calibrationUsed:i,fieldsAttempted:0,fieldsSucceeded:0,fieldDetails:[]};if(!m){const x=((h=o.beppyo5)==null?void 0:h.retainedEarningsItems)||[],a=(r,b)=>{const g=x.find(X=>X.id===r);return g?g[b]:0},d=[{fieldKey:"Item1_Col1",value:a("1","beginAmount")},{fieldKey:"Item1_Col2",value:a("1","increase")},{fieldKey:"Item1_Col3",value:a("1","decrease")},{fieldKey:"Item1_Col4",value:a("1","endAmount")},{fieldKey:"Item31_Col1",value:a("3","beginAmount")},{fieldKey:"Item31_Col2",value:a("3","increase")},{fieldKey:"Item31_Col3",value:a("3","decrease")},{fieldKey:"Item31_Col4",value:a("3","endAmount")},{fieldKey:"Item32_Col1",value:a("4","beginAmount")},{fieldKey:"Item32_Col2",value:a("4","increase")},{fieldKey:"Item32_Col3",value:a("4","decrease")},{fieldKey:"Item32_Col4",value:a("4","endAmount")},{fieldKey:"Item33_Col1",value:((p=o.beppyo5)==null?void 0:p.capitalBegin)||0},{fieldKey:"Item33_Col4",value:((c=o.beppyo5)==null?void 0:c.capitalEnd)||0}];for(const r of d){const b=F[r.fieldKey];if(!b)continue;e.fieldsAttempted++;const g=w(n,r.value,b,f,i);g.success&&e.fieldsSucceeded++,e.fieldDetails.push({fieldName:r.fieldKey,value:r.value,success:g.success,coordinates:{x:b.anchorX,y:b.anchorY}})}if((s=o.companyInfo)!=null&&s.corporateName){const r=O.法人名;r&&(S(n,o.companyInfo.corporateName,r,f,i),e.fieldsSucceeded++)}}return{pdfBytes:await t.save(),report:e}}async function Q(l,o,i,m){var h,p,c,s;const t=await z.load(l,{ignoreEncryption:!0});t.registerFontkit(R);const f=await Y(t),n=t.getPages()[0],e={template:"beppyo5_2",calibrationUsed:i,fieldsAttempted:0,fieldsSucceeded:0,fieldDetails:[]};if(!m){const x=o.beppyo5_2||{taxesPayable:{corporate:0,inhabitant:0,enterprise:0}},a=[{fieldKey:"法人税_1",value:((h=x.taxesPayable)==null?void 0:h.corporate)||0},{fieldKey:"住民税_1",value:((p=x.taxesPayable)==null?void 0:p.inhabitant)||0},{fieldKey:"事業税_1",value:((c=x.taxesPayable)==null?void 0:c.enterprise)||0}];for(const d of a){const r=$[d.fieldKey];if(!r)continue;e.fieldsAttempted++;const b=w(n,d.value,r,f,i);b.success&&e.fieldsSucceeded++,e.fieldDetails.push({fieldName:d.fieldKey,value:d.value,success:b.success,coordinates:{x:r.anchorX,y:r.anchorY}})}if((s=o.companyInfo)!=null&&s.corporateName){const d=L.法人名;d&&S(n,o.companyInfo.corporateName,d,f,i)}}return{pdfBytes:await t.save(),report:e}}async function Z(l,o,i,m){var h;const t=await z.load(l,{ignoreEncryption:!0});t.registerFontkit(R);const f=await Y(t),n=t.getPages()[0],e={template:"beppyo15",calibrationUsed:i,fieldsAttempted:0,fieldsSucceeded:0,fieldDetails:[]};if(!m){const p=o.beppyo15||{totalEntertainmentExpenses:0,foodAndDrinkExpenses:0,deductionLimit:0,excessAmount:0},c=[{fieldKey:"Item1_Col1",value:p.totalEntertainmentExpenses},{fieldKey:"Item2_Col1",value:p.foodAndDrinkExpenses},{fieldKey:"Item17_Col1",value:p.deductionLimit},{fieldKey:"Item18_Col1",value:p.excessAmount}];for(const s of c){const x=G[s.fieldKey];if(!x)continue;e.fieldsAttempted++;const a=w(n,s.value,x,f,i);a.success&&e.fieldsSucceeded++,e.fieldDetails.push({fieldName:s.fieldKey,value:s.value,success:a.success,coordinates:{x:x.anchorX,y:x.anchorY}})}if((h=o.companyInfo)!=null&&h.corporateName){const s=M.法人名;s&&S(n,o.companyInfo.corporateName,s,f,i)}}return{pdfBytes:await t.save(),report:e}}async function oo(l,o,i,m){var h,p,c;const t=await z.load(l,{ignoreEncryption:!0});t.registerFontkit(R);const f=await Y(t),n=t.getPages(),e={template:"beppyo16",calibrationUsed:i,fieldsAttempted:0,fieldsSucceeded:0,fieldDetails:[]};if(!m){const s=((h=o.beppyo16)==null?void 0:h.assets)||[],x=s.filter(d=>d.depreciationMethod==="straight_line");if(x.length>0&&n.length>0){const d=n[0];if(x.forEach((r,b)=>{const g=b+1;if(g>6)return;const X=[{fieldKey:`Row${g}_Col1`,value:r.acquisitionCost},{fieldKey:`Row${g}_Col2`,value:r.bookValueEnd},{fieldKey:`Row${g}_Col3`,value:r.allowableLimit},{fieldKey:`Row${g}_Col4`,value:r.currentDepreciation},{fieldKey:`Row${g}_Col5`,value:Math.max(0,r.currentDepreciation-r.allowableLimit)}];for(const y of X){const D=k[y.fieldKey];if(D){e.fieldsAttempted++;const C=w(d,y.value,D,f,i);C.success&&e.fieldsSucceeded++,e.fieldDetails.push({fieldName:y.fieldKey,value:y.value,success:C.success,coordinates:{x:D.anchorX,y:D.anchorY}})}}const W=I[`Row${g}_Name`];W&&(S(d,r.name,W,f,i),e.fieldsSucceeded++)}),(p=o.companyInfo)!=null&&p.corporateName){const r=I.法人名;r&&S(d,o.companyInfo.corporateName,r,f,i)}}const a=s.filter(d=>d.depreciationMethod==="declining_balance");if(a.length>0&&n.length>1){const d=n[1];if(a.forEach((r,b)=>{const g=b+1;if(g>6)return;const X=[{fieldKey:`Row${g}_Col1`,value:r.acquisitionCost},{fieldKey:`Row${g}_Col2`,value:r.bookValueEnd},{fieldKey:`Row${g}_Col3`,value:r.allowableLimit},{fieldKey:`Row${g}_Col4`,value:r.currentDepreciation},{fieldKey:`Row${g}_Col5`,value:Math.max(0,r.currentDepreciation-r.allowableLimit)}];for(const y of X){const D=U[y.fieldKey];if(D){e.fieldsAttempted++;const C=w(d,y.value,D,f,i);C.success&&e.fieldsSucceeded++,e.fieldDetails.push({fieldName:y.fieldKey,value:y.value,success:C.success,coordinates:{x:D.anchorX,y:D.anchorY}})}}const W=E[`Row${g}_Name`];W&&(S(d,r.name,W,f,i),e.fieldsSucceeded++)}),(c=o.companyInfo)!=null&&c.corporateName){const r=E.法人名;r&&S(d,o.companyInfo.corporateName,r,f,i)}}}return{pdfBytes:await t.save(),report:e}}export{G as BEPPYO15_PAGE1_FIELDS,M as BEPPYO15_PAGE1_TEXT,k as BEPPYO16_1_PAGE1_FIELDS,I as BEPPYO16_1_PAGE1_TEXT,U as BEPPYO16_2_PAGE1_FIELDS,E as BEPPYO16_2_PAGE1_TEXT,N as BEPPYO1_PAGE1_FIELDS,_ as BEPPYO1_PAGE1_TEXT,A as BEPPYO4_PAGE1_FIELDS,T as BEPPYO4_PAGE1_TEXT,$ as BEPPYO5_2_PAGE1_FIELDS,L as BEPPYO5_2_PAGE1_TEXT,F as BEPPYO5_PAGE1_FIELDS,O as BEPPYO5_PAGE1_TEXT,v as DEFAULT_CALIBRATION,Z as fillBeppyo15WithDigitBoxes,oo as fillBeppyo16WithDigitBoxes,V as fillBeppyo1WithDigitBoxes,q as fillBeppyo4WithDigitBoxes,H as fillBeppyo5_1WithDigitBoxes,Q as fillBeppyo5_2WithDigitBoxes,w as fillDigitBoxField,S as fillTextField};
